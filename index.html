<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://www.googletagmanager.com">
  <link rel="dns-prefetch" href="https://www.googletagmanager.com">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-77033033-28"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-77033033-28');

    // Performance monitoring
    if ('PerformanceObserver' in window) {
      const observer = new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          if (entry.entryType === 'largest-contentful-paint') {
            gtag('event', 'web_vitals', {
              name: 'LCP',
              value: Math.round(entry.startTime),
              event_category: 'Performance'
            });
          }
        }
      });
      observer.observe({entryTypes: ['largest-contentful-paint']});
    }
  </script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <!-- Security and Privacy -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: https://www.googletagmanager.com; img-src 'self' data: https:; connect-src 'self' https://www.googletagmanager.com https://fonts.gstatic.com blob:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com blob:; worker-src 'self' blob:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com">
  <meta name="referrer" content="no-referrer-when-downgrade">

  <!-- Favicon and Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="./res/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./res/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./res/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./res/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="./res/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="./res/apple-touch-icon-152x152.png" />
  <link rel="icon" type="image/png" href="./res/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="./res/favicon-16x16.png" sizes="16x16" />
  <meta name="application-name" content="PSE in VR"/>
  <meta name="msapplication-TileColor" content="#C6C6C6" />
  <meta name="msapplication-TileImage" content="./res/mstile-144x144.png" />

  <!-- SEO Meta Tags -->
  <meta name="description" content="Interaktives virtuelles Periodensystem für die Chemie. Erforsche alle 118 Elemente in 3D mit VR-Unterstützung.">
  <meta name="keywords" content="PSE, Periodensystem, Chemie, VR, WebXR, Virtual Reality, 3D, WebGL, Three.js, Education, Unterricht">
  <meta name="author" content="Mozilla Reality">
  <meta name="theme-color" content="#1a1a2e">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://chemie-lernen.org/pse-in-vr/">
  <meta property="og:title" content="PSE in VR - Virtuelles Periodensystem">
  <meta property="og:description" content="Interaktives virtuelles Periodensystem für die Chemie. Erforsche alle 118 Elemente in 3D mit VR-Unterstützung.">
  <meta property="og:image" content="https://chemie-lernen.org/pse-in-vr/3d-scene.png">
  <meta property="og:site_name" content="PSE in VR">
  <meta property="og:locale" content="de_DE">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://chemie-lernen.org/pse-in-vr/">
  <meta name="twitter:title" content="PSE in VR - Virtuelles Periodensystem">
  <meta name="twitter:description" content="Interaktives virtuelles Periodensystem für die Chemie.">

  <!-- Schema.org Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Hello WebXR!",
    "description": "Interactive WebXR experience showcasing VR and AR capabilities",
    "url": "https://chemie-lernen.org/pse-in-vr/",
    "applicationCategory": "EducationalApplication",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": "WebXR VR support, 3D environments, Interactive learning, Spatial audio",
    "screenshot": "https://chemie-lernen.org/pse-in-vr/3d-scene.png"
  }
  </script>

  <title>PSE in VR - Virtuelles Periodensystem</title>

  <style>

body{
  margin: 0;
  overflow: hidden;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
}
header {
  position: absolute;
  width: calc(100vw - 1rem);
  margin-top: 1rem;
  text-align: right;
}
#mrlogo {
  margin: 0.3rem 1.5rem;
  width: 200px;
}
header a {
  text-decoration: none;
  color: #000;
  margin-left: 0.8rem;
  vertical-align: top;
}
header a path{
  fill: #000;
}
header a:hover {
  color: #059;
  text-decoration: underline;
  text-underline-offset: 6px;
}
header a:hover path, #mrlogo:hover path.mrlogobg{
  fill: #059;
}
#handedness {
  display: inline-block;
  background: rgba(0, 0, 0, 0.75);
  padding: 8px 16px;
  border-radius: 8px;
}
#handedness span {
  color: #fff;
  font-weight: 600;
  margin-right: 12px;
}
#handedness a{
  margin-left: 0.3rem;
  color: #fff;
  font-weight: 500;
  padding: 6px 14px;
  border-radius: 5px;
  transition: all 0.2s ease;
}
#handedness a:hover {
  background: rgba(255, 255, 255, 0.2);
  text-decoration: none;
}
.activehand {
  background: #fff !important;
  color: #000 !important;
  font-weight: 700;
  padding: 6px 14px;
  border-radius: 5px;
  pointer-events: none;
}

@media (max-width: 580px) {
  #mrlogo{
    display: none;
  }
}

#loading {
  z-index: 9999;
  position: absolute;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
  background-size: cover;
  background-position: center;
}
#loading h1 {
  color: white;
  font-size: 6rem;
  margin: 1rem;
  text-shadow: 1px 3px 5px rgba(0, 0, 0, 0.1);
}
#loading div {
  text-align: center;
  position: absolute;
  width: 100vw;
  top: calc(50vh - 120px);
  font-size: 2rem;
}

.hidden {
  display: none;
}

#no-webxr {
  padding: 20px;
  text-align: center;
}

#no-webxr a {
  color: #000;
}

  </style>

  <!-- Load vendor bundles first (for better caching) -->
  <script src="2.bundle.js"></script>
  <script src="1.bundle.js"></script>
  <script src="bundle.js"></script>

  <script type="text/javascript">
    function aclick(ev) {
      ev.stopPropagation();
    }

    function setHandedness(link, hand) {
      var currentURL = new URL(window.location);
      currentURL.searchParams.set('handedness', hand);
      link.href = currentURL.href;
    }
  </script>
</head>
<body>

<div id="loading">
  <div>
    <h1> Hello!</h1>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" version="1.1">
      <path stroke="#000" stroke-width="8px" fill="none" d="M 50 5 a 45 45 0 1 0 0.0001 0"
      stroke-dasharray="282 282" stroke-dashoffset="282" id="progressbar"/>
    </svg>
  </div>
</div>

<div id="no-webxr" class="hidden">
  <h2>WebXR Not Supported</h2>
  <p>Your browser doesn't support WebXR. Please use a WebXR-compatible browser like:</p>
  <ul>
    <li><a href="https://www.oculus.com/browser/">Oculus Browser</a></li>
    <li><a href="https://mixedreality.mozilla.org/">Firefox Reality</a></li>
    <li><a href="https://chrome.google.com/webstore/detail/webxr-api-emulator/mjddjgejdnfnnagcgmbgcafikfcddfhl">Chrome with WebXR Emulator</a></li>
  </ul>
</div>




<div id="browser-help" style="position: fixed; bottom: 20px; left: 20px; background: rgba(0,0,0,0.7); color: white; padding: 15px; border-radius: 8px; font-family: sans-serif; font-size: 14px; line-height: 1.6; pointer-events: none; user-select: none; z-index: 1000;">
  <strong style="color: #5bf;">Browser Navigation:</strong><br>
  Click to enable mouse look<br>
  W/↑ - Forward | S/↓ - Back<br>
  A/← - Left | D/→ - Right<br>
  N - Next room
</div>

<!-- Service Worker Registration -->
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js')
        .then((registration) => {
          console.log('Service Worker registered with scope:', registration.scope);

          // Listen for updates
          registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing;
            newWorker.addEventListener('statechange', () => {
              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                // New content is available
                if (confirm('New version available! Reload to update?')) {
                  window.location.reload();
                }
              }
            });
          });
        })
        .catch((error) => {
          console.log('Service Worker registration failed:', error);
        });
    });
  }
</script>

</body>
</html>
