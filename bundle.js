!function(e){function t(t){for(var o,s,a=t[0],l=t[1],c=t[2],u=0,d=[];u<a.length;u++)s=a[u],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(m&&m(t);d.length;)d.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],o=!0,a=1;a<r.length;a++){var l=r[a];0!==n[l]&&(o=!1)}o&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var o={},n={0:0},i=[];function s(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=o,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="./";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var m=l;i.push([10,1,2]),r()}({10:function(e,t,r){"use strict";r.r(t),r.d(t,"init",(function(){return Pe}));var o=r(0),n=r(6),i=function(e,t){function r(){n.style.display="",n.style.cursor="auto",n.style.left="calc(50% - 75px)",n.style.width="150px",n.onmouseenter=null,n.onmouseleave=null,n.onclick=null,n.textContent="VR NOT SUPPORTED"}function o(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 24px",e.style.border="2px solid #fff",e.style.borderRadius="6px",e.style.background="rgba(0,0,0,0.7)",e.style.color="#fff",e.style.font="600 14px sans-serif",e.style.textAlign="center",e.style.opacity="1.0",e.style.outline="none",e.style.zIndex="999",e.style.cursor="pointer",e.style.transition="all 0.2s ease"}if("xr"in navigator){var n=document.createElement("button");return n.style.display="none",o(n),navigator.xr.isSessionSupported("immersive-vr").then((function(o){o?function(){var r=null;function o(o){o.addEventListener("end",i),e.xr.setSession(o),n.textContent="EXIT VR",r=o,t("sessionStarted")}function i(){r.removeEventListener("end",i),n.textContent="ENTER VR",r=null,t("sessionEnded")}n.style.display="",n.style.cursor="pointer",n.style.left="calc(50% - 50px)",n.style.width="100px",n.textContent="ENTER VR",n.onmouseenter=function(){n.style.background="rgba(0,0,0,0.9)",n.style.transform="scale(1.05)"},n.onmouseleave=function(){n.style.background="rgba(0,0,0,0.7)",n.style.transform="scale(1.0)"},n.onclick=function(){if(null===r){navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}).then(o)}else r.end()}}():r()})),n}var i=document.createElement("a");return!1===window.isSecureContext?(i.href=document.location.href.replace(/^http:/,"https:"),i.innerHTML="WEBXR NEEDS HTTPS"):(i.href="https://immersiveweb.dev/",i.innerHTML="WEBXR NOT AVAILABLE"),i.style.left="calc(50% - 90px)",i.style.width="180px",i.style.textDecoration="none",o(i),i};var s={};s.paths=[[{from:new o.Vector3(0,1.6,0),lookAt:new o.Vector3(0,1,-100),velocity:new o.Vector3(0,0,-.1),angularVelocity:new o.Vector3(.04,0,0)},{from:new o.Vector3(4.5,1.6,-3),lookAt:new o.Vector3(100,0,0),velocity:new o.Vector3(0,0,-.15),angularVelocity:new o.Vector3(0,0,0)},{from:new o.Vector3(0,1.6,0),lookAt:new o.Vector3(50,0,-40),velocity:new o.Vector3(0,.12,0),angularVelocity:new o.Vector3(0,.1,0)},{from:new o.Vector3(3,2.4,-4),lookAt:new o.Vector3(-50,0,40),velocity:new o.Vector3(0,-.12,0),angularVelocity:new o.Vector3(0,-.1,0)}],[{from:new o.Vector3(0,1.6,0),lookAt:new o.Vector3(0,0,-100),velocity:new o.Vector3(.1,0,.1),angularVelocity:new o.Vector3(0,.01,0)}],[{from:new o.Vector3(0,1.2,.8),lookAt:new o.Vector3(-100,.5,0),velocity:new o.Vector3(0,0,-.2),angularVelocity:new o.Vector3(0,0,0)},{from:new o.Vector3(-1,1,-1.6),lookAt:new o.Vector3(-40,0,100),velocity:new o.Vector3(-.05,0,0),angularVelocity:new o.Vector3(0,0,0)}],[{from:new o.Vector3(0,1.6,0),lookAt:new o.Vector3(0,0,-10),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(-.01,.07,0)},{from:new o.Vector3(0,1.6,-.4),lookAt:new o.Vector3(0,0,6),velocity:new o.Vector3(0,0,.1),angularVelocity:new o.Vector3(.07,0,0)}],[{from:new o.Vector3(0,0,0),lookAt:new o.Vector3(-100,0,0),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(.03,.05,0)}],[],[{from:new o.Vector3(0,0,0),lookAt:new o.Vector3(-100,0,0),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(.01,.1,0)}],[],[{from:new o.Vector3(0,0,0),lookAt:new o.Vector3(-100,0,0),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(-.07,-.05,0)}],[{from:new o.Vector3(0,0,0),lookAt:new o.Vector3(100,0,80),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(0,-.02,0)}]],s.setup=function(e){this.room=void 0,this.path=void 0,this.next(e),e.camera.position.set(0,1.6,0),e.cameraRig.position.set(0,0,2),e.goto=this.room},s.next=function(e){if(this.time=3+3*Math.random()/2,void 0===this.room)this.room=0,this.path=0;else if(this.path++,this.path>=this.paths[this.room].length){do{this.room++,this.room>=this.paths.length&&(this.room=0,e.cameraRig.position.set(0,0,2))}while(!this.paths[this.room].length);e.renderer.xr.getCamera(e.camera).position.set(0,1.6,0),e.goto=this.room,this.path=0}this.reset=!0},s.execute=function(e,t,r){const o=this.paths[this.room][this.path];this.reset&&(this.reset=!1,e.camera.position.copy(o.from),e.camera.rotation.set(0,0,0),e.camera.lookAt(o.lookAt)),e.camera.position.addScaledVector(o.velocity,t),e.camera.rotation.x+=o.angularVelocity.x*t,e.camera.rotation.y+=o.angularVelocity.y*t,e.camera.rotation.z+=o.angularVelocity.z*t,this.time-=t,this.time<0&&this.next(e)};var a=r(7),l=r(3),c=r(8),m=r(4);function u(e){let t=0;for(var r in e)!0!==e[r].loading&&t++;return t}function d(e){for(var t in e)if(!0===e[t].loading)return!1;return!0}var p=r(1),h=r(5);class b{constructor(){this.value=null}reset(){this.value=null}}class g{constructor(){this.rotation=new o.Vector3}reset(){}}class y{constructor(){this.position=new o.Vector3}reset(){}}class f{constructor(){this.value=null}reset(){this.value=null}}class v{constructor(){this.text="",this.textAlign="left",this.anchor="center",this.baseline="center",this.color="#FFF",this.font=null,this.fontSize=.2,this.letterSpacing=0,this.lineHeight=0,this.maxWidth=1/0,this.overflowWrap="normal",this.whiteSpace="normal",this.opacity=1}reset(){this.text=""}}class k{constructor(){this.min=new o.Vector3,this.max=new o.Vector3}reset(){this.min.set(0,0,0),this.max.set(0,0,0)}}p.d;p.d;class x extends p.d{}class N{constructor(){}reset(){}}const w=()=>{};class S{constructor(){this.reset()}reset(){this.onEntering=w,this.onExiting=w}}class E extends p.d{}class M{constructor(){this.value=[]}reset(){this.value.array.length=0}}const z={left:0,center:.5,right:1},C={top:0,center:.5,bottom:1};class F extends p.b{updateText(e,t){e.text=t.text,e.textAlign=t.textAlign,e.anchor[0]=z[t.anchor],e.anchor[1]=C[t.baseline],e.color=t.color,e.font=t.font,e.fontSize=t.fontSize,e.letterSpacing=t.letterSpacing||0,e.lineHeight=t.lineHeight||null,e.overflowWrap=t.overflowWrap,e.whiteSpace=t.whiteSpace,e.maxWidth=t.maxWidth,e.material.opacity=t.opacity,e.sync()}execute(e,t){var r=this.queries.entities;r.added.forEach(e=>{var t=e.getComponent(v);const r=new h.a;r.name="textMesh",r.anchor=[0,0],r.renderOrder=1,this.updateText(r,t),e.addComponent(b,{value:r})}),r.removed.forEach(e=>{var t=e.getComponent(b).value,r=t.getObjectByName("textMesh");r.dispose(),t.remove(r)}),r.changed.forEach(e=>{var t=e.getComponent(b).value;if(t instanceof h.a){var r=e.getComponent(v);this.updateText(t,r)}})}}F.queries={entities:{components:[v],listen:{added:!0,removed:!0,changed:[v]}}},o.BoxHelper.prototype.setFromMinMax=function(e,t){var r=this.geometry.attributes.position,o=r.array;o[0]=t.x,o[1]=t.y,o[2]=t.z,o[3]=e.x,o[4]=t.y,o[5]=t.z,o[6]=e.x,o[7]=e.y,o[8]=t.z,o[9]=t.x,o[10]=e.y,o[11]=t.z,o[12]=t.x,o[13]=t.y,o[14]=e.z,o[15]=e.x,o[16]=t.y,o[17]=e.z,o[18]=e.x,o[19]=e.y,o[20]=e.z,o[21]=t.x,o[22]=e.y,o[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()};class L extends p.c{constructor(){super(),this.boxHelper=new o.BoxHelper}}class B extends p.b{execute(e,t){this.queries.added.results.forEach(e=>{e.addComponent(L);var t=e.getComponent(k);let r=e.getMutableComponent(L);r.boxHelper.setFromMinMax(t.min,t.max),e.addComponent(b,{value:r.boxHelper})}),this.queries.removed.results.forEach(e=>{e.removeComponent(b).removeComponent(L)})}}B.queries={added:{components:[E,Object(p.a)(L)]},removed:{components:[Object(p.a)(E),L]}};class V extends p.b{execute(e,t){const r=this.queries.areas.results,o=this.queries.checkers.results;for(let e=0;e<r.length;e++){const t=r[e].getComponent(k);for(let e=0;e<o.length;e++){const r=o[e];r.getComponent(b).value.boundingBox.intersectsBox(t)?r.addComponent(x):r.removeComponent(x)}}}}V.queries={areas:{components:[class{constructor(){}reset(){}},k]},checkers:{components:[N,b]}};class H extends p.b{execute(e,t){const r=this.queries.checkers.added,o=this.queries.checkers.removed;for(let e=0;e<r.length;e++){const t=r[e];t.getComponent(S).onEntering(t)}for(let e=0;e<o.length;e++){const t=o[e];t.getComponent(S).onExiting(t)}}}H.queries={checkers:{components:[N,b,x],listen:{added:!0,removed:!0}}};class R extends p.b{execute(e,t){this.queries.entities.added.forEach(e=>{const t=e.getComponent(f).value,r=e.getComponent(b).value;t.add(r)}),this.queries.entities.changed.forEach(e=>{const t=e.getComponent(f).value,r=e.getComponent(b).value;t.add(r)}),this.queries.entities.removed.forEach(e=>{e.getComponent(f,!0).value.remove(e.getComponent(b,!0).value)})}}R.queries={entities:{components:[b,f],listen:{added:!0,removed:!0,changed:!0}}};let P=e=>{const t=e.getComponent(g);e.getComponent(b).value.rotation.set(t.x,t.y,t.z)},A=e=>{const t=e.getComponent(y);e.getComponent(b).value.position.copy(t)};class G extends p.b{execute(e,t){this.queries.position.added.forEach(A),this.queries.position.changed.forEach(A),this.queries.rotation.added.forEach(P),this.queries.rotation.changed.forEach(P)}}G.queries={position:{components:[y,b],listen:{added:!0,changed:!0}},rotation:{components:[g,b],listen:{added:!0,changed:!0}}};var D=new o.Vector3;class _ extends p.b{execute(e,t){window.context.camera.getWorldPosition(D),this.queries.entities.results.forEach(e=>{const t=e.getComponent(b).value,r=D.distanceTo(t.position);let n=0;r<4&&(n=o.Math.clamp(Math.sqrt(4-r),0,1),t.lookAt(D)),t.material.opacity=n,e.hasComponent(M)&&e.getComponent(M).value.forEach(e=>{e.getComponent(v).opacity!==n&&(e.getMutableComponent(v).opacity=n)})})}}_.queries={entities:{components:[class{constructor(){this.camera3D=null}reset(){this.camera3D=null}},b]}};class K{constructor(e,t){this.Systems=t,this.world=e}play(){this.Systems.forEach(e=>this.world.getSystem(e).play())}stop(){this.Systems.forEach(e=>this.world.getSystem(e).stop())}}var I={doorfx_tex:{url:"doorfx.basis",options:{wrapT:o.RepeatWrapping,wrapS:o.RepeatWrapping}},generic_controller_model:{url:"generic_controller.glb"},controller_tex:{url:"controller.basis"},teleport_model:{url:"teleport.glb"},glow_tex:{url:"glow.basis",options:{encoding:o.sRGBEncoding}},beam_tex:{url:"beamfx.png"}},T={door_frag:"\nuniform float time;\nuniform float selected;\nuniform sampler2D tex;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec2 uv = vUv * 2.0 - 1.0;\n  vec2 puv = vec2(length(uv.xy), atan(uv.x, uv.y));\n  vec4 col = texture2D(tex, vec2(log(puv.x) + t / 5.0, puv.y / 3.1415926 ));\n  float glow = (1.0 - puv.x) * (0.5 + (sin(t) + 2.0 ) / 4.0);\n  // blue glow\n  col += vec4(118.0/255.0, 144.0/255.0, 219.0/255.0, 1.0) * (0.4 + glow * 1.0);\n  // white glow\n  col += vec4(0.2) * smoothstep(0.0, 2.0, glow * glow);\n  gl_FragColor = col;\n\n}\n",zoom_frag:"\nuniform float time;\nuniform sampler2D tex;\nuniform vec2 zoomPos;\nuniform float zoomAmount;\nuniform float zoomRatio;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec2 uv = vec2(vUv.x - 0.5, (1.0 - vUv.y) - 0.5);\n  vec2 texUv = uv * vec2(zoomRatio, 1.0);\n  vec4 col = texture2D(tex, zoomPos + texUv * zoomAmount);\n  float dist = length(uv) * 2.0;\n  col.a = smoothstep(0.0, 0.1, 1.0 - dist);\n  float aura = smoothstep(0.80, 1.0, dist);\n  col.rgb += aura * 0.3;\n  gl_FragColor = col;\n}\n",basic_vert:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvoid main()\n{\n  vUv = uv;\n  vPosition = position;\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n",panoball_vert:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec3 vWorldPos;\nuniform float time;\nuniform float selected;\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n\nmat4 transpose(in mat4 m) {\n  vec4 i0 = m[0];\n  vec4 i1 = m[1];\n  vec4 i2 = m[2];\n  vec4 i3 = m[3];\n\n  return mat4(\n    vec4(i0.x, i1.x, i2.x, i3.x),\n    vec4(i0.y, i1.y, i2.y, i3.y),\n    vec4(i0.z, i1.z, i2.z, i3.z),\n    vec4(i0.w, i1.w, i2.w, i3.w)\n  );\n}\n\nvoid main()\n{\n  vUv = uv;\n\n  vPosition = position;\n\n  vec3 offset = vec3(\n    sin(position.x * 50.0 + time),\n    sin(position.y * 10.0 + time * 2.0),\n    cos(position.z * 40.0 + time)\n  ) * 0.003;\n\n  vPosition *= 1.0 + selected * 0.2;\n\n  vNormal = normalize(inverse(transpose(modelMatrix)) * vec4(normalize(normal), 1.0)).xyz;\n  vWorldPos = (modelMatrix * vec4(vPosition, 1.0)).xyz;\n\n  vec4 mvPosition = modelViewMatrix * vec4(vPosition + offset, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n",panoball_frag:"\nuniform sampler2D tex, texfx;\nuniform float time;\nuniform float selected;\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec3 vWorldPos;\n\n\nvoid main( void ) {\n  vec2 uv = vUv;\n  //uv.y =  1.0 - uv.y;\n\n  vec3 eye = normalize(cameraPosition - vWorldPos);\n  float fresnel = abs(dot(eye, vNormal));\n  float shift = pow((1.0 - fresnel), 4.0) * 0.05;\n\n  vec3 col = vec3(\n    texture2D(tex, uv - shift).r,\n    texture2D(tex, uv).g,\n    texture2D(tex, uv + shift).b\n  );\n\n  col = mix(col * 0.7, vec3(1.0), 0.7 - fresnel);\n\n  col += selected * 0.3;\n\n  float t = time * 0.4 + vPosition.x + vPosition.z;\n  uv = vec2(vUv.x + t * 0.2, vUv.y + t);\n  vec3 fx = texture2D(texfx, uv).rgb * 0.4;\n\n\n  gl_FragColor = vec4(col + fx, 1.0);\n}\n",beam_frag:"\nuniform float time;\nuniform sampler2D tex;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec4 col = texture2D(tex, vec2(vUv.x, vUv.y * 3.0 + time * 2.0));\n  col *= vUv.y;\n  gl_FragColor = col;\n}\n"};var W,O=new o.Matrix4;const j=["primary","secondary","both","left","right"];class q extends class{constructor(){this._listeners={},this.stats={fired:0,handled:0}}addEventListener(e,t){let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){return void 0!==this._listeners[e]&&-1!==this._listeners[e].indexOf(t)}removeEventListener(e,t){var r=this._listeners[e];if(void 0!==r){var o=r.indexOf(t);-1!==o&&r.splice(o,1)}}dispatchEvent(e,t){this.stats.fired++;var r=this._listeners[e];if(void 0!==r)for(var o=r.slice(0),n=0;n<o.length;n++)o[n].call(this,t)}resetCounters(){this.stats.fired=this.stats.handled=0}}{enable(){this.setLineStyle(this.previousLineStyle),this.enabled=!0}_sort(){this.currentStates=this.currentStates.sort((e,t)=>(e.order||0)-(t.order||0))}disable(){this.lineBasic.visible=this.line0.visible=!1,this.enabled=!1,this.controllers.forEach(e=>e.active=!1)}changeHandedness(e){e!==this.primary&&(this.primary=e,this.secondary="right"===e?"left":"right",this.dispatchEvent("handednessChanged",{primary:this.primary,secondary:this.secondary}))}addState(e,t,r){if(!this.states[e])return t.name=e,void 0===t.raycaster&&(t.raycaster=!0),void 0===t.controller?t.controller="primary":j.includes(t.controller)||(console.warn("Invalid controller selector:",t.controller),t.controller="primary"),this.states[e]=t,!0===r&&this.currentStates.push(t),t;console.error(`RayControl state '${e}' already exist, please use a different name.`)}activateState(e){this.states[e]&&(this.currentStates.push(this.states[e]),this._sort())}deactivateAll(e){this.currentStates=[],this.controllers.forEach(e=>{this.currentStates.forEach(t=>{e.intersections[t.name]&&(e.intersections[t.name]=null)})})}deactivateState(e){this.currentStates.splice(this.currentStates.indexOf(e),1),this.controllers.forEach(t=>{t.intersections[e]&&(t.intersections[e]=null)}),this._sort()}addController(e,t){let r={controller:e,inputSource:t,active:!1,stateHit:{},intersections:{},currentIntersection:null,hit:!1};this.controllers.push(r),this.matchController(r,"primary")&&e.add(this.raycasterContext),this.dispatchEvent("controllerConnected",r)}removeController(e){const t=this.controllers.findIndex(t=>t.controller===e),r=this.controllers.find(t=>t.controller===e);this.controllers.splice(t,1),this.dispatchEvent("controllerDisconnected",r)}constructor(e,t){super(),this.ctx=e,void 0===t?(this.primary="right",this.secondary="left"):(this.primary=t,this.secondary="right"===t?"left":"right"),this.controllers=[],this.previousLineStyle="pretty",this.enabled=!0,this.raycaster=new o.Raycaster,this.states={},this.currentStates=[];var r=e.assets.teleport_model.scene.getObjectByName("beam");e.assets.beam_tex.wrapT=o.RepeatWrapping,e.assets.beam_tex.wrapS=o.RepeatWrapping,W=r.material=new o.ShaderMaterial({uniforms:{time:{value:0},active:{value:0},tex:{value:e.assets.beam_tex}},vertexShader:e.shaders.basic_vert,fragmentShader:e.shaders.beam_frag,blending:o.AdditiveBlending,transparent:!0}),r.renderOrder=10,r.name="line",this.rayLength=5,r.scale.z=this.rayLength,this.line0=r.clone(),this.line0.visible=!0,this.raycasterContext=new o.Group,this.raycasterContext.add(this.line0),this.raycasterContext.name="raycasterContext";var n=(new o.BufferGeometry).setFromPoints([new o.Vector3(0,0,0),new o.Vector3(0,0,-1)]);this.lineBasic=new o.Line(n),this.lineBasic.name="line",this.lineBasic.scale.z=5,this.lineBasic.visible=!1,this.raycasterContext.add(this.lineBasic)}setLineStyle(e){const t="basic"===e;this.lineBasic.visible=t,this.line0.visible=!t,this.previousLineStyle=e}matchController(e,t){const r=e.inputSource.handedness;return t===r||"both"===t&&("right"===r||"left"===r)||"primary"===t&&this.primary===r||"secondary"===t&&this.secondary===r}onSelectStart(e){if(!this.enabled)return;let t=e.target,r=this.controllers.find(e=>e.controller===t);if(r){if(r.active=!0,r.currentIntersection){const e=r.currentIntersection.state;e.onSelectStart&&e.onSelectStart(r.currentIntersection.intersection,r.controller)}this.currentStates.forEach(e=>{e.onSelectStart&&!e.raycaster&&e.onSelectStart(r.intersections[e.name],t)})}}execute(e,t,r){if(!this.enabled||0===this.currentStates.length)return;W.uniforms.time.value=r;for(var o=0;o<this.controllers.length;o++){let e=this.controllers[o];for(var n=0;n<this.currentStates.length;n++){let t=this.currentStates[n];if(!t.raycaster)continue;if(!this.matchController(e,t.controller))continue;let r=e.controller,o=(e.active,this.getIntersections(r,t.colliderMesh));o.length>0?(e.intersections[t.name]=o[0],e.stateHit[t.name]=!0):e.intersections[t.name]=null}}this.line0.scale.z=Math.min(this.rayLength,1),this.lineBasic.scale.z=Math.min(this.rayLength,1);for(o=0;o<this.controllers.length;o++){let e=this.controllers[o],t=Object.entries(e.intersections).filter(e=>null!==e[1]);if(t.length>0){t.sort((e,t)=>e[1].distance-t[1].distance);const r=t[0],o=r[1],n=this.states[r[0]];e.prevIntersection=e.currentIntersection,e.currentIntersection={state:n,intersection:o},n.lineStyleOnIntersection?this.setLineStyle(n.lineStyleOnIntersection):this.setLineStyle("advanced"),n.onHover&&n.onHover(o,e.active,e.controller),this.line0.scale.z=Math.min(o.distance,1),this.lineBasic.scale.z=Math.min(o.distance,1)}else e.currentIntersection=null}for(o=0;o<this.controllers.length;o++){let e=this.controllers[o];e.prevIntersection&&(this.controllers.find(t=>{let r=e.prevIntersection,o=t.currentIntersection;return o&&r.state.name===o.state.name&&r.intersection.object===o.intersection.object})||(e.prevIntersection.state.onHoverLeave(e.prevIntersection.intersection,!1,e.controller),e.prevIntersection=null))}}getIntersections(e,t){let r=e.getObjectByName("raycasterContext");return r?(O.identity().extractRotation(r.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(r.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(O),Array.isArray(t)?this.raycaster.intersectObjects(t,!0):this.raycaster.intersectObject(t,!0)):(console.warn("No raycasterContext found for this controller",e),[])}onSelectEnd(e){if(!this.enabled)return;let t=this.controllers.find(t=>t.controller===e.target);if(t&&t.active){if(t){if(t.currentIntersection){const e=t.currentIntersection.state;e.onSelectEnd&&e.onSelectEnd(t.currentIntersection.intersection,t.controller)}this.currentStates.forEach(e=>{e.onSelectEnd&&!e.raycaster&&e.onSelectEnd(null,t.controller)})}t.active=!1}}}new o.Matrix4;class U{constructor(e,t){this.ctx=e,this.teleportEntity=new o.Group,this.active=!1,this.teleportHitGeometry=e.assets.teleport_model.scene.getObjectByName("goal"),this.teleportHitGeometry.material=W,this.teleportHitGeometry.renderOrder=10,this.ballColliding=e.assets.teleport_model.scene.getObjectByName("glow"),this.ballColliding.material=new o.MeshBasicMaterial({color:9595,map:e.assets.glow_tex,transparent:!0,blending:o.AdditiveBlending}),this.ballColliding.renderOrder=10,this.ballColliding.visible=!1,this.teleportEntity.add(this.ballColliding),this.teleportHitGeometry.visible=!1,this.teleportHitGeometry.position.set(-2,0,-2),this.teleportEntity.add(this.teleportHitGeometry),this.ctx.scene.add(this.teleportEntity);try{this.startSound=new o.Audio(e.audioListener),this.startSound.setBuffer(e.assets.teleport_a_snd),this.startSound.setLoop(!0),this.startSound.pause()}catch(e){console.warn("Failed to initialize start sound:",e),this.startSound=null}try{this.endSound=new o.Audio(e.audioListener),this.endSound.setBuffer(e.assets.teleport_b_snd),this.endSound.setLoop(!1),this.endSound.pause()}catch(e){console.warn("Failed to initialize end sound:",e),this.endSound=null}}onSelectStart(e){this.active=!0,this.endSound&&this.endSound.pause(),this.startSound&&this.startSound.play()}onHoverLeave(){this.ballColliding.visible=!1,this.teleportHitGeometry.visible=!1,this.startSound&&this.startSound.pause()}onHover(e,t){t?(this.teleportHitGeometry.visible=!0,this.teleportHitGeometry.position.copy(e),this.hit=!0,this.ballColliding.visible=!1):(this.ballColliding.visible=!0,this.ballColliding.position.copy(e))}onSelectEnd(e){const t=this.ctx.renderer.xr.getCamera(this.ctx.camera).position,r=e.sub(t);r.y=0,this.ctx.cameraRig.position.add(r),this.teleportHitGeometry.visible=!1,this.active=!1,this.startSound&&this.startSound.pause(),this.endSound&&this.endSound.play()}}const Z=16739179,X=16755021,$=7649791,Y=14037892,J=4876733,Q=2148759,ee=1548984,te=55807,re={He:16770273,Ne:16739072,Ar:8087790,Kr:52945,Xe:4286945,Rn:14745599},oe=[{symbol:"H",name:"Wasserstoff",atomicNumber:1,mass:1.008,group:"nonmetal",period:1,block:"s",groupNumber:1,color:16761095,description:"Das häufigste Element im Universum. Bildet 75% der Masse der Sonne.",theme:"cosmic",experiments:["knallgas","fusion","fuelcell"]},{symbol:"He",name:"Helium",atomicNumber:2,mass:4.003,group:"nobleGas",period:1,block:"s",groupNumber:18,color:re.He,description:"Das zweithäufigste Element im Universum. Wurde zuerst im Sonnenspektrum entdeckt.",theme:"solar",experiments:["superfluid","voiceshift"]},{symbol:"Li",name:"Lithium",atomicNumber:3,mass:6.941,group:"alkali",period:2,block:"s",groupNumber:1,color:Z,description:"Das leichteste Metall. Wichtiger Bestandteil von Lithium-Ionen-Batterien.",theme:"energy",experiments:["waterReaction","battery"]},{symbol:"Be",name:"Beryllium",atomicNumber:4,mass:9.012,group:"alkalineEarth",period:2,block:"s",groupNumber:2,color:X,description:"Hochgiftiges Metall mit niedriger Dichte. Verwendet in der Weltraumtechnik.",theme:"gem",experiments:["crystal","toxicity"]},{symbol:"B",name:"Bor",atomicNumber:5,mass:10.81,group:"metalloid",period:2,block:"p",groupNumber:13,color:ee,description:"Hartes Material für Glasfasern. Kommt in Wüstensalzen vor.",theme:"desert",experiments:["borax","fiberglass"]},{symbol:"C",name:"Kohlenstoff",atomicNumber:6,mass:12.011,group:"nonmetal",period:2,block:"p",groupNumber:14,color:16761095,description:"Das Element des Lebens. Grundbaustein aller organischen Verbindungen.",theme:"life",experiments:["diamond","graphite","dna"]},{symbol:"N",name:"Stickstoff",atomicNumber:7,mass:14.007,group:"nonmetal",period:2,block:"p",groupNumber:15,color:16761095,description:"Macht 78% der Atmosphäre aus. Essentiell für Proteine und DNA.",theme:"atmosphere",experiments:["liquid","haberbosch","fertilizer"]},{symbol:"O",name:"Sauerstoff",atomicNumber:8,mass:15.999,group:"nonmetal",period:2,block:"p",groupNumber:16,color:16761095,description:"Zweithäufigstes Element im Universum. Notwendig für Atmung und Verbrennung.",theme:"breath",experiments:["combustion","ozone","photosynthesis"]},{symbol:"F",name:"Fluor",atomicNumber:9,mass:18.998,group:"halogen",period:2,block:"p",groupNumber:17,color:te,description:"Reaktivstes aller Elemente. Wird in Teflon und Zahncreme verwendet.",theme:"protection",experiments:["reaction","teflon"]},{symbol:"Ne",name:"Neon",atomicNumber:10,mass:20.18,group:"nobleGas",period:2,block:"p",groupNumber:18,color:re.Ne,description:"Leuchtet bei elektrischer Entladung orange-rot. Symbol der Stadtbeleuchtung.",theme:"lights",experiments:["neon","laser"]},{symbol:"Na",name:"Natrium",atomicNumber:11,mass:22.99,group:"alkali",period:3,block:"s",groupNumber:1,color:Z,description:"Silberglänzendes Metall, butterweich. Basis für Speisesalz (NaCl).",theme:"kitchen",experiments:["water","flame","saltcrystal"]},{symbol:"Mg",name:"Magnesium",atomicNumber:12,mass:24.305,group:"alkalineEarth",period:3,block:"s",groupNumber:2,color:X,description:"Blendend weißes Licht beim Verbrennen. Kommt in Chlorophyll vor.",theme:"light",experiments:["flash","chlorophyll","alloy"]},{symbol:"Al",name:"Aluminium",atomicNumber:13,mass:26.982,group:"metal",period:3,block:"p",groupNumber:13,color:Q,description:"Das häufigste Metall der Erdkruste. Leicht und korrosionsbeständig.",theme:"industry",experiments:["hallheroult","thermit","foil"]},{symbol:"Si",name:"Silizium",atomicNumber:14,mass:28.086,group:"metalloid",period:3,block:"p",groupNumber:14,color:ee,description:"Zweithäufigstes Element der Erdkruste. Basis aller modernen Elektronik.",theme:"silicon",experiments:["transistor","solar","sand"]},{symbol:"P",name:"Phosphor",atomicNumber:15,mass:30.974,group:"nonmetal",period:3,block:"p",groupNumber:15,color:16761095,description:"Glüht weiß im Dunkeln. Wichtiger Bestandteil von DNA und ATP.",theme:"fire",experiments:["white","red","match"]},{symbol:"S",name:"Schwefel",atomicNumber:16,mass:32.065,group:"nonmetal",period:3,block:"p",groupNumber:16,color:16761095,description:"Gelbes Element mit charakteristischem Geruch. Kommt in Vulkanen vor.",theme:"volcano",experiments:["burning","gunpowder","bromo"]},{symbol:"Cl",name:"Chlor",atomicNumber:17,mass:35.453,group:"halogen",period:3,block:"p",groupNumber:17,color:te,description:"Grün-gelbes Giftgas. Wird zur Wasserdesinfektion verwendet.",theme:"swimming",experiments:["disinfection","salt","gas"]},{symbol:"Ar",name:"Argon",atomicNumber:18,mass:39.948,group:"nobleGas",period:3,block:"p",groupNumber:18,color:re.Ar,description:"Häufigstes Edelgas (1% Atmosphäre). Wird für WIG-Schweißen verwendet.",theme:"welding",experiments:["plasma","inert"]},{symbol:"Ca",name:"Calcium",atomicNumber:20,mass:40.078,group:"alkalineEarth",period:4,block:"s",groupNumber:2,color:X,description:"Bauknochen des Lebens. Fünft-häufigstes Element der Erdkruste.",theme:"skeleton",experiments:["burning","bones","limestone"]},{symbol:"Fe",name:"Eisen",atomicNumber:26,mass:55.845,group:"transition",period:4,block:"d",groupNumber:8,color:$,description:"Wichtigstes Metall der Menschheit. Grundbaustein von Stahl und Hämoglobin.",theme:"forge",experiments:["magnet","rust","steel"]},{symbol:"Cu",name:"Kupfer",atomicNumber:29,mass:63.546,group:"transition",period:4,block:"d",groupNumber:11,color:$,description:"Erstes Metall der Menschheit. Exzellenter elektrischer Leiter.",theme:"electric",experiments:["conductivity","patina","bronze"]},{symbol:"Au",name:"Gold",atomicNumber:79,mass:196.967,group:"transition",period:6,block:"d",groupNumber:11,color:$,description:"Edelstes Metall. Einziges gelbes Metall (relativistische Effekte).",theme:"treasure",experiments:["ductility","alloys","electroplating"]},{symbol:"U",name:"Uran",atomicNumber:92,mass:238.029,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Schwerstes häufiges natürliches Element. Basis für Kernenergie.",theme:"nuclear",experiments:["fission","decay","fluorescence"]},{symbol:"K",name:"Kalium",atomicNumber:19,mass:39.098,group:"alkali",period:4,block:"s",groupNumber:1,color:Z,description:"Reaktiv Metall, in der Natur oft als Ion. Wesentlich für biologische Prozesse.",theme:"biological",experiments:["water","flame","banane"]},{symbol:"Ca",name:"Calcium",atomicNumber:20,mass:40.078,group:"alkalineEarth",period:4,block:"s",groupNumber:2,color:X,description:"Fünft-häufigstes Element der Erdkruste. Fünft-häufigstes Element im menschlichen Körper.",theme:"biological",experiments:["burning","knochen","kalkstein"]},{symbol:"Sc",name:"Scandium",atomicNumber:21,mass:44.956,group:"transition",period:4,block:"d",groupNumber:3,color:$,description:"Seltenes Übergangsmetall. Wird in Sportgeräten und Hochleistungslegierungen verwendet.",theme:"aerospace",experiments:["alloy","magnetic","sport"]},{symbol:"Ti",name:"Titan",atomicNumber:22,mass:47.867,group:"transition",period:4,block:"d",groupNumber:4,color:$,description:"Korrosionsbeständiges Metall mit hohem Schmelzpunkt. Für Luft- und Raumfahrtindustrie.",theme:"aerospace",experiments:["biokompatibilität","legierung","oxid"]},{symbol:"V",name:"Vanadium",atomicNumber:23,mass:50.942,group:"transition",period:4,block:"d",groupNumber:5,color:$,description:"Hartes, grau-weißes Metall. Für Werkzeugstahl und Titanlegierungen.",theme:"industry",experiments:["stahl","legierung","katalysator"]},{symbol:"Cr",name:"Chrom",atomicNumber:24,mass:51.996,group:"transition",period:4,block:"d",groupNumber:6,color:$,description:"Glänzendes, korrosionsbeständiges Metall. Basis von Edelstahl und Verchromung.",theme:"industry",experiments:["edelstahl","verchromung","pigment"]},{symbol:"Mn",name:"Mangan",atomicNumber:25,mass:54.938,group:"transition",period:4,block:"d",groupNumber:7,color:$,description:"Wichtig für Stahlherstellung. Bioelement für Photosynthese.",theme:"industry",experiments:["stahl","photosynthese","batterie"]},{symbol:"Co",name:"Kobalt",atomicNumber:27,mass:58.933,group:"transition",period:4,block:"d",groupNumber:9,color:$,description:"Blau-graues, ferromagnetisches Metall. Für Supraleger, Magnete und Lithium-Ionen-Batterien.",theme:"technology",experiments:["magnet","batterie","legierung"]},{symbol:"Ni",name:"Nickel",atomicNumber:28,mass:58.693,group:"transition",period:4,block:"d",groupNumber:10,color:$,description:"Silbrig-weißes, korrosionsbeständiges Metall. Münzmetall und für Legierungen.",theme:"technology",experiments:["münzen","legierung","katalysator"]},{symbol:"Zn",name:"Zink",atomicNumber:30,mass:65.38,group:"transition",period:4,block:"d",groupNumber:12,color:$,description:"Reaktionsfreies Metall. Für galvanische Zellen, Verzinkung und Zink-Legierungen.",theme:"technology",experiments:["galvanik","verzinkung","batterie"]},{symbol:"Ga",name:"Gallium",atomicNumber:31,mass:69.723,group:"metal",period:4,block:"p",groupNumber:13,color:Q,description:"Schmilzt in der Hand bei Raumtemperatur. Für Halbleiter und Hochtemperaturthermometer.",theme:"semiconductor",experiments:["schmelzen","halbleiter","thermometer"]},{symbol:"Ge",name:"Germanium",atomicNumber:32,mass:72.63,group:"metalloid",period:4,block:"p",groupNumber:14,color:ee,description:"Halbleiter für Transistoren und Optoelektronik. Silizium-Alternative.",theme:"semiconductor",experiments:["halbleiter","transistor","faser"]},{symbol:"As",name:"Arsen",atomicNumber:33,mass:74.922,group:"metalloid",period:4,block:"p",groupNumber:15,color:ee,description:"Sehr giftiges Halbmetall. Historisch in Tapeten und Farben verwendet.",theme:"toxic",experiments:["gift","historisch","semiconductor"]},{symbol:"Se",name:"Selen",atomicNumber:34,mass:78.96,group:"nonmetal",period:4,block:"p",groupNumber:16,color:16761095,description:"Wichtiges Spurenelement. Halbleiter und für Glühbirren.",theme:"semiconductor",experiments:["glühbirne","photovoltaik","toxisch"]},{symbol:"Br",name:"Brom",atomicNumber:35,mass:79.904,group:"halogen",period:4,block:"p",groupNumber:17,color:te,description:"Einziges flüssige Nichtmetall bei Raumtemperatur. Rote Farbe, stechender Geruch.",theme:"liquid",experiments:["flüssig","flammmittel","giftig"]},{symbol:"Kr",name:"Krypton",atomicNumber:36,mass:83.798,group:"nobleGas",period:4,block:"p",groupNumber:18,color:re.Kr,description:"Edelgas mit hoher Dichte. Für Blitzlichtlampen und Laser.",theme:"lighting",experiments:["laser","neon","isoliert"]},{symbol:"Rb",name:"Rubidium",atomicNumber:37,mass:85.468,group:"alkali",period:5,block:"s",groupNumber:1,color:Z,description:"Weiches, hochreaktives Metall. Für Atomuhren und Feuerwerk.",theme:"pyrotechnics",experiments:["atomuhr","feuerwerk","reaktion"]},{symbol:"Sr",name:"Strontium",atomicNumber:38,mass:87.62,group:"alkalineEarth",period:5,block:"s",groupNumber:2,color:X,description:"Für rote Feuerwerke und Magnete. Radioaktiv (Strontium-90).",theme:"pyrotechnics",experiments:["feuerwerk","magnet","radioaktiv"]},{symbol:"Y",name:"Yttrium",atomicNumber:39,mass:88.906,group:"transition",period:5,block:"d",groupNumber:3,color:$,description:"Seltenes Erdelement. Für LEDs, Supraleiter und Laser.",theme:"technology",experiments:["led","laser","supraleiter"]},{symbol:"Zr",name:"Zirkonium",atomicNumber:40,mass:91.224,group:"transition",period:5,block:"d",groupNumber:4,color:$,description:"Korrosionsbeständiges Metall. Für Kernelemente und medizinische Implantate.",theme:"nuclear",experiments:["kernelement","implantat","keramik"]},{symbol:"Nb",name:"Niob",atomicNumber:41,mass:92.906,group:"transition",period:5,block:"d",groupNumber:5,color:$,description:"Supraleiter bei niedrigen Temperaturen. Für Beschleunigermagnete und Hochspannungstechnik.",theme:"technology",experiments:["supraleiter","magnet","hochspannung"]},{symbol:"Mo",name:"Molybdän",atomicNumber:42,mass:95.95,group:"transition",period:5,block:"d",groupNumber:6,color:$,description:"Extrem hartes Metall. Für Hochtemperaturanwendungen und Schmierstoffe.",theme:"industry",experiments:["hochtemperatur","schmiermittel","stahl"]},{symbol:"Tc",name:"Technetium",atomicNumber:43,mass:98,group:"transition",period:5,block:"d",groupNumber:7,color:$,description:"Erstes künstliche Element. Radioaktiv. In der medizinischen Bildgebung verwendet.",theme:"nuclear",experiments:["künstlich","medizin","radioaktiv"]},{symbol:"Ru",name:"Ruthenium",atomicNumber:44,mass:101.07,group:"transition",period:5,block:"d",groupNumber:8,color:$,description:"Seltenes, aber wichtiges Metall. Für Elektronikkontakte und Katalysatoren.",theme:"technology",experiments:["katalysator","kontakte","legierung"]},{symbol:"Rh",name:"Rhodium",atomicNumber:45,mass:102.91,group:"transition",period:5,block:"d",groupNumber:9,color:$,description:"Sehr wertvolles Übergangsmetall. Für Katalysatoren, Schmuck und Thermoelemente.",theme:"technology",experiments:["katalysator","schmuck","thermo"]},{symbol:"Pd",name:"Palladium",atomicNumber:46,mass:106.42,group:"transition",period:5,block:"d",groupNumber:10,color:$,description:"Wertvolles Platin-Metall. Für Katalysatoren, Schmuck und Wasserstofffilter.",theme:"technology",experiments:["katalysator","schmuck","wasserstoff"]},{symbol:"Ag",name:"Silber",atomicNumber:47,mass:107.87,group:"transition",period:5,block:"d",groupNumber:11,color:$,description:"Bester elektrischer Leiter aller Metalle. Für Schmuck, Elektronik und Fotografie.",theme:"precious",experiments:["elektrisch","schmuck","fotografie"]},{symbol:"Cd",name:"Cadmium",atomicNumber:48,mass:112.41,group:"transition",period:5,block:"d",groupNumber:12,color:$,description:"Giftiges Metall. Für NiCd-Batterien, Pigmente und galvanische Elemente.",theme:"toxic",experiments:["batterie","pigment","toxisch"]},{symbol:"In",name:"Indium",atomicNumber:49,mass:114.82,group:"metal",period:5,block:"p",groupNumber:13,color:Q,description:"Weiches Metall. Für ITO-Schichten (Touchscreens), Transistoren und Lötzinn.",theme:"semiconductor",experiments:["touchscreen","lötinn","halbleiter"]},{symbol:"Sn",name:"Zinn",atomicNumber:50,mass:118.71,group:"metal",period:5,block:"p",groupNumber:14,color:Q,description:"Historisch wichtiges Metall. Für Lötlegierungen, Bronze und Konservendosen.",theme:"history",experiments:["löten","bronze","konserven"]},{symbol:"Sb",name:"Antimon",atomicNumber:51,mass:121.76,group:"metalloid",period:5,block:"p",groupNumber:15,color:ee,description:"Halbmetall mit ungewöhnlichen Eigenschaften. Für Flammhemmer und Legierungen.",theme:"industry",experiments:["flammhemmer","legierung","halbleiter"]},{symbol:"Te",name:"Tellur",atomicNumber:52,mass:127.6,group:"metalloid",period:5,block:"p",groupNumber:16,color:ee,description:"Seltenes, seltenes Halbmetall. Für Solarzellen und Legierungen.",theme:"semiconductor",experiments:["solarzelle","legierung","cdte"]},{symbol:"I",name:"Jod",atomicNumber:53,mass:126.9,group:"halogen",period:5,block:"p",groupNumber:17,color:te,description:"Wichtigstes Spurenelement für Schilddrüse. Dunkle Substanz mit charakteristischem Geruch.",theme:"biological",experiments:["schilddrüse","antiseptik","sublimation"]},{symbol:"Xe",name:"Xenon",atomicNumber:54,mass:131.29,group:"nobleGas",period:5,block:"p",groupNumber:18,color:re.Xe,description:"Schweres Edelgas. Für Ionentriebwerke, Narkose und Blitzlichtlampen.",theme:"space",experiments:["ionentrieb","narkose","laser"]},{symbol:"Cs",name:"Cäsium",atomicNumber:55,mass:132.91,group:"alkali",period:6,block:"s",groupNumber:1,color:Z,description:"Weiches, hochreaktives Metall. Schmilzt in der Hand. Präzisesste Zeitnormal.",theme:"precision",experiments:["schmelzen","atomuhr","explosion"]},{symbol:"Ba",name:"Barium",atomicNumber:56,mass:137.33,group:"alkalineEarth",period:6,block:"s",groupNumber:2,color:X,description:"Für medizinische Kontrastmittel und grüne Feuerwerke. Schwerkresistent.",theme:"medical",experiments:["kontrastmittel","feuerwerk","magnet"]},{symbol:"La",name:"Lanthan",atomicNumber:57,mass:138.91,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Weiches, duktils Metall. Für Hybridauto-Batterien und Zündsteine.",theme:"technology",experiments:["batterie","zündsteine","optik"]},{symbol:"Ce",name:"Cer",atomicNumber:58,mass:140.12,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Häufigstes Lanthanoid. Für Ferrocer-Feuerzeuge und Autokatalysatoren.",theme:"technology",experiments:["feuerzeuge","katalysator","selbstreinigend"]},{symbol:"Pr",name:"Praseodym",atomicNumber:59,mass:140.91,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Für Magnetlegierungen und Grüne Farbe. Wichtig für Hightech-Legierungen.",theme:"technology",experiments:["magnet","grün","legierung"]},{symbol:"Nd",name:"Neodym",atomicNumber:60,mass:144.24,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Stärkste Permanentmagnete. Für Kopfhörer, Windturbinen und Festplatten.",theme:"technology",experiments:["magnet","kopfhörer","windturbine"]},{symbol:"Pm",name:"Promethium",atomicNumber:61,mass:145,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Künstliches, radioaktives Element. Für Kernbatterien in Raumfahrzeugen.",theme:"space",experiments:["künstlich","kernbatterie","radioaktiv"]},{symbol:"Sm",name:"Samarium",atomicNumber:62,mass:150.36,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Für Permanentmagnete und Kernreaktor-Steuerstäbe.",theme:"nuclear",experiments:["magnet","reaktor","absorber"]},{symbol:"Eu",name:"Europium",atomicNumber:63,mass:151.96,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Rot phosphoreszierend in Euro-Scheinen. Für Sicherheit und Lasermaterialien.",theme:"security",experiments:["phosphoreszenz","euro","laser"]},{symbol:"Gd",name:"Gadolinium",atomicNumber:64,mass:157.25,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Höchste Neutronenabsorption. Für MRT-Kontrastmittel und Kernreaktorsteuerung.",theme:"medical",experiments:["mrt","reaktor","absorber"]},{symbol:"Tb",name:"Terbium",atomicNumber:65,mass:158.93,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Weiches Lanthanoid. Für Phosphorleuchtstoffe und Elektromotore.",theme:"technology",experiments:["phosphor","magnet","motor"]},{symbol:"Dy",name:"Dysprosium",atomicNumber:66,mass:162.5,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Hochwertiges Lanthanoid. Für Kernreaktorsteuerstäbe und Magnetlegierungen.",theme:"nuclear",experiments:["reaktor","magnet","legierung"]},{symbol:"Ho",name:"Holmium",atomicNumber:67,mass:164.93,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Besitzt höchstes magnetisches Moment aller Elemente. Für Laser und Hochleistungsmagnete.",theme:"technology",experiments:["laser","magnet","hochleistung"]},{symbol:"Er",name:"Erbium",atomicNumber:68,mass:167.26,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Für Glasfaser-Verstärker und optische Verstärker. Rosarotes Leuchten.",theme:"technology",experiments:["glasfaser","optik","laser"]},{symbol:"Tm",name:"Thulium",atomicNumber:69,mass:168.93,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Für medizinische Röntgenanlagen. Röntgen-Kontrastmittel.",theme:"medical",experiments:["röntgen","medizin","laser"]},{symbol:"Yb",name:"Ytterbium",atomicNumber:70,mass:173.05,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Für Stahllegierungen und Röntgenanlagen. Rote Lumineszenz.",theme:"industry",experiments:["legierung","röntgen","luminiszenz"]},{symbol:"Lu",name:"Lutetium",atomicNumber:71,mass:174.97,group:"lanthanide",period:6,block:"f",groupNumber:3,color:Y,description:"Letztes natürliches Lanthanoid. Für PET-Scanner und Katalysatoren.",theme:"technology",experiments:["scanner","katalysator","spektrometer"]},{symbol:"Hf",name:"Hafnium",atomicNumber:72,mass:178.49,group:"transition",period:6,block:"d",groupNumber:4,color:$,description:"Korrosionsbeständiges Metall. Für Reaktordruckbehälter und Kernenergieanwendungen.",theme:"nuclear",experiments:["reaktor","kernenergie","legierung"]},{symbol:"Ta",name:"Tantal",atomicNumber:73,mass:180.95,group:"transition",period:6,block:"d",groupNumber:5,color:$,description:"Extrem korrosionsbeständig. Für Kondensatoren und elektronische Bauteile.",theme:"electronics",experiments:["kondensator","elektronik","korrosion"]},{symbol:"W",name:"Wolfram",atomicNumber:74,mass:183.84,group:"transition",period:6,block:"d",groupNumber:6,color:$,description:"Höchster Schmelzpunkt aller Elemente. Für Glühbirnen und Wolframbearbeitung.",theme:"technology",experiments:["glühbirne","bearbeitung","legierung"]},{symbol:"Re",name:"Rhenium",atomicNumber:75,mass:186.21,group:"transition",period:6,block:"d",groupNumber:7,color:$,description:"Selteneres, hochschmelzendes Metall. Für Düsenläufer und Hochtemperaturlegierungen.",theme:"aerospace",experiments:["düsenläufer","hochtemperatur","legierung"]},{symbol:"Os",name:"Osmium",atomicNumber:76,mass:190.23,group:"transition",period:6,block:"d",groupNumber:8,color:$,description:"Dichtestes natürliches Element. Für Schreibspitzen und Implantate.",theme:"technology",experiments:["schreibspitzen","implantat","legierung"]},{symbol:"Ir",name:"Iridium",atomicNumber:77,mass:192.22,group:"transition",period:6,block:"d",groupNumber:9,color:$,description:"Extrem korrosionsbeständiges Metall. Für Zündkerzen und Elektroden.",theme:"technology",experiments:["zündkerzen","elektroden","legierung"]},{symbol:"Pt",name:"Platin",atomicNumber:78,mass:195.08,group:"transition",period:6,block:"d",groupNumber:10,color:$,description:"Edelmetall für Katalysatoren, Schmuck und Katalysatoren. Beständiger als Gold.",theme:"precious",experiments:["katalysator","schmuck","legierung"]},{symbol:"Au",name:"Gold",atomicNumber:79,mass:196.97,group:"transition",period:6,block:"d",groupNumber:11,color:$,description:"Edelstes Metall, einziges gelbes Metall (relativistische Effekte). Für Elektronik und Schmuck.",theme:"treasure",experiments:["ductilität","legierungen","elektroplattierung"]},{symbol:"Hg",name:"Quecksilber",atomicNumber:80,mass:200.59,group:"transition",period:6,block:"d",groupNumber:12,color:$,description:"Einziges flüssiges Metall bei Raumtemperatur. Für Thermometer und Alchemiehistorie.",theme:"historical",experiments:["flüssig","thermometer","alchemie"]},{symbol:"Tl",name:"Thallium",atomicNumber:81,mass:204.38,group:"metal",period:6,block:"p",groupNumber:13,color:Q,description:"Giftiges, weiches Metall. Historisch in Mordfällen verwendet. Für Glasherstellung.",theme:"toxic",experiments:["gift","glasherstellung","temperatur"]},{symbol:"Pb",name:"Blei",atomicNumber:82,mass:207.2,group:"metal",period:6,block:"p",groupNumber:14,color:Q,description:"Schwerstes stabiles Element. Für Akkus und Röntgenschutz. Römisches Erbe.",theme:"history",experiments:["akkus","röntgen","blei"]},{symbol:"Bi",name:"Wismut",atomicNumber:83,mass:208.98,group:"metalloid",period:6,block:"p",groupNumber:15,color:ee,description:"Dichtes, schmelzendes Metall. Für Kosmetika, Schmiermittel und Röntgenkontrast.",theme:"medical",experiments:["kosmetika","schmiermittel","röntgen"]},{symbol:"Po",name:"Polonium",atomicNumber:84,mass:209,group:"metalloid",period:6,block:"p",groupNumber:16,color:ee,description:"Hochradioaktiv, starkes Metall. Historisch berühmt (Curie). Für Alphastrahler.",theme:"nuclear",experiments:["alphastrahler","radioaktiv","wärmequelle"]},{symbol:"At",name:"Astatin",atomicNumber:85,mass:210,group:"halogen",period:6,block:"p",groupNumber:17,color:te,description:"Seltenstes natürliches Element. Halbwertszeit ~8 Stunden. Für Forschung.",theme:"research",experiments:["forschung","halbwertszeit","instabil"]},{symbol:"Rn",name:"Radon",atomicNumber:86,mass:222,group:"nobleGas",period:6,block:"p",groupNumber:18,color:re.Rn,description:"Radionuklid, zweithäufigste Lungenkrebsursache. Für Radonmessung und Schutz.",theme:"radiation",experiments:["radonmessung","schutz","zerfall"]},{symbol:"Fr",name:"Francium",atomicNumber:87,mass:223,group:"alkali",period:7,block:"s",groupNumber:1,color:Z,description:"Instabil, radioaktiv. Nie makroskopisch beobachtet. Hypothetische Wasserreaktion.",theme:"theoretical",experiments:["instabil","halbwertszeit","theoretisch"]},{symbol:"Ra",name:"Radium",atomicNumber:88,mass:226,group:"alkalineEarth",period:7,block:"s",groupNumber:2,color:X,description:"Hochradioaktiv, luminiszierendes Metall. Leuchtet im Dunkeln. Für historische Lampen.",theme:"historical",experiments:["leuchten","historisch","radioaktiv"]},{symbol:"Ac",name:"Actinium",atomicNumber:89,mass:227,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Namensgeber der Actinoide. Radioaktiv. Ausgangsstoff für Urananreicherung.",theme:"nuclear",experiments:["urananreicherung","strahlung","zerfall"]},{symbol:"Th",name:"Thorium",atomicNumber:90,mass:232.04,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Für Flüssigsalzreaktoren. Sicherer und abundanter als Uran. Mythologisch benannt.",theme:"nuclear",experiments:["flüssigsalzreaktor","sicherheit","kernenergie"]},{symbol:"Pa",name:"Protactinium",atomicNumber:91,mass:231.04,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Selteneres, radioaktives Element. Für Kernreaktor-Forschung.",theme:"research",experiments:["forschung","kernreaktor","urananreicherung"]},{symbol:"Np",name:"Neptunium",atomicNumber:93,mass:237,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. Erste in Atomversuchen produziert. Für Plutonium-Herstellung.",theme:"nuclear",experiments:["künstlich","plutonium","reaktor"]},{symbol:"Pu",name:"Plutonium",atomicNumber:94,mass:244,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Tödlichste Substanz. Mikrogramm können töten. Für Kernwaffen und Raumfahrt-RTGs.",theme:"nuclear",experiments:["kernwaffen","raumfahrt","gefahr"]},{symbol:"Am",name:"Americium",atomicNumber:95,mass:243,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. Entdeckt in H-Bomben-Fallout (Ivy Mike 1952). Für Rauchdetektoren.",theme:"space",experiments:["rauchdetektor","h-bombe","spuren"]},{symbol:"Cm",name:"Curium",atomicNumber:96,mass:247,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. Namensgeber: Pierre und Marie Curie. Für Raumschiff-RTGs.",theme:"space",experiments:["raumfahrt","curie","kernenergie"]},{symbol:"Bk",name:"Berkelium",atomicNumber:97,mass:247,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. Sehr kurzlebig. Für wissenschaftliche Forschung.",theme:"research",experiments:["forschung","kernchemie","instabil"]},{symbol:"Cf",name:"Californium",atomicNumber:98,mass:251,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. Für Neutronenquellen und Elementsynthese.",theme:"nuclear",experiments:["neutronenquelle","synthese","zerfall"]},{symbol:"Es",name:"Einsteinium",atomicNumber:99,mass:252,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. Entdeckt 1952 im Fallout der H-Bombe Ivy Mike. In Gedenken an Einstein.",theme:"history",experiments:["historisch","h-bombe","memorial"]},{symbol:"Fm",name:"Fermium",atomicNumber:100,mass:257,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. Namensgeber: Enrico Fermi. Für theoretische Kernreaktoren.",theme:"research",experiments:["reaktor","theoretisch","nuklearphysik"]},{symbol:"Md",name:"Mendelevium",atomicNumber:101,mass:258,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. In Gedenken an Mendelejew. Ehemaliges Element 101.",theme:"history",experiments:["historisch","periodensystem","tradition"]},{symbol:"No",name:"Nobelium",atomicNumber:102,mass:259,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Künstliches Element. Benannt nach Alfred Nobel. Für wissenschaftliche Anerkennung.",theme:"history",experiments:["auszeichnung","nobelpreis","forschung"]},{symbol:"Lr",name:"Lawrencium",atomicNumber:103,mass:262,group:"actinide",period:7,block:"f",groupNumber:3,color:J,description:"Letztes natürliches Element. Namensgeber: Ernest Lawrence. Entdeckung der Lanthanoide.",theme:"discovery",experiments:["entdeckung","synchrotron","teilchenbeschleuniger"]},{symbol:"Rf",name:"Rutherfordium",atomicNumber:104,mass:267,group:"actinide",period:7,block:"d",groupNumber:4,color:J,description:"Künstliches Element. Namensgeber: Ernest Rutherford. Entdeckung des Atomkerns.",theme:"research",experiments:["kernphysik","teilchen","reaktor"]},{symbol:"Db",name:"Dubnium",atomicNumber:105,mass:268,group:"actinide",period:7,block:"d",groupNumber:5,color:J,description:"Künstliches Element. Namensgeber: Stadt Dubna. Forschungszentrum Russlands.",theme:"research",experiments:["forschung","kernchemie","instabil"]},{symbol:"Sg",name:"Seaborgium",atomicNumber:106,mass:269,group:"actinide",period:7,block:"d",groupNumber:6,color:J,description:"Künstliches Element. Namensgeber: Glenn Seaborg. Forschungszentrum USA.",theme:"research",experiments:["forschung","chemie","synthese"]},{symbol:"Bh",name:"Bohrium",atomicNumber:107,mass:270,group:"actinide",period:7,block:"d",groupNumber:7,color:J,description:"Künstliches Element. Namensgeber: Niels Bohr. Quantenmechanik-Revolution.",theme:"science",experiments:["quantenmechanik","theoretisch","modell"]},{symbol:"Hs",name:"Hassium",atomicNumber:108,mass:277,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Hessen (Bundesland). Erste deutsche Entdeckung.",theme:"discovery",experiments:["entdeckung","deutsch","teilchen"]},{symbol:"Mt",name:"Meitnerium",atomicNumber:109,mass:278,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Lise Meitner. Entdeckung der Kernspaltung.",theme:"history",experiments:["kernspaltung","uran","geschichte"]},{symbol:"Ds",name:"Darmstadtium",atomicNumber:110,mass:281,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Darmstadt. GSI Teilchenbeschleuniger.",theme:"research",experiments:["teilchenbeschleuniger","schwerionen","synthese"]},{symbol:"Rg",name:"Roentgenium",atomicNumber:111,mass:282,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Wilhelm Röntgen. Für medizinische Bildgebung.",theme:"medical",experiments:["röntgen","medizin","synthese"]},{symbol:"Cn",name:"Copernicium",atomicNumber:112,mass:285,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Nikolaus Kopernikus. Revolution des Weltbilds.",theme:"history",experiments:["astronomie","revolution","universum"]},{symbol:"Nh",name:"Nihonium",atomicNumber:113,mass:286,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Japan. Für Elementsynthese-Forschung.",theme:"research",experiments:["synthese","element","forschung"]},{symbol:"Fl",name:"Flerovium",atomicNumber:114,mass:289,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Georgij Flerow. Für theoretische Physik.",theme:"science",experiments:["theoretisch","modell","stabilität"]},{symbol:"Mc",name:"Moscovium",atomicNumber:115,mass:290,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Moskau. Dubiose Entdeckungsgeschichte.",theme:"history",experiments:["dubios","synthese","wissenschaft"]},{symbol:"Lv",name:"Livermorium",atomicNumber:116,mass:293,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Lawrence Livermore National Laboratory. Element 116.",theme:"research",experiments:["element116","kernreaktor","synthese"]},{symbol:"Ts",name:"Tennessin",atomicNumber:117,mass:294,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Künstliches Element. Namensgeber: Tennessee (USA). Superheavy-Elemente-Forschung.",theme:"research",experiments:["superheavy","inselfstabilität","synthese"]},{symbol:"Og",name:"Oganesson",atomicNumber:118,mass:294,group:"actinide",period:7,block:"d",groupNumber:8,color:J,description:"Schwerstes natürliches Element. Namensgeber: Yuri Oganessian. Insel der Stabilität gesucht.",theme:"discovery",experiments:["inselfstabilität","insel","theoretisch"]}];const ne=[{id:"reaction_lab",name:"Reaktionslabor",description:"Die Alchemistenwerkstatt",icon:"🧪",color:16739179,experiments:["alkali_water","thermit","elefantenzahnpasta"]},{id:"nuclear_chamber",name:"Nuklearphysik",description:"Kernkraftwerk-Kontrollraum",icon:"☢️",color:4876733,experiments:["fission","fusion","decay"]},{id:"electrochem_lab",name:"Elektrochemie",description:"Batterien und Elektrolyse",ion:"🔋",color:7649791,experiments:["lion_battery","galvanic","electrolysis"]},{id:"organic_chem",name:"Organische Chemie",description:"Das Kohlenstoff-Universum",icon:"🧬",color:2148759,experiments:["dna","proteins","polymers"]},{id:"extreme_conditions",name:"Extreme Bedingungen",description:"Grenzen der Materie",icon:"🌡️",color:16755021,experiments:["superfluid","plasma","highpressure"]},{id:"industrial_apps",name:"Industrielle Anwendungen",description:"Großindustrie der Chemie",icon:"🏭",color:7649791,experiments:["haberbosch","blastfurnace","petrochemical"]},{id:"historical_lab",name:"Historisches Labor",description:"Meilensteine der Entdeckung",icon:"🏛️",color:14037892,experiments:["marie_curie","lavoisier","mendeleev"]},{id:"space_chem",name:"Weltraumchemie",description:"Chemie im Kosmos",icon:"🚀",color:657946,experiments:["nucleosynthesis","meteorites","interstellar"]},{id:"nano_world",name:"Nano-Welt",description:"Die atomare Perspektive",icon:"🔬",color:1548984,experiments:["crystals","orbitals","nanotubes"]},{id:"challenge_arena",name:"Challenge-Arena",description:"Quiz und Wettkampf",icon:"🏆",color:16761095,experiments:["quiz","puzzle","escape_room"]}];var ie,se,ae,le,ce=[],me=[],ue=[],de=null;function pe(e){(ie=new o.Scene).background=new o.Color(657946);const t=new o.CylinderGeometry(15,15,.2,64),r=new o.MeshBasicMaterial({color:1710638}),n=new o.Mesh(t,r);n.position.y=-.1,ie.add(n);const i=new o.PlaneBufferGeometry(30,30),s=new o.MeshBasicMaterial({visible:!1});(le=new o.Mesh(i,s)).rotation.x=-Math.PI/2,le.position.y=.001,ie.add(le),function(e){const t=new o.Group,r=new o.SphereGeometry(.8,32,32),n=new o.MeshBasicMaterial({color:4886754,transparent:!0,opacity:.8});(se=new o.Mesh(r,n)).position.y=1.6,t.add(se);const i=new o.SphereGeometry(.8*1.5,32,32),s=new o.MeshBasicMaterial({color:4886754,transparent:!0,opacity:.3,side:o.BackSide}),a=new o.Mesh(i,s);a.position.y=1.6,t.add(a),ie.add(t)}(),function(e){const t=[16739179,5301186,16098851];[1,2,3].forEach((e,r)=>{const n=4+1.5*e,i=new o.TorusGeometry(n,.02,16,100),s=new o.MeshBasicMaterial({color:t[r%t.length],transparent:!0,opacity:.5}),a=new o.Mesh(i,s);a.rotation.x=Math.PI/2,a.position.y=1.6,ie.add(a);const l=new o.SphereGeometry(.1,16,16),c=new o.MeshBasicMaterial({color:16777215}),m=new o.Mesh(l,c),u=new o.Group;u.position.y=1.6,u.add(m),m.userData={angle:Math.random()*Math.PI*2,speed:.5/(.7*e),radius:n},ie.add(u),ce.push(u)})}(),function(e){const t=new o.Group;for(let e=0;e<oe.length&&e<3;e++){const r=oe[e],n=new o.BoxGeometry(12/18*.8,.8,.05),i=new o.MeshBasicMaterial({color:r.color,transparent:!0,opacity:.3,side:o.DoubleSide}),s=new o.Mesh(n,i),a=(r.groupNumber-9)*(12/18),l=1*(4-r.period);s.position.set(a,l+2,-6),s.userData.element=r,s.name="element_"+r.symbol,t.add(s)}t,ie.add(t)}(),function(e){const t=new o.Group,r=2*Math.PI/oe.length;oe.forEach((n,i)=>{const s=i*r,a=8*Math.cos(s),l=8*Math.sin(s),c=new o.SphereGeometry(.25,16,16),m=new o.MeshBasicMaterial({color:n.color,transparent:!0,opacity:.7}),u=new o.Mesh(c,m);u.position.set(a,1.6,l),u.userData.element=n,u.userData.roomIndex=i+1,u.name=`element_${n.symbol}_button`,t.add(u),me.push(u);e.world.createEntity().addComponent(v,{text:n.symbol,color:"#ffffff",fontSize:.15,anchor:"center",baseline:"middle",textAlign:"center"}).addComponent(f,{value:u}).addComponent(y,{x:0,y:.4,z:0}),t.add(u)}),ie.add(t)}(e),function(e){const t=new o.Group,r=2*Math.PI/ne.length;ne.forEach((e,n)=>{const i=n*r,s=12*Math.cos(i),a=12*Math.sin(i),l=new o.BoxGeometry(.8,.8,.1),c=new o.MeshBasicMaterial({color:e.color,transparent:!0,opacity:.6}),m=new o.Mesh(l,c);m.position.set(s,1.6,a),m.userData.expRoom=e,m.userData.roomIndex=oe.length+n+1,m.name=`exp_${e.id}_button`,t.add(m),ue.push(m)}),ie.add(t)}(),function(e){const t=new o.PlaneGeometry(3,2),r=new o.MeshBasicMaterial({color:2763322,transparent:!0,opacity:.9,side:o.DoubleSide});(ae=new o.Mesh(t,r)).position.set(0,3.5,-4),ae.visible=!1,ie.add(ae);const n=e.world.createEntity();n.addComponent(v,{text:"",color:"#ffffff",fontSize:.12,anchor:"center",baseline:"top",textAlign:"center"}).addComponent(f,{value:ae}).addComponent(y,{x:0,y:.6,z:.01}),ae.userData.titleText=n;const i=e.world.createEntity();i.addComponent(v,{text:"",color:"#cccccc",fontSize:.06,anchor:"center",baseline:"top",textAlign:"center",maxWidth:2.6,lineHeight:1.4}).addComponent(f,{value:ae}).addComponent(y,{x:0,y:-.2,z:.01}),ae.userData.descText=i}(e);const a=new o.AmbientLight(16777215,.2);ie.add(a);const l=new o.PointLight(4886754,1,10);l.position.set(0,2,0),ie.add(l),ie.userData.teleport=le,ie.userData.atomCore=se,ie.userData.electronOrbits=ce,function(e){e.raycontrol.addState("lobbyElements",{colliderMesh:[...me],controller:"primary",onHover:(e,t)=>{const r=e.object;r.scale.setScalar(t?1.3:1),function(e){if(!e||de===e.symbol)return;de=e.symbol,ae.visible=!0;ae.userData.titleText.getComponent(v).text=`${e.symbol} - ${e.name}`;ae.userData.descText.getComponent(v).text=e.description}(r.userData.element)},onHoverLeave:e=>{he()},onSelectStart:(t,r)=>{e.goto=t.object.userData.roomIndex},onSelectEnd:e=>{}}),e.raycontrol.addState("lobbyExpRooms",{colliderMesh:[...ue],controller:"primary",onHover:(e,t)=>{e.object.scale.setScalar(t?1.2:1)},onHoverLeave:e=>{},onSelectStart:(t,r)=>{e.goto=t.object.userData.roomIndex},onSelectEnd:e=>{}}),e.raycontrol.addState("lobbyTeleport",{colliderMesh:le,controller:"primary",onHover:(t,r)=>{e.teleport.onHover(t.point,r)},onHoverLeave:()=>{e.teleport.onHoverLeave()},onSelectStart:(t,r)=>{e.teleport.onSelectStart(r)},onSelectEnd:t=>{e.teleport.onSelectEnd(t.point)}})}(e)}function he(){de=null,ae.visible=!1}new l.a,new m.a;var be,ge,ye,fe,ve,ke,xe,Ne,we=new o.Clock,Se={},Ee=[],Me=[];const ze=1+oe.length-1,Ce=ze+1;const Fe=new URL(window.location),Le=(Fe.searchParams.get("room"),Fe.searchParams.has("debug")),Be=Fe.searchParams.has("handedness")?Fe.searchParams.get("handedness"):"right";new o.Vector3(0,0,5),new o.Vector3(0,0,-5),new o.Vector3(0,0,-5);function Ve(e,t=null,r=null){Me[Se.room].exit(Se),ve.deactivateAll();Se.room;0===e?(null,null):e>=1&&e<=ze?(t,null):e>=Ce&&(null,r),Se.room=e,function(e){Ne&&Ne.source&&Ne.stop()}(),Me[Se.room].enter(Se,t||r)}var He,Re={};function Pe(){!function(){if("xr"in navigator)navigator.xr.isSessionSupported("immersive-vr").then(e=>{const t=document.getElementById("no-webxr");!e&&t&&t.classList.remove("hidden")});else{const e=document.getElementById("no-webxr");e&&e.classList.remove("hidden")}}();const e=document.getElementById(Be+"hand");e&&e.classList.add("activehand"),(He=new p.e).registerSystem(F).registerSystem(V).registerSystem(H).registerSystem(B).registerSystem(G).registerSystem(_).registerSystem(R),Re.lobby=new K(He,[V,H,B]),(ge=new o.WebGLRenderer({antialias:!0,logarithmicDepthBuffer:!1,powerPreference:"high-performance",preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1})).gammaFactor=2.2,ge.outputEncoding=o.sRGBEncoding,ge.setPixelRatio(Math.min(window.devicePixelRatio,2)),ge.setSize(window.innerWidth,window.innerHeight),ge.xr.enabled=!0,ge.sortObjects=!1,ge.autoClear=!0,ge.autoClearDepth=!0,ge.autoClearStencil=!0,be=new o.Scene,(ye=new o.PerspectiveCamera(80,window.innerWidth/window.innerHeight,.005,1e4)).position.set(0,1.6,0),xe=new o.AudioListener,ye.add(xe),Ne=new o.Audio(xe),fe=new n.a(ye,ge.domElement),document.body.addEventListener("click",()=>{Se.vrMode||fe.lock()});var t=!1,r=!1,s=!1,h=!1;document.addEventListener("keydown",e=>{switch(e.keyCode){case 87:case 38:t=!0;break;case 65:case 37:s=!0;break;case 83:case 40:r=!0;break;case 68:case 39:h=!0}}),document.addEventListener("keyup",e=>{switch(e.keyCode){case 87:case 38:t=!1;break;case 65:case 37:s=!1;break;case 83:case 40:r=!1;break;case 68:case 39:h=!1}}),Se.browserControls={controls:fe,moveForward:()=>t,moveBackward:()=>r,moveLeft:()=>s,moveRight:()=>h};for(let e=0;e<2;e++)Ee[e]=ge.xr.getController(e),Ee[e].raycaster=new o.Raycaster,Ee[e].raycaster.near=.1,Ee[e].addEventListener("selectstart",_e),Ee[e].addEventListener("selectend",Ke);const b=new o.DirectionalLight(15663103);b.name="sun",b.position.set(.2,1,.1);const g=new o.DirectionalLight(16773358,.3);g.name="fillLight",g.position.set(-.2,-1,-.1),be.add(b,g);var y=new o.Group;y.add(ye),y.add(Ee[0]),y.add(Ee[1]),y.position.set(0,0,2),be.add(y),Se.vrMode=!1,Se.assets=I,Se.shaders=T,Se.scene=be,Se.renderer=ge,Se.camera=ye,Se.audioListener=xe,Se.goto=null,Se.cameraRig=y,Se.controllers=Ee,Se.world=He,Se.systemsGroup=Re,Se.handedness=Be,Se.GotoRoom=Ve,window.context=Se,function(e,t,r,n,i,s){t&&"/"!=t[t.length-1]&&(t+="/");var p=new a.a;p.setTranscoderPath("src/vendor/"),p.detectSupport(e);var h=new l.a,b=new m.a;b.setDecoderPath("src/vendor/"),h.setDRACOLoader(b);var g=new o.TextureLoader,y={gltf:h,glb:h,obj:new c.a,gif:g,png:g,jpg:g,basis:p,font:new o.FontLoader,ogg:new o.AudioLoader};for(var f in r){let e=f,o=r[f].url;r[f].loading=!0;let a=o.substr(o.lastIndexOf(".")+1).toLowerCase();y[a].load(t+o,t=>{s&&console.info(`%c ${o} loaded`,"color:green");var l=r[e].options;if(r[e]="font"==a?t.data:t,void 0!==l){void 0!==l.repeat&&(r[e].repeat.set(l.repeat[0],l.repeat[1]),delete l.repeat);for(let t in l)r[e][t]=l[t];i&&i(u(r))}n&&d(r)&&n()},()=>{},t=>{console.error("Error loading asset",o,t),"ogg"===a&&(r[e]=null,r[e].loading=!1,n&&d(r)&&n())})}}(ge,"assets/",I,()=>{ve=new q(Se,Be),Se.raycontrol=ve,ke=new U(Se),Se.teleport=ke,function(){(void 0).init();var e=I.generic_controller_model.scene,t=new o.MeshLambertMaterial({map:I.controller_tex});e.getObjectByName("body").material=t,e.getObjectByName("trigger").material=t;for(let t=0;t<2;t++){let r=Ee[t];r.boundingBox=new o.Box3,r.userData.grabbing=null,r.addEventListener("connected",(function(t){this.add(e.clone()),ve.addController(this,t.data)})),r.addEventListener("disconnect",(function(){this.remove(this.children[0]),ve.removeController(this,event.data)}))}}(),pe(Se),document.body.appendChild(ge.domElement),document.body.appendChild(i(ge,e=>{Se.vrMode="sessionStarted"===e,Se.vrMode&&(Ve(0),Se.cameraRig.position.set(0,0,2),Se.goto=null)})),ge.setAnimationLoop(Te),document.getElementById("loading").style.display="none"},e=>{document.querySelector("#progressbar").setAttribute("stroke-dashoffset",-(282-Math.floor(e/27*282)))},Le)}var Ae={},Ge={},De=-1!==navigator.userAgent.indexOf("OculusBrowser")&&parseInt(navigator.userAgent.match(/OculusBrowser\/([0-9]+)./)[1])<8;function _e(e){if(De){const t=e.target;if(!Ae[t])return void(Ae[t]=!0);Ae[t]=!1}e.target.getObjectByName("trigger").rotation.x=-.3,ve.onSelectStart(e)}function Ke(e){if(De){const t=e.target;if(!Ge[t])return void(Ge[t]=!0);Ge[t]=!1}e.target.getObjectByName("trigger").rotation.x=0,ve.onSelectEnd(e)}function Ie(){ye.aspect=window.innerWidth/window.innerHeight,ye.updateProjectionMatrix(),ge.setSize(window.innerWidth,window.innerHeight)}function Te(){var e=we.getDelta(),t=we.elapsedTime;He.execute(e,t);for(let e=0;e<Ee.length;e++){const t=Ee[e].getObjectByName("Scene");t&&Ee[e].boundingBox.setFromObject(t)}if(!Se.vrMode&&Se.browserControls){const t=3,r=Se.browserControls;r.controls.isLocked&&(r.moveForward()&&Se.camera.translateZ(-t*e),r.moveBackward()&&Se.camera.translateZ(t*e),r.moveLeft()&&Se.camera.translateX(-t*e),r.moveRight()&&Se.camera.translateX(t*e))}Se.raycontrol.execute(Se,e,t),Me[Se.room].execute(Se,e,t),ge.render(be,ye),null!==Se.goto&&(Ve(Se.goto),Se.goto=null),window.addEventListener("resize",Ie,!1)}window.onload=()=>{Pe()}}});
//# sourceMappingURL=bundle.js.map