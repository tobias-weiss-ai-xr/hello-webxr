!function(e){function t(t){for(var n,s,a=t[0],l=t[1],c=t[2],u=0,d=[];u<a.length;u++)s=a[u],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(m&&m(t);d.length;)d.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,a=1;a<r.length;a++){var l=r[a];0!==o[l]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},o={0:0},i=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="./";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var m=l;i.push([10,1,2]),r()}({10:function(e,t,r){"use strict";r.r(t),r.d(t,"init",(function(){return Ke}));var n={};r.r(n),r.d(n,"setup",(function(){return ge})),r.d(n,"enter",(function(){return ye})),r.d(n,"exit",(function(){return fe})),r.d(n,"execute",(function(){return ve}));var o=r(0),i=r(6),s=function(e,t){function r(){o.style.display="",o.style.cursor="auto",o.style.left="calc(50% - 75px)",o.style.width="150px",o.onmouseenter=null,o.onmouseleave=null,o.onclick=null,o.textContent="VR NOT SUPPORTED"}function n(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 24px",e.style.border="2px solid #fff",e.style.borderRadius="6px",e.style.background="rgba(0,0,0,0.7)",e.style.color="#fff",e.style.font="600 14px sans-serif",e.style.textAlign="center",e.style.opacity="1.0",e.style.outline="none",e.style.zIndex="999",e.style.cursor="pointer",e.style.transition="all 0.2s ease"}if("xr"in navigator){var o=document.createElement("button");return o.style.display="none",n(o),navigator.xr.isSessionSupported("immersive-vr").then((function(n){n?function(){var r=null;function n(n){n.addEventListener("end",i),e.xr.setSession(n),o.textContent="EXIT VR",r=n,t("sessionStarted")}function i(){r.removeEventListener("end",i),o.textContent="ENTER VR",r=null,t("sessionEnded")}o.style.display="",o.style.cursor="pointer",o.style.left="calc(50% - 50px)",o.style.width="100px",o.textContent="ENTER VR",o.onmouseenter=function(){o.style.background="rgba(0,0,0,0.9)",o.style.transform="scale(1.05)"},o.onmouseleave=function(){o.style.background="rgba(0,0,0,0.7)",o.style.transform="scale(1.0)"},o.onclick=function(){if(null===r){navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}).then(n)}else r.end()}}():r()})),o}var i=document.createElement("a");return!1===window.isSecureContext?(i.href=document.location.href.replace(/^http:/,"https:"),i.innerHTML="WEBXR NEEDS HTTPS"):(i.href="https://immersiveweb.dev/",i.innerHTML="WEBXR NOT AVAILABLE"),i.style.left="calc(50% - 90px)",i.style.width="180px",i.style.textDecoration="none",n(i),i};var a={};a.paths=[[{from:new o.Vector3(0,1.6,0),lookAt:new o.Vector3(0,1,-100),velocity:new o.Vector3(0,0,-.1),angularVelocity:new o.Vector3(.04,0,0)},{from:new o.Vector3(4.5,1.6,-3),lookAt:new o.Vector3(100,0,0),velocity:new o.Vector3(0,0,-.15),angularVelocity:new o.Vector3(0,0,0)},{from:new o.Vector3(0,1.6,0),lookAt:new o.Vector3(50,0,-40),velocity:new o.Vector3(0,.12,0),angularVelocity:new o.Vector3(0,.1,0)},{from:new o.Vector3(3,2.4,-4),lookAt:new o.Vector3(-50,0,40),velocity:new o.Vector3(0,-.12,0),angularVelocity:new o.Vector3(0,-.1,0)}],[{from:new o.Vector3(0,1.6,0),lookAt:new o.Vector3(0,0,-100),velocity:new o.Vector3(.1,0,.1),angularVelocity:new o.Vector3(0,.01,0)}],[{from:new o.Vector3(0,1.2,.8),lookAt:new o.Vector3(-100,.5,0),velocity:new o.Vector3(0,0,-.2),angularVelocity:new o.Vector3(0,0,0)},{from:new o.Vector3(-1,1,-1.6),lookAt:new o.Vector3(-40,0,100),velocity:new o.Vector3(-.05,0,0),angularVelocity:new o.Vector3(0,0,0)}],[{from:new o.Vector3(0,1.6,0),lookAt:new o.Vector3(0,0,-10),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(-.01,.07,0)},{from:new o.Vector3(0,1.6,-.4),lookAt:new o.Vector3(0,0,6),velocity:new o.Vector3(0,0,.1),angularVelocity:new o.Vector3(.07,0,0)}],[{from:new o.Vector3(0,0,0),lookAt:new o.Vector3(-100,0,0),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(.03,.05,0)}],[],[{from:new o.Vector3(0,0,0),lookAt:new o.Vector3(-100,0,0),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(.01,.1,0)}],[],[{from:new o.Vector3(0,0,0),lookAt:new o.Vector3(-100,0,0),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(-.07,-.05,0)}],[{from:new o.Vector3(0,0,0),lookAt:new o.Vector3(100,0,80),velocity:new o.Vector3(0,0,0),angularVelocity:new o.Vector3(0,-.02,0)}]],a.setup=function(e){this.room=void 0,this.path=void 0,this.next(e),e.camera.position.set(0,1.6,0),e.cameraRig.position.set(0,0,2),e.goto=this.room},a.next=function(e){if(this.time=3+3*Math.random()/2,void 0===this.room)this.room=0,this.path=0;else if(this.path++,this.path>=this.paths[this.room].length){do{this.room++,this.room>=this.paths.length&&(this.room=0,e.cameraRig.position.set(0,0,2))}while(!this.paths[this.room].length);e.renderer.xr.getCamera(e.camera).position.set(0,1.6,0),e.goto=this.room,this.path=0}this.reset=!0},a.execute=function(e,t,r){const n=this.paths[this.room][this.path];this.reset&&(this.reset=!1,e.camera.position.copy(n.from),e.camera.rotation.set(0,0,0),e.camera.lookAt(n.lookAt)),e.camera.position.addScaledVector(n.velocity,t),e.camera.rotation.x+=n.angularVelocity.x*t,e.camera.rotation.y+=n.angularVelocity.y*t,e.camera.rotation.z+=n.angularVelocity.z*t,this.time-=t,this.time<0&&this.next(e)};var l=r(7),c=r(3),m=r(8),u=r(4);function d(e){let t=0;for(var r in e)!0!==e[r].loading&&t++;return t}function h(e){for(var t in e)if(!0===e[t].loading)return!1;return!0}var p=r(1),g=r(5);class b{constructor(){this.value=null}reset(){this.value=null}}class y{constructor(){this.rotation=new o.Vector3}reset(){}}class f{constructor(){this.position=new o.Vector3}reset(){}}class v{constructor(){this.value=null}reset(){this.value=null}}class x{constructor(){this.text="",this.textAlign="left",this.anchor="center",this.baseline="center",this.color="#FFF",this.font=null,this.fontSize=.2,this.letterSpacing=0,this.lineHeight=0,this.maxWidth=1/0,this.overflowWrap="normal",this.whiteSpace="normal",this.opacity=1}reset(){this.text=""}}class k{constructor(){this.min=new o.Vector3,this.max=new o.Vector3}reset(){this.min.set(0,0,0),this.max.set(0,0,0)}}p.d;p.d;class w extends p.d{}class N{constructor(){}reset(){}}const S=()=>{};class E{constructor(){this.reset()}reset(){this.onEntering=S,this.onExiting=S}}class M extends p.d{}class C{constructor(){this.value=[]}reset(){this.value.array.length=0}}const z={left:0,center:.5,right:1},L={top:0,center:.5,bottom:1};class F extends p.b{updateText(e,t){e.text=t.text,e.textAlign=t.textAlign,e.anchor[0]=z[t.anchor],e.anchor[1]=L[t.baseline],e.color=t.color,e.font=t.font,e.fontSize=t.fontSize,e.letterSpacing=t.letterSpacing||0,e.lineHeight=t.lineHeight||null,e.overflowWrap=t.overflowWrap,e.whiteSpace=t.whiteSpace,e.maxWidth=t.maxWidth,e.material.opacity=t.opacity,e.sync()}execute(e,t){var r=this.queries.entities;r.added.forEach(e=>{var t=e.getComponent(x);const r=new g.a;r.name="textMesh",r.anchor=[0,0],r.renderOrder=1,this.updateText(r,t),e.addComponent(b,{value:r})}),r.removed.forEach(e=>{var t=e.getComponent(b).value,r=t.getObjectByName("textMesh");r.dispose(),t.remove(r)}),r.changed.forEach(e=>{var t=e.getComponent(b).value;if(t instanceof g.a){var r=e.getComponent(x);this.updateText(t,r)}})}}F.queries={entities:{components:[x],listen:{added:!0,removed:!0,changed:[x]}}},o.BoxHelper.prototype.setFromMinMax=function(e,t){var r=this.geometry.attributes.position,n=r.array;n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=e.x,n[4]=t.y,n[5]=t.z,n[6]=e.x,n[7]=e.y,n[8]=t.z,n[9]=t.x,n[10]=e.y,n[11]=t.z,n[12]=t.x,n[13]=t.y,n[14]=e.z,n[15]=e.x,n[16]=t.y,n[17]=e.z,n[18]=e.x,n[19]=e.y,n[20]=e.z,n[21]=t.x,n[22]=e.y,n[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()};class B extends p.c{constructor(){super(),this.boxHelper=new o.BoxHelper}}class R extends p.b{execute(e,t){this.queries.added.results.forEach(e=>{e.addComponent(B);var t=e.getComponent(k);let r=e.getMutableComponent(B);r.boxHelper.setFromMinMax(t.min,t.max),e.addComponent(b,{value:r.boxHelper})}),this.queries.removed.results.forEach(e=>{e.removeComponent(b).removeComponent(B)})}}R.queries={added:{components:[M,Object(p.a)(B)]},removed:{components:[Object(p.a)(M),B]}};class V extends p.b{execute(e,t){const r=this.queries.areas.results,n=this.queries.checkers.results;for(let e=0;e<r.length;e++){const t=r[e].getComponent(k);for(let e=0;e<n.length;e++){const r=n[e];r.getComponent(b).value.boundingBox.intersectsBox(t)?r.addComponent(w):r.removeComponent(w)}}}}V.queries={areas:{components:[class{constructor(){}reset(){}},k]},checkers:{components:[N,b]}};class H extends p.b{execute(e,t){const r=this.queries.checkers.added,n=this.queries.checkers.removed;for(let e=0;e<r.length;e++){const t=r[e];t.getComponent(E).onEntering(t)}for(let e=0;e<n.length;e++){const t=n[e];t.getComponent(E).onExiting(t)}}}H.queries={checkers:{components:[N,b,w],listen:{added:!0,removed:!0}}};class P extends p.b{execute(e,t){this.queries.entities.added.forEach(e=>{const t=e.getComponent(v).value,r=e.getComponent(b).value;t.add(r)}),this.queries.entities.changed.forEach(e=>{const t=e.getComponent(v).value,r=e.getComponent(b).value;t.add(r)}),this.queries.entities.removed.forEach(e=>{e.getComponent(v,!0).value.remove(e.getComponent(b,!0).value)})}}P.queries={entities:{components:[b,v],listen:{added:!0,removed:!0,changed:!0}}};let A=e=>{const t=e.getComponent(y);e.getComponent(b).value.rotation.set(t.x,t.y,t.z)},G=e=>{const t=e.getComponent(f);e.getComponent(b).value.position.copy(t)};class D extends p.b{execute(e,t){this.queries.position.added.forEach(G),this.queries.position.changed.forEach(G),this.queries.rotation.added.forEach(A),this.queries.rotation.changed.forEach(A)}}D.queries={position:{components:[f,b],listen:{added:!0,changed:!0}},rotation:{components:[y,b],listen:{added:!0,changed:!0}}};var T=new o.Vector3;class _ extends p.b{execute(e,t){window.context.camera.getWorldPosition(T),this.queries.entities.results.forEach(e=>{const t=e.getComponent(b).value,r=T.distanceTo(t.position);let n=0;r<4&&(n=o.Math.clamp(Math.sqrt(4-r),0,1),t.lookAt(T)),t.material.opacity=n,e.hasComponent(C)&&e.getComponent(C).value.forEach(e=>{e.getComponent(x).opacity!==n&&(e.getMutableComponent(x).opacity=n)})})}}_.queries={entities:{components:[class{constructor(){this.camera3D=null}reset(){this.camera3D=null}},b]}};class I{constructor(e,t){this.Systems=t,this.world=e}play(){this.Systems.forEach(e=>this.world.getSystem(e).play())}stop(){this.Systems.forEach(e=>this.world.getSystem(e).stop())}}var K={doorfx_tex:{url:"doorfx.basis",options:{wrapT:o.RepeatWrapping,wrapS:o.RepeatWrapping}},generic_controller_model:{url:"generic_controller.glb"},controller_tex:{url:"controller.basis"},teleport_model:{url:"teleport.glb"},glow_tex:{url:"glow.basis",options:{encoding:o.sRGBEncoding}},beam_tex:{url:"beamfx.png"}},W={door_frag:"\nuniform float time;\nuniform float selected;\nuniform sampler2D tex;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec2 uv = vUv * 2.0 - 1.0;\n  vec2 puv = vec2(length(uv.xy), atan(uv.x, uv.y));\n  vec4 col = texture2D(tex, vec2(log(puv.x) + t / 5.0, puv.y / 3.1415926 ));\n  float glow = (1.0 - puv.x) * (0.5 + (sin(t) + 2.0 ) / 4.0);\n  // blue glow\n  col += vec4(118.0/255.0, 144.0/255.0, 219.0/255.0, 1.0) * (0.4 + glow * 1.0);\n  // white glow\n  col += vec4(0.2) * smoothstep(0.0, 2.0, glow * glow);\n  gl_FragColor = col;\n\n}\n",zoom_frag:"\nuniform float time;\nuniform sampler2D tex;\nuniform vec2 zoomPos;\nuniform float zoomAmount;\nuniform float zoomRatio;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec2 uv = vec2(vUv.x - 0.5, (1.0 - vUv.y) - 0.5);\n  vec2 texUv = uv * vec2(zoomRatio, 1.0);\n  vec4 col = texture2D(tex, zoomPos + texUv * zoomAmount);\n  float dist = length(uv) * 2.0;\n  col.a = smoothstep(0.0, 0.1, 1.0 - dist);\n  float aura = smoothstep(0.80, 1.0, dist);\n  col.rgb += aura * 0.3;\n  gl_FragColor = col;\n}\n",basic_vert:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvoid main()\n{\n  vUv = uv;\n  vPosition = position;\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n",panoball_vert:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec3 vWorldPos;\nuniform float time;\nuniform float selected;\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n\nmat4 transpose(in mat4 m) {\n  vec4 i0 = m[0];\n  vec4 i1 = m[1];\n  vec4 i2 = m[2];\n  vec4 i3 = m[3];\n\n  return mat4(\n    vec4(i0.x, i1.x, i2.x, i3.x),\n    vec4(i0.y, i1.y, i2.y, i3.y),\n    vec4(i0.z, i1.z, i2.z, i3.z),\n    vec4(i0.w, i1.w, i2.w, i3.w)\n  );\n}\n\nvoid main()\n{\n  vUv = uv;\n\n  vPosition = position;\n\n  vec3 offset = vec3(\n    sin(position.x * 50.0 + time),\n    sin(position.y * 10.0 + time * 2.0),\n    cos(position.z * 40.0 + time)\n  ) * 0.003;\n\n  vPosition *= 1.0 + selected * 0.2;\n\n  vNormal = normalize(inverse(transpose(modelMatrix)) * vec4(normalize(normal), 1.0)).xyz;\n  vWorldPos = (modelMatrix * vec4(vPosition, 1.0)).xyz;\n\n  vec4 mvPosition = modelViewMatrix * vec4(vPosition + offset, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n",panoball_frag:"\nuniform sampler2D tex, texfx;\nuniform float time;\nuniform float selected;\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec3 vWorldPos;\n\n\nvoid main( void ) {\n  vec2 uv = vUv;\n  //uv.y =  1.0 - uv.y;\n\n  vec3 eye = normalize(cameraPosition - vWorldPos);\n  float fresnel = abs(dot(eye, vNormal));\n  float shift = pow((1.0 - fresnel), 4.0) * 0.05;\n\n  vec3 col = vec3(\n    texture2D(tex, uv - shift).r,\n    texture2D(tex, uv).g,\n    texture2D(tex, uv + shift).b\n  );\n\n  col = mix(col * 0.7, vec3(1.0), 0.7 - fresnel);\n\n  col += selected * 0.3;\n\n  float t = time * 0.4 + vPosition.x + vPosition.z;\n  uv = vec2(vUv.x + t * 0.2, vUv.y + t);\n  vec3 fx = texture2D(texfx, uv).rgb * 0.4;\n\n\n  gl_FragColor = vec4(col + fx, 1.0);\n}\n",beam_frag:"\nuniform float time;\nuniform sampler2D tex;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec4 col = texture2D(tex, vec2(vUv.x, vUv.y * 3.0 + time * 2.0));\n  col *= vUv.y;\n  gl_FragColor = col;\n}\n"};var O,j=new o.Matrix4;const U=["primary","secondary","both","left","right"];class q extends class{constructor(){this._listeners={},this.stats={fired:0,handled:0}}addEventListener(e,t){let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){return void 0!==this._listeners[e]&&-1!==this._listeners[e].indexOf(t)}removeEventListener(e,t){var r=this._listeners[e];if(void 0!==r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}}dispatchEvent(e,t){this.stats.fired++;var r=this._listeners[e];if(void 0!==r)for(var n=r.slice(0),o=0;o<n.length;o++)n[o].call(this,t)}resetCounters(){this.stats.fired=this.stats.handled=0}}{enable(){this.setLineStyle(this.previousLineStyle),this.enabled=!0}_sort(){this.currentStates=this.currentStates.sort((e,t)=>(e.order||0)-(t.order||0))}disable(){this.lineBasic.visible=this.line0.visible=!1,this.enabled=!1,this.controllers.forEach(e=>e.active=!1)}changeHandedness(e){e!==this.primary&&(this.primary=e,this.secondary="right"===e?"left":"right",this.dispatchEvent("handednessChanged",{primary:this.primary,secondary:this.secondary}))}addState(e,t,r){if(!this.states[e])return t.name=e,void 0===t.raycaster&&(t.raycaster=!0),void 0===t.controller?t.controller="primary":U.includes(t.controller)||(console.warn("Invalid controller selector:",t.controller),t.controller="primary"),this.states[e]=t,!0===r&&this.currentStates.push(t),t;console.error(`RayControl state '${e}' already exist, please use a different name.`)}activateState(e){this.states[e]&&(this.currentStates.push(this.states[e]),this._sort())}deactivateAll(e){this.currentStates=[],this.controllers.forEach(e=>{this.currentStates.forEach(t=>{e.intersections[t.name]&&(e.intersections[t.name]=null)})})}deactivateState(e){this.currentStates.splice(this.currentStates.indexOf(e),1),this.controllers.forEach(t=>{t.intersections[e]&&(t.intersections[e]=null)}),this._sort()}addController(e,t){let r={controller:e,inputSource:t,active:!1,stateHit:{},intersections:{},currentIntersection:null,hit:!1};this.controllers.push(r),this.matchController(r,"primary")&&e.add(this.raycasterContext),this.dispatchEvent("controllerConnected",r)}removeController(e){const t=this.controllers.findIndex(t=>t.controller===e),r=this.controllers.find(t=>t.controller===e);this.controllers.splice(t,1),this.dispatchEvent("controllerDisconnected",r)}constructor(e,t){super(),this.ctx=e,void 0===t?(this.primary="right",this.secondary="left"):(this.primary=t,this.secondary="right"===t?"left":"right"),this.controllers=[],this.previousLineStyle="pretty",this.enabled=!0,this.raycaster=new o.Raycaster,this.states={},this.currentStates=[];var r=e.assets.teleport_model.scene.getObjectByName("beam");e.assets.beam_tex.wrapT=o.RepeatWrapping,e.assets.beam_tex.wrapS=o.RepeatWrapping,O=r.material=new o.ShaderMaterial({uniforms:{time:{value:0},active:{value:0},tex:{value:e.assets.beam_tex}},vertexShader:e.shaders.basic_vert,fragmentShader:e.shaders.beam_frag,blending:o.AdditiveBlending,transparent:!0}),r.renderOrder=10,r.name="line",this.rayLength=5,r.scale.z=this.rayLength,this.line0=r.clone(),this.line0.visible=!0,this.raycasterContext=new o.Group,this.raycasterContext.add(this.line0),this.raycasterContext.name="raycasterContext";var n=(new o.BufferGeometry).setFromPoints([new o.Vector3(0,0,0),new o.Vector3(0,0,-1)]);this.lineBasic=new o.Line(n),this.lineBasic.name="line",this.lineBasic.scale.z=5,this.lineBasic.visible=!1,this.raycasterContext.add(this.lineBasic)}setLineStyle(e){const t="basic"===e;this.lineBasic.visible=t,this.line0.visible=!t,this.previousLineStyle=e}matchController(e,t){const r=e.inputSource.handedness;return t===r||"both"===t&&("right"===r||"left"===r)||"primary"===t&&this.primary===r||"secondary"===t&&this.secondary===r}onSelectStart(e){if(!this.enabled)return;let t=e.target,r=this.controllers.find(e=>e.controller===t);if(r){if(r.active=!0,r.currentIntersection){const e=r.currentIntersection.state;e.onSelectStart&&e.onSelectStart(r.currentIntersection.intersection,r.controller)}this.currentStates.forEach(e=>{e.onSelectStart&&!e.raycaster&&e.onSelectStart(r.intersections[e.name],t)})}}execute(e,t,r){if(!this.enabled||0===this.currentStates.length)return;O.uniforms.time.value=r;for(var n=0;n<this.controllers.length;n++){let e=this.controllers[n];for(var o=0;o<this.currentStates.length;o++){let t=this.currentStates[o];if(!t.raycaster)continue;if(!this.matchController(e,t.controller))continue;let r=e.controller,n=(e.active,this.getIntersections(r,t.colliderMesh));n.length>0?(e.intersections[t.name]=n[0],e.stateHit[t.name]=!0):e.intersections[t.name]=null}}this.line0.scale.z=Math.min(this.rayLength,1),this.lineBasic.scale.z=Math.min(this.rayLength,1);for(n=0;n<this.controllers.length;n++){let e=this.controllers[n],t=Object.entries(e.intersections).filter(e=>null!==e[1]);if(t.length>0){t.sort((e,t)=>e[1].distance-t[1].distance);const r=t[0],n=r[1],o=this.states[r[0]];e.prevIntersection=e.currentIntersection,e.currentIntersection={state:o,intersection:n},o.lineStyleOnIntersection?this.setLineStyle(o.lineStyleOnIntersection):this.setLineStyle("advanced"),o.onHover&&o.onHover(n,e.active,e.controller),this.line0.scale.z=Math.min(n.distance,1),this.lineBasic.scale.z=Math.min(n.distance,1)}else e.currentIntersection=null}for(n=0;n<this.controllers.length;n++){let e=this.controllers[n];e.prevIntersection&&(this.controllers.find(t=>{let r=e.prevIntersection,n=t.currentIntersection;return n&&r.state.name===n.state.name&&r.intersection.object===n.intersection.object})||(e.prevIntersection.state.onHoverLeave(e.prevIntersection.intersection,!1,e.controller),e.prevIntersection=null))}}getIntersections(e,t){let r=e.getObjectByName("raycasterContext");return r?(j.identity().extractRotation(r.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(r.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(j),Array.isArray(t)?this.raycaster.intersectObjects(t,!0):this.raycaster.intersectObject(t,!0)):(console.warn("No raycasterContext found for this controller",e),[])}onSelectEnd(e){if(!this.enabled)return;let t=this.controllers.find(t=>t.controller===e.target);if(t&&t.active){if(t){if(t.currentIntersection){const e=t.currentIntersection.state;e.onSelectEnd&&e.onSelectEnd(t.currentIntersection.intersection,t.controller)}this.currentStates.forEach(e=>{e.onSelectEnd&&!e.raycaster&&e.onSelectEnd(null,t.controller)})}t.active=!1}}}new o.Matrix4;class Z{constructor(e,t){this.ctx=e,this.teleportEntity=new o.Group,this.active=!1,this.teleportHitGeometry=e.assets.teleport_model.scene.getObjectByName("goal"),this.teleportHitGeometry.material=O,this.teleportHitGeometry.renderOrder=10,this.ballColliding=e.assets.teleport_model.scene.getObjectByName("glow"),this.ballColliding.material=new o.MeshBasicMaterial({color:9595,map:e.assets.glow_tex,transparent:!0,blending:o.AdditiveBlending}),this.ballColliding.renderOrder=10,this.ballColliding.visible=!1,this.teleportEntity.add(this.ballColliding),this.teleportHitGeometry.visible=!1,this.teleportHitGeometry.position.set(-2,0,-2),this.teleportEntity.add(this.teleportHitGeometry),this.ctx.scene.add(this.teleportEntity);try{this.startSound=new o.Audio(e.audioListener),this.startSound.setBuffer(e.assets.teleport_a_snd),this.startSound.setLoop(!0),this.startSound.pause()}catch(e){console.warn("Failed to initialize start sound:",e),this.startSound=null}try{this.endSound=new o.Audio(e.audioListener),this.endSound.setBuffer(e.assets.teleport_b_snd),this.endSound.setLoop(!1),this.endSound.pause()}catch(e){console.warn("Failed to initialize end sound:",e),this.endSound=null}}onSelectStart(e){this.active=!0,this.endSound&&this.endSound.pause(),this.startSound&&this.startSound.play()}onHoverLeave(){this.ballColliding.visible=!1,this.teleportHitGeometry.visible=!1,this.startSound&&this.startSound.pause()}onHover(e,t){t?(this.teleportHitGeometry.visible=!0,this.teleportHitGeometry.position.copy(e),this.hit=!0,this.ballColliding.visible=!1):(this.ballColliding.visible=!0,this.ballColliding.position.copy(e))}onSelectEnd(e){const t=this.ctx.renderer.xr.getCamera(this.ctx.camera).position,r=e.sub(t);r.y=0,this.ctx.cameraRig.position.add(r),this.teleportHitGeometry.visible=!1,this.active=!1,this.startSound&&this.startSound.pause(),this.endSound&&this.endSound.play()}}const X=16739179,$=16755021,Y=7649791,J=14037892,Q=4876733,ee=2148759,te=1548984,re=55807,ne={He:16770273,Ne:16739072,Ar:8087790,Kr:52945,Xe:4286945,Rn:14745599},oe=[{symbol:"H",name:"Wasserstoff",atomicNumber:1,mass:1.008,group:"nonmetal",period:1,block:"s",groupNumber:1,color:16761095,description:"Das häufigste Element im Universum. Bildet 75% der Masse der Sonne.",theme:"cosmic",experiments:["knallgas","fusion","fuelcell"]},{symbol:"He",name:"Helium",atomicNumber:2,mass:4.003,group:"nobleGas",period:1,block:"s",groupNumber:18,color:ne.He,description:"Das zweithäufigste Element im Universum. Wurde zuerst im Sonnenspektrum entdeckt.",theme:"solar",experiments:["superfluid","voiceshift"]},{symbol:"Li",name:"Lithium",atomicNumber:3,mass:6.941,group:"alkali",period:2,block:"s",groupNumber:1,color:X,description:"Das leichteste Metall. Wichtiger Bestandteil von Lithium-Ionen-Batterien.",theme:"energy",experiments:["waterReaction","battery"]},{symbol:"Be",name:"Beryllium",atomicNumber:4,mass:9.012,group:"alkalineEarth",period:2,block:"s",groupNumber:2,color:$,description:"Hochgiftiges Metall mit niedriger Dichte. Verwendet in der Weltraumtechnik.",theme:"gem",experiments:["crystal","toxicity"]},{symbol:"B",name:"Bor",atomicNumber:5,mass:10.81,group:"metalloid",period:2,block:"p",groupNumber:13,color:te,description:"Hartes Material für Glasfasern. Kommt in Wüstensalzen vor.",theme:"desert",experiments:["borax","fiberglass"]},{symbol:"C",name:"Kohlenstoff",atomicNumber:6,mass:12.011,group:"nonmetal",period:2,block:"p",groupNumber:14,color:16761095,description:"Das Element des Lebens. Grundbaustein aller organischen Verbindungen.",theme:"life",experiments:["diamond","graphite","dna"]},{symbol:"N",name:"Stickstoff",atomicNumber:7,mass:14.007,group:"nonmetal",period:2,block:"p",groupNumber:15,color:16761095,description:"Macht 78% der Atmosphäre aus. Essentiell für Proteine und DNA.",theme:"atmosphere",experiments:["liquid","haberbosch","fertilizer"]},{symbol:"O",name:"Sauerstoff",atomicNumber:8,mass:15.999,group:"nonmetal",period:2,block:"p",groupNumber:16,color:16761095,description:"Zweithäufigstes Element im Universum. Notwendig für Atmung und Verbrennung.",theme:"breath",experiments:["combustion","ozone","photosynthesis"]},{symbol:"F",name:"Fluor",atomicNumber:9,mass:18.998,group:"halogen",period:2,block:"p",groupNumber:17,color:re,description:"Reaktivstes aller Elemente. Wird in Teflon und Zahncreme verwendet.",theme:"protection",experiments:["reaction","teflon"]},{symbol:"Ne",name:"Neon",atomicNumber:10,mass:20.18,group:"nobleGas",period:2,block:"p",groupNumber:18,color:ne.Ne,description:"Leuchtet bei elektrischer Entladung orange-rot. Symbol der Stadtbeleuchtung.",theme:"lights",experiments:["neon","laser"]},{symbol:"Na",name:"Natrium",atomicNumber:11,mass:22.99,group:"alkali",period:3,block:"s",groupNumber:1,color:X,description:"Silberglänzendes Metall, butterweich. Basis für Speisesalz (NaCl).",theme:"kitchen",experiments:["water","flame","saltcrystal"]},{symbol:"Mg",name:"Magnesium",atomicNumber:12,mass:24.305,group:"alkalineEarth",period:3,block:"s",groupNumber:2,color:$,description:"Blendend weißes Licht beim Verbrennen. Kommt in Chlorophyll vor.",theme:"light",experiments:["flash","chlorophyll","alloy"]},{symbol:"Al",name:"Aluminium",atomicNumber:13,mass:26.982,group:"metal",period:3,block:"p",groupNumber:13,color:ee,description:"Das häufigste Metall der Erdkruste. Leicht und korrosionsbeständig.",theme:"industry",experiments:["hallheroult","thermit","foil"]},{symbol:"Si",name:"Silizium",atomicNumber:14,mass:28.086,group:"metalloid",period:3,block:"p",groupNumber:14,color:te,description:"Zweithäufigstes Element der Erdkruste. Basis aller modernen Elektronik.",theme:"silicon",experiments:["transistor","solar","sand"]},{symbol:"P",name:"Phosphor",atomicNumber:15,mass:30.974,group:"nonmetal",period:3,block:"p",groupNumber:15,color:16761095,description:"Glüht weiß im Dunkeln. Wichtiger Bestandteil von DNA und ATP.",theme:"fire",experiments:["white","red","match"]},{symbol:"S",name:"Schwefel",atomicNumber:16,mass:32.065,group:"nonmetal",period:3,block:"p",groupNumber:16,color:16761095,description:"Gelbes Element mit charakteristischem Geruch. Kommt in Vulkanen vor.",theme:"volcano",experiments:["burning","gunpowder","bromo"]},{symbol:"Cl",name:"Chlor",atomicNumber:17,mass:35.453,group:"halogen",period:3,block:"p",groupNumber:17,color:re,description:"Grün-gelbes Giftgas. Wird zur Wasserdesinfektion verwendet.",theme:"swimming",experiments:["disinfection","salt","gas"]},{symbol:"Ar",name:"Argon",atomicNumber:18,mass:39.948,group:"nobleGas",period:3,block:"p",groupNumber:18,color:ne.Ar,description:"Häufigstes Edelgas (1% Atmosphäre). Wird für WIG-Schweißen verwendet.",theme:"welding",experiments:["plasma","inert"]},{symbol:"Ca",name:"Calcium",atomicNumber:20,mass:40.078,group:"alkalineEarth",period:4,block:"s",groupNumber:2,color:$,description:"Bauknochen des Lebens. Fünft-häufigstes Element der Erdkruste.",theme:"skeleton",experiments:["burning","bones","limestone"]},{symbol:"Fe",name:"Eisen",atomicNumber:26,mass:55.845,group:"transition",period:4,block:"d",groupNumber:8,color:Y,description:"Wichtigstes Metall der Menschheit. Grundbaustein von Stahl und Hämoglobin.",theme:"forge",experiments:["magnet","rust","steel"]},{symbol:"Cu",name:"Kupfer",atomicNumber:29,mass:63.546,group:"transition",period:4,block:"d",groupNumber:11,color:Y,description:"Erstes Metall der Menschheit. Exzellenter elektrischer Leiter.",theme:"electric",experiments:["conductivity","patina","bronze"]},{symbol:"Au",name:"Gold",atomicNumber:79,mass:196.967,group:"transition",period:6,block:"d",groupNumber:11,color:Y,description:"Edelstes Metall. Einziges gelbes Metall (relativistische Effekte).",theme:"treasure",experiments:["ductility","alloys","electroplating"]},{symbol:"U",name:"Uran",atomicNumber:92,mass:238.029,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Schwerstes häufiges natürliches Element. Basis für Kernenergie.",theme:"nuclear",experiments:["fission","decay","fluorescence"]},{symbol:"K",name:"Kalium",atomicNumber:19,mass:39.098,group:"alkali",period:4,block:"s",groupNumber:1,color:X,description:"Reaktiv Metall, in der Natur oft als Ion. Wesentlich für biologische Prozesse.",theme:"biological",experiments:["water","flame","banane"]},{symbol:"Ca",name:"Calcium",atomicNumber:20,mass:40.078,group:"alkalineEarth",period:4,block:"s",groupNumber:2,color:$,description:"Fünft-häufigstes Element der Erdkruste. Fünft-häufigstes Element im menschlichen Körper.",theme:"biological",experiments:["burning","knochen","kalkstein"]},{symbol:"Sc",name:"Scandium",atomicNumber:21,mass:44.956,group:"transition",period:4,block:"d",groupNumber:3,color:Y,description:"Seltenes Übergangsmetall. Wird in Sportgeräten und Hochleistungslegierungen verwendet.",theme:"aerospace",experiments:["alloy","magnetic","sport"]},{symbol:"Ti",name:"Titan",atomicNumber:22,mass:47.867,group:"transition",period:4,block:"d",groupNumber:4,color:Y,description:"Korrosionsbeständiges Metall mit hohem Schmelzpunkt. Für Luft- und Raumfahrtindustrie.",theme:"aerospace",experiments:["biokompatibilität","legierung","oxid"]},{symbol:"V",name:"Vanadium",atomicNumber:23,mass:50.942,group:"transition",period:4,block:"d",groupNumber:5,color:Y,description:"Hartes, grau-weißes Metall. Für Werkzeugstahl und Titanlegierungen.",theme:"industry",experiments:["stahl","legierung","katalysator"]},{symbol:"Cr",name:"Chrom",atomicNumber:24,mass:51.996,group:"transition",period:4,block:"d",groupNumber:6,color:Y,description:"Glänzendes, korrosionsbeständiges Metall. Basis von Edelstahl und Verchromung.",theme:"industry",experiments:["edelstahl","verchromung","pigment"]},{symbol:"Mn",name:"Mangan",atomicNumber:25,mass:54.938,group:"transition",period:4,block:"d",groupNumber:7,color:Y,description:"Wichtig für Stahlherstellung. Bioelement für Photosynthese.",theme:"industry",experiments:["stahl","photosynthese","batterie"]},{symbol:"Co",name:"Kobalt",atomicNumber:27,mass:58.933,group:"transition",period:4,block:"d",groupNumber:9,color:Y,description:"Blau-graues, ferromagnetisches Metall. Für Supraleger, Magnete und Lithium-Ionen-Batterien.",theme:"technology",experiments:["magnet","batterie","legierung"]},{symbol:"Ni",name:"Nickel",atomicNumber:28,mass:58.693,group:"transition",period:4,block:"d",groupNumber:10,color:Y,description:"Silbrig-weißes, korrosionsbeständiges Metall. Münzmetall und für Legierungen.",theme:"technology",experiments:["münzen","legierung","katalysator"]},{symbol:"Zn",name:"Zink",atomicNumber:30,mass:65.38,group:"transition",period:4,block:"d",groupNumber:12,color:Y,description:"Reaktionsfreies Metall. Für galvanische Zellen, Verzinkung und Zink-Legierungen.",theme:"technology",experiments:["galvanik","verzinkung","batterie"]},{symbol:"Ga",name:"Gallium",atomicNumber:31,mass:69.723,group:"metal",period:4,block:"p",groupNumber:13,color:ee,description:"Schmilzt in der Hand bei Raumtemperatur. Für Halbleiter und Hochtemperaturthermometer.",theme:"semiconductor",experiments:["schmelzen","halbleiter","thermometer"]},{symbol:"Ge",name:"Germanium",atomicNumber:32,mass:72.63,group:"metalloid",period:4,block:"p",groupNumber:14,color:te,description:"Halbleiter für Transistoren und Optoelektronik. Silizium-Alternative.",theme:"semiconductor",experiments:["halbleiter","transistor","faser"]},{symbol:"As",name:"Arsen",atomicNumber:33,mass:74.922,group:"metalloid",period:4,block:"p",groupNumber:15,color:te,description:"Sehr giftiges Halbmetall. Historisch in Tapeten und Farben verwendet.",theme:"toxic",experiments:["gift","historisch","semiconductor"]},{symbol:"Se",name:"Selen",atomicNumber:34,mass:78.96,group:"nonmetal",period:4,block:"p",groupNumber:16,color:16761095,description:"Wichtiges Spurenelement. Halbleiter und für Glühbirren.",theme:"semiconductor",experiments:["glühbirne","photovoltaik","toxisch"]},{symbol:"Br",name:"Brom",atomicNumber:35,mass:79.904,group:"halogen",period:4,block:"p",groupNumber:17,color:re,description:"Einziges flüssige Nichtmetall bei Raumtemperatur. Rote Farbe, stechender Geruch.",theme:"liquid",experiments:["flüssig","flammmittel","giftig"]},{symbol:"Kr",name:"Krypton",atomicNumber:36,mass:83.798,group:"nobleGas",period:4,block:"p",groupNumber:18,color:ne.Kr,description:"Edelgas mit hoher Dichte. Für Blitzlichtlampen und Laser.",theme:"lighting",experiments:["laser","neon","isoliert"]},{symbol:"Rb",name:"Rubidium",atomicNumber:37,mass:85.468,group:"alkali",period:5,block:"s",groupNumber:1,color:X,description:"Weiches, hochreaktives Metall. Für Atomuhren und Feuerwerk.",theme:"pyrotechnics",experiments:["atomuhr","feuerwerk","reaktion"]},{symbol:"Sr",name:"Strontium",atomicNumber:38,mass:87.62,group:"alkalineEarth",period:5,block:"s",groupNumber:2,color:$,description:"Für rote Feuerwerke und Magnete. Radioaktiv (Strontium-90).",theme:"pyrotechnics",experiments:["feuerwerk","magnet","radioaktiv"]},{symbol:"Y",name:"Yttrium",atomicNumber:39,mass:88.906,group:"transition",period:5,block:"d",groupNumber:3,color:Y,description:"Seltenes Erdelement. Für LEDs, Supraleiter und Laser.",theme:"technology",experiments:["led","laser","supraleiter"]},{symbol:"Zr",name:"Zirkonium",atomicNumber:40,mass:91.224,group:"transition",period:5,block:"d",groupNumber:4,color:Y,description:"Korrosionsbeständiges Metall. Für Kernelemente und medizinische Implantate.",theme:"nuclear",experiments:["kernelement","implantat","keramik"]},{symbol:"Nb",name:"Niob",atomicNumber:41,mass:92.906,group:"transition",period:5,block:"d",groupNumber:5,color:Y,description:"Supraleiter bei niedrigen Temperaturen. Für Beschleunigermagnete und Hochspannungstechnik.",theme:"technology",experiments:["supraleiter","magnet","hochspannung"]},{symbol:"Mo",name:"Molybdän",atomicNumber:42,mass:95.95,group:"transition",period:5,block:"d",groupNumber:6,color:Y,description:"Extrem hartes Metall. Für Hochtemperaturanwendungen und Schmierstoffe.",theme:"industry",experiments:["hochtemperatur","schmiermittel","stahl"]},{symbol:"Tc",name:"Technetium",atomicNumber:43,mass:98,group:"transition",period:5,block:"d",groupNumber:7,color:Y,description:"Erstes künstliche Element. Radioaktiv. In der medizinischen Bildgebung verwendet.",theme:"nuclear",experiments:["künstlich","medizin","radioaktiv"]},{symbol:"Ru",name:"Ruthenium",atomicNumber:44,mass:101.07,group:"transition",period:5,block:"d",groupNumber:8,color:Y,description:"Seltenes, aber wichtiges Metall. Für Elektronikkontakte und Katalysatoren.",theme:"technology",experiments:["katalysator","kontakte","legierung"]},{symbol:"Rh",name:"Rhodium",atomicNumber:45,mass:102.91,group:"transition",period:5,block:"d",groupNumber:9,color:Y,description:"Sehr wertvolles Übergangsmetall. Für Katalysatoren, Schmuck und Thermoelemente.",theme:"technology",experiments:["katalysator","schmuck","thermo"]},{symbol:"Pd",name:"Palladium",atomicNumber:46,mass:106.42,group:"transition",period:5,block:"d",groupNumber:10,color:Y,description:"Wertvolles Platin-Metall. Für Katalysatoren, Schmuck und Wasserstofffilter.",theme:"technology",experiments:["katalysator","schmuck","wasserstoff"]},{symbol:"Ag",name:"Silber",atomicNumber:47,mass:107.87,group:"transition",period:5,block:"d",groupNumber:11,color:Y,description:"Bester elektrischer Leiter aller Metalle. Für Schmuck, Elektronik und Fotografie.",theme:"precious",experiments:["elektrisch","schmuck","fotografie"]},{symbol:"Cd",name:"Cadmium",atomicNumber:48,mass:112.41,group:"transition",period:5,block:"d",groupNumber:12,color:Y,description:"Giftiges Metall. Für NiCd-Batterien, Pigmente und galvanische Elemente.",theme:"toxic",experiments:["batterie","pigment","toxisch"]},{symbol:"In",name:"Indium",atomicNumber:49,mass:114.82,group:"metal",period:5,block:"p",groupNumber:13,color:ee,description:"Weiches Metall. Für ITO-Schichten (Touchscreens), Transistoren und Lötzinn.",theme:"semiconductor",experiments:["touchscreen","lötinn","halbleiter"]},{symbol:"Sn",name:"Zinn",atomicNumber:50,mass:118.71,group:"metal",period:5,block:"p",groupNumber:14,color:ee,description:"Historisch wichtiges Metall. Für Lötlegierungen, Bronze und Konservendosen.",theme:"history",experiments:["löten","bronze","konserven"]},{symbol:"Sb",name:"Antimon",atomicNumber:51,mass:121.76,group:"metalloid",period:5,block:"p",groupNumber:15,color:te,description:"Halbmetall mit ungewöhnlichen Eigenschaften. Für Flammhemmer und Legierungen.",theme:"industry",experiments:["flammhemmer","legierung","halbleiter"]},{symbol:"Te",name:"Tellur",atomicNumber:52,mass:127.6,group:"metalloid",period:5,block:"p",groupNumber:16,color:te,description:"Seltenes, seltenes Halbmetall. Für Solarzellen und Legierungen.",theme:"semiconductor",experiments:["solarzelle","legierung","cdte"]},{symbol:"I",name:"Jod",atomicNumber:53,mass:126.9,group:"halogen",period:5,block:"p",groupNumber:17,color:re,description:"Wichtigstes Spurenelement für Schilddrüse. Dunkle Substanz mit charakteristischem Geruch.",theme:"biological",experiments:["schilddrüse","antiseptik","sublimation"]},{symbol:"Xe",name:"Xenon",atomicNumber:54,mass:131.29,group:"nobleGas",period:5,block:"p",groupNumber:18,color:ne.Xe,description:"Schweres Edelgas. Für Ionentriebwerke, Narkose und Blitzlichtlampen.",theme:"space",experiments:["ionentrieb","narkose","laser"]},{symbol:"Cs",name:"Cäsium",atomicNumber:55,mass:132.91,group:"alkali",period:6,block:"s",groupNumber:1,color:X,description:"Weiches, hochreaktives Metall. Schmilzt in der Hand. Präzisesste Zeitnormal.",theme:"precision",experiments:["schmelzen","atomuhr","explosion"]},{symbol:"Ba",name:"Barium",atomicNumber:56,mass:137.33,group:"alkalineEarth",period:6,block:"s",groupNumber:2,color:$,description:"Für medizinische Kontrastmittel und grüne Feuerwerke. Schwerkresistent.",theme:"medical",experiments:["kontrastmittel","feuerwerk","magnet"]},{symbol:"La",name:"Lanthan",atomicNumber:57,mass:138.91,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Weiches, duktils Metall. Für Hybridauto-Batterien und Zündsteine.",theme:"technology",experiments:["batterie","zündsteine","optik"]},{symbol:"Ce",name:"Cer",atomicNumber:58,mass:140.12,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Häufigstes Lanthanoid. Für Ferrocer-Feuerzeuge und Autokatalysatoren.",theme:"technology",experiments:["feuerzeuge","katalysator","selbstreinigend"]},{symbol:"Pr",name:"Praseodym",atomicNumber:59,mass:140.91,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Für Magnetlegierungen und Grüne Farbe. Wichtig für Hightech-Legierungen.",theme:"technology",experiments:["magnet","grün","legierung"]},{symbol:"Nd",name:"Neodym",atomicNumber:60,mass:144.24,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Stärkste Permanentmagnete. Für Kopfhörer, Windturbinen und Festplatten.",theme:"technology",experiments:["magnet","kopfhörer","windturbine"]},{symbol:"Pm",name:"Promethium",atomicNumber:61,mass:145,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Künstliches, radioaktives Element. Für Kernbatterien in Raumfahrzeugen.",theme:"space",experiments:["künstlich","kernbatterie","radioaktiv"]},{symbol:"Sm",name:"Samarium",atomicNumber:62,mass:150.36,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Für Permanentmagnete und Kernreaktor-Steuerstäbe.",theme:"nuclear",experiments:["magnet","reaktor","absorber"]},{symbol:"Eu",name:"Europium",atomicNumber:63,mass:151.96,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Rot phosphoreszierend in Euro-Scheinen. Für Sicherheit und Lasermaterialien.",theme:"security",experiments:["phosphoreszenz","euro","laser"]},{symbol:"Gd",name:"Gadolinium",atomicNumber:64,mass:157.25,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Höchste Neutronenabsorption. Für MRT-Kontrastmittel und Kernreaktorsteuerung.",theme:"medical",experiments:["mrt","reaktor","absorber"]},{symbol:"Tb",name:"Terbium",atomicNumber:65,mass:158.93,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Weiches Lanthanoid. Für Phosphorleuchtstoffe und Elektromotore.",theme:"technology",experiments:["phosphor","magnet","motor"]},{symbol:"Dy",name:"Dysprosium",atomicNumber:66,mass:162.5,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Hochwertiges Lanthanoid. Für Kernreaktorsteuerstäbe und Magnetlegierungen.",theme:"nuclear",experiments:["reaktor","magnet","legierung"]},{symbol:"Ho",name:"Holmium",atomicNumber:67,mass:164.93,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Besitzt höchstes magnetisches Moment aller Elemente. Für Laser und Hochleistungsmagnete.",theme:"technology",experiments:["laser","magnet","hochleistung"]},{symbol:"Er",name:"Erbium",atomicNumber:68,mass:167.26,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Für Glasfaser-Verstärker und optische Verstärker. Rosarotes Leuchten.",theme:"technology",experiments:["glasfaser","optik","laser"]},{symbol:"Tm",name:"Thulium",atomicNumber:69,mass:168.93,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Für medizinische Röntgenanlagen. Röntgen-Kontrastmittel.",theme:"medical",experiments:["röntgen","medizin","laser"]},{symbol:"Yb",name:"Ytterbium",atomicNumber:70,mass:173.05,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Für Stahllegierungen und Röntgenanlagen. Rote Lumineszenz.",theme:"industry",experiments:["legierung","röntgen","luminiszenz"]},{symbol:"Lu",name:"Lutetium",atomicNumber:71,mass:174.97,group:"lanthanide",period:6,block:"f",groupNumber:3,color:J,description:"Letztes natürliches Lanthanoid. Für PET-Scanner und Katalysatoren.",theme:"technology",experiments:["scanner","katalysator","spektrometer"]},{symbol:"Hf",name:"Hafnium",atomicNumber:72,mass:178.49,group:"transition",period:6,block:"d",groupNumber:4,color:Y,description:"Korrosionsbeständiges Metall. Für Reaktordruckbehälter und Kernenergieanwendungen.",theme:"nuclear",experiments:["reaktor","kernenergie","legierung"]},{symbol:"Ta",name:"Tantal",atomicNumber:73,mass:180.95,group:"transition",period:6,block:"d",groupNumber:5,color:Y,description:"Extrem korrosionsbeständig. Für Kondensatoren und elektronische Bauteile.",theme:"electronics",experiments:["kondensator","elektronik","korrosion"]},{symbol:"W",name:"Wolfram",atomicNumber:74,mass:183.84,group:"transition",period:6,block:"d",groupNumber:6,color:Y,description:"Höchster Schmelzpunkt aller Elemente. Für Glühbirnen und Wolframbearbeitung.",theme:"technology",experiments:["glühbirne","bearbeitung","legierung"]},{symbol:"Re",name:"Rhenium",atomicNumber:75,mass:186.21,group:"transition",period:6,block:"d",groupNumber:7,color:Y,description:"Selteneres, hochschmelzendes Metall. Für Düsenläufer und Hochtemperaturlegierungen.",theme:"aerospace",experiments:["düsenläufer","hochtemperatur","legierung"]},{symbol:"Os",name:"Osmium",atomicNumber:76,mass:190.23,group:"transition",period:6,block:"d",groupNumber:8,color:Y,description:"Dichtestes natürliches Element. Für Schreibspitzen und Implantate.",theme:"technology",experiments:["schreibspitzen","implantat","legierung"]},{symbol:"Ir",name:"Iridium",atomicNumber:77,mass:192.22,group:"transition",period:6,block:"d",groupNumber:9,color:Y,description:"Extrem korrosionsbeständiges Metall. Für Zündkerzen und Elektroden.",theme:"technology",experiments:["zündkerzen","elektroden","legierung"]},{symbol:"Pt",name:"Platin",atomicNumber:78,mass:195.08,group:"transition",period:6,block:"d",groupNumber:10,color:Y,description:"Edelmetall für Katalysatoren, Schmuck und Katalysatoren. Beständiger als Gold.",theme:"precious",experiments:["katalysator","schmuck","legierung"]},{symbol:"Au",name:"Gold",atomicNumber:79,mass:196.97,group:"transition",period:6,block:"d",groupNumber:11,color:Y,description:"Edelstes Metall, einziges gelbes Metall (relativistische Effekte). Für Elektronik und Schmuck.",theme:"treasure",experiments:["ductilität","legierungen","elektroplattierung"]},{symbol:"Hg",name:"Quecksilber",atomicNumber:80,mass:200.59,group:"transition",period:6,block:"d",groupNumber:12,color:Y,description:"Einziges flüssiges Metall bei Raumtemperatur. Für Thermometer und Alchemiehistorie.",theme:"historical",experiments:["flüssig","thermometer","alchemie"]},{symbol:"Tl",name:"Thallium",atomicNumber:81,mass:204.38,group:"metal",period:6,block:"p",groupNumber:13,color:ee,description:"Giftiges, weiches Metall. Historisch in Mordfällen verwendet. Für Glasherstellung.",theme:"toxic",experiments:["gift","glasherstellung","temperatur"]},{symbol:"Pb",name:"Blei",atomicNumber:82,mass:207.2,group:"metal",period:6,block:"p",groupNumber:14,color:ee,description:"Schwerstes stabiles Element. Für Akkus und Röntgenschutz. Römisches Erbe.",theme:"history",experiments:["akkus","röntgen","blei"]},{symbol:"Bi",name:"Wismut",atomicNumber:83,mass:208.98,group:"metalloid",period:6,block:"p",groupNumber:15,color:te,description:"Dichtes, schmelzendes Metall. Für Kosmetika, Schmiermittel und Röntgenkontrast.",theme:"medical",experiments:["kosmetika","schmiermittel","röntgen"]},{symbol:"Po",name:"Polonium",atomicNumber:84,mass:209,group:"metalloid",period:6,block:"p",groupNumber:16,color:te,description:"Hochradioaktiv, starkes Metall. Historisch berühmt (Curie). Für Alphastrahler.",theme:"nuclear",experiments:["alphastrahler","radioaktiv","wärmequelle"]},{symbol:"At",name:"Astatin",atomicNumber:85,mass:210,group:"halogen",period:6,block:"p",groupNumber:17,color:re,description:"Seltenstes natürliches Element. Halbwertszeit ~8 Stunden. Für Forschung.",theme:"research",experiments:["forschung","halbwertszeit","instabil"]},{symbol:"Rn",name:"Radon",atomicNumber:86,mass:222,group:"nobleGas",period:6,block:"p",groupNumber:18,color:ne.Rn,description:"Radionuklid, zweithäufigste Lungenkrebsursache. Für Radonmessung und Schutz.",theme:"radiation",experiments:["radonmessung","schutz","zerfall"]},{symbol:"Fr",name:"Francium",atomicNumber:87,mass:223,group:"alkali",period:7,block:"s",groupNumber:1,color:X,description:"Instabil, radioaktiv. Nie makroskopisch beobachtet. Hypothetische Wasserreaktion.",theme:"theoretical",experiments:["instabil","halbwertszeit","theoretisch"]},{symbol:"Ra",name:"Radium",atomicNumber:88,mass:226,group:"alkalineEarth",period:7,block:"s",groupNumber:2,color:$,description:"Hochradioaktiv, luminiszierendes Metall. Leuchtet im Dunkeln. Für historische Lampen.",theme:"historical",experiments:["leuchten","historisch","radioaktiv"]},{symbol:"Ac",name:"Actinium",atomicNumber:89,mass:227,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Namensgeber der Actinoide. Radioaktiv. Ausgangsstoff für Urananreicherung.",theme:"nuclear",experiments:["urananreicherung","strahlung","zerfall"]},{symbol:"Th",name:"Thorium",atomicNumber:90,mass:232.04,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Für Flüssigsalzreaktoren. Sicherer und abundanter als Uran. Mythologisch benannt.",theme:"nuclear",experiments:["flüssigsalzreaktor","sicherheit","kernenergie"]},{symbol:"Pa",name:"Protactinium",atomicNumber:91,mass:231.04,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Selteneres, radioaktives Element. Für Kernreaktor-Forschung.",theme:"research",experiments:["forschung","kernreaktor","urananreicherung"]},{symbol:"Np",name:"Neptunium",atomicNumber:93,mass:237,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. Erste in Atomversuchen produziert. Für Plutonium-Herstellung.",theme:"nuclear",experiments:["künstlich","plutonium","reaktor"]},{symbol:"Pu",name:"Plutonium",atomicNumber:94,mass:244,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Tödlichste Substanz. Mikrogramm können töten. Für Kernwaffen und Raumfahrt-RTGs.",theme:"nuclear",experiments:["kernwaffen","raumfahrt","gefahr"]},{symbol:"Am",name:"Americium",atomicNumber:95,mass:243,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. Entdeckt in H-Bomben-Fallout (Ivy Mike 1952). Für Rauchdetektoren.",theme:"space",experiments:["rauchdetektor","h-bombe","spuren"]},{symbol:"Cm",name:"Curium",atomicNumber:96,mass:247,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. Namensgeber: Pierre und Marie Curie. Für Raumschiff-RTGs.",theme:"space",experiments:["raumfahrt","curie","kernenergie"]},{symbol:"Bk",name:"Berkelium",atomicNumber:97,mass:247,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. Sehr kurzlebig. Für wissenschaftliche Forschung.",theme:"research",experiments:["forschung","kernchemie","instabil"]},{symbol:"Cf",name:"Californium",atomicNumber:98,mass:251,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. Für Neutronenquellen und Elementsynthese.",theme:"nuclear",experiments:["neutronenquelle","synthese","zerfall"]},{symbol:"Es",name:"Einsteinium",atomicNumber:99,mass:252,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. Entdeckt 1952 im Fallout der H-Bombe Ivy Mike. In Gedenken an Einstein.",theme:"history",experiments:["historisch","h-bombe","memorial"]},{symbol:"Fm",name:"Fermium",atomicNumber:100,mass:257,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. Namensgeber: Enrico Fermi. Für theoretische Kernreaktoren.",theme:"research",experiments:["reaktor","theoretisch","nuklearphysik"]},{symbol:"Md",name:"Mendelevium",atomicNumber:101,mass:258,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. In Gedenken an Mendelejew. Ehemaliges Element 101.",theme:"history",experiments:["historisch","periodensystem","tradition"]},{symbol:"No",name:"Nobelium",atomicNumber:102,mass:259,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Künstliches Element. Benannt nach Alfred Nobel. Für wissenschaftliche Anerkennung.",theme:"history",experiments:["auszeichnung","nobelpreis","forschung"]},{symbol:"Lr",name:"Lawrencium",atomicNumber:103,mass:262,group:"actinide",period:7,block:"f",groupNumber:3,color:Q,description:"Letztes natürliches Element. Namensgeber: Ernest Lawrence. Entdeckung der Lanthanoide.",theme:"discovery",experiments:["entdeckung","synchrotron","teilchenbeschleuniger"]},{symbol:"Rf",name:"Rutherfordium",atomicNumber:104,mass:267,group:"actinide",period:7,block:"d",groupNumber:4,color:Q,description:"Künstliches Element. Namensgeber: Ernest Rutherford. Entdeckung des Atomkerns.",theme:"research",experiments:["kernphysik","teilchen","reaktor"]},{symbol:"Db",name:"Dubnium",atomicNumber:105,mass:268,group:"actinide",period:7,block:"d",groupNumber:5,color:Q,description:"Künstliches Element. Namensgeber: Stadt Dubna. Forschungszentrum Russlands.",theme:"research",experiments:["forschung","kernchemie","instabil"]},{symbol:"Sg",name:"Seaborgium",atomicNumber:106,mass:269,group:"actinide",period:7,block:"d",groupNumber:6,color:Q,description:"Künstliches Element. Namensgeber: Glenn Seaborg. Forschungszentrum USA.",theme:"research",experiments:["forschung","chemie","synthese"]},{symbol:"Bh",name:"Bohrium",atomicNumber:107,mass:270,group:"actinide",period:7,block:"d",groupNumber:7,color:Q,description:"Künstliches Element. Namensgeber: Niels Bohr. Quantenmechanik-Revolution.",theme:"science",experiments:["quantenmechanik","theoretisch","modell"]},{symbol:"Hs",name:"Hassium",atomicNumber:108,mass:277,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Hessen (Bundesland). Erste deutsche Entdeckung.",theme:"discovery",experiments:["entdeckung","deutsch","teilchen"]},{symbol:"Mt",name:"Meitnerium",atomicNumber:109,mass:278,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Lise Meitner. Entdeckung der Kernspaltung.",theme:"history",experiments:["kernspaltung","uran","geschichte"]},{symbol:"Ds",name:"Darmstadtium",atomicNumber:110,mass:281,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Darmstadt. GSI Teilchenbeschleuniger.",theme:"research",experiments:["teilchenbeschleuniger","schwerionen","synthese"]},{symbol:"Rg",name:"Roentgenium",atomicNumber:111,mass:282,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Wilhelm Röntgen. Für medizinische Bildgebung.",theme:"medical",experiments:["röntgen","medizin","synthese"]},{symbol:"Cn",name:"Copernicium",atomicNumber:112,mass:285,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Nikolaus Kopernikus. Revolution des Weltbilds.",theme:"history",experiments:["astronomie","revolution","universum"]},{symbol:"Nh",name:"Nihonium",atomicNumber:113,mass:286,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Japan. Für Elementsynthese-Forschung.",theme:"research",experiments:["synthese","element","forschung"]},{symbol:"Fl",name:"Flerovium",atomicNumber:114,mass:289,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Georgij Flerow. Für theoretische Physik.",theme:"science",experiments:["theoretisch","modell","stabilität"]},{symbol:"Mc",name:"Moscovium",atomicNumber:115,mass:290,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Moskau. Dubiose Entdeckungsgeschichte.",theme:"history",experiments:["dubios","synthese","wissenschaft"]},{symbol:"Lv",name:"Livermorium",atomicNumber:116,mass:293,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Lawrence Livermore National Laboratory. Element 116.",theme:"research",experiments:["element116","kernreaktor","synthese"]},{symbol:"Ts",name:"Tennessin",atomicNumber:117,mass:294,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Künstliches Element. Namensgeber: Tennessee (USA). Superheavy-Elemente-Forschung.",theme:"research",experiments:["superheavy","inselfstabilität","synthese"]},{symbol:"Og",name:"Oganesson",atomicNumber:118,mass:294,group:"actinide",period:7,block:"d",groupNumber:8,color:Q,description:"Schwerstes natürliches Element. Namensgeber: Yuri Oganessian. Insel der Stabilität gesucht.",theme:"discovery",experiments:["inselfstabilität","insel","theoretisch"]}];const ie=[{id:"reaction_lab",name:"Reaktionslabor",description:"Die Alchemistenwerkstatt",icon:"🧪",color:16739179,experiments:["alkali_water","thermit","elefantenzahnpasta"]},{id:"nuclear_chamber",name:"Nuklearphysik",description:"Kernkraftwerk-Kontrollraum",icon:"☢️",color:4876733,experiments:["fission","fusion","decay"]},{id:"electrochem_lab",name:"Elektrochemie",description:"Batterien und Elektrolyse",ion:"🔋",color:7649791,experiments:["lion_battery","galvanic","electrolysis"]},{id:"organic_chem",name:"Organische Chemie",description:"Das Kohlenstoff-Universum",icon:"🧬",color:2148759,experiments:["dna","proteins","polymers"]},{id:"extreme_conditions",name:"Extreme Bedingungen",description:"Grenzen der Materie",icon:"🌡️",color:16755021,experiments:["superfluid","plasma","highpressure"]},{id:"industrial_apps",name:"Industrielle Anwendungen",description:"Großindustrie der Chemie",icon:"🏭",color:7649791,experiments:["haberbosch","blastfurnace","petrochemical"]},{id:"historical_lab",name:"Historisches Labor",description:"Meilensteine der Entdeckung",icon:"🏛️",color:14037892,experiments:["marie_curie","lavoisier","mendeleev"]},{id:"space_chem",name:"Weltraumchemie",description:"Chemie im Kosmos",icon:"🚀",color:657946,experiments:["nucleosynthesis","meteorites","interstellar"]},{id:"nano_world",name:"Nano-Welt",description:"Die atomare Perspektive",icon:"🔬",color:1548984,experiments:["crystals","orbitals","nanotubes"]},{id:"challenge_arena",name:"Challenge-Arena",description:"Quiz und Wettkampf",icon:"🏆",color:16761095,experiments:["quiz","puzzle","escape_room"]}];var se,ae,le,ce,me,ue=[],de=[],he=[],pe=null;function ge(e){(se=new o.Scene).background=new o.Color(657946);const t=new o.CylinderGeometry(15,15,.2,64),r=new o.MeshBasicMaterial({color:1710638}),n=new o.Mesh(t,r);n.position.y=-.1,se.add(n);const i=new o.PlaneBufferGeometry(30,30),s=new o.MeshBasicMaterial({visible:!1});(me=new o.Mesh(i,s)).rotation.x=-Math.PI/2,me.position.y=.001,se.add(me),function(e){const t=new o.Group,r=new o.SphereGeometry(.8,32,32),n=new o.MeshBasicMaterial({color:4886754,transparent:!0,opacity:.8});(ae=new o.Mesh(r,n)).position.y=1.6,t.add(ae);const i=new o.SphereGeometry(.8*1.5,32,32),s=new o.MeshBasicMaterial({color:4886754,transparent:!0,opacity:.3,side:o.BackSide}),a=new o.Mesh(i,s);a.position.y=1.6,t.add(a),se.add(t)}(),function(e){const t=[16739179,5301186,16098851];[1,2,3].forEach((e,r)=>{const n=4+1.5*e,i=new o.TorusGeometry(n,.02,16,100),s=new o.MeshBasicMaterial({color:t[r%t.length],transparent:!0,opacity:.5}),a=new o.Mesh(i,s);a.rotation.x=Math.PI/2,a.position.y=1.6,se.add(a);const l=new o.SphereGeometry(.1,16,16),c=new o.MeshBasicMaterial({color:16777215}),m=new o.Mesh(l,c),u=new o.Group;u.position.y=1.6,u.add(m),m.userData={angle:Math.random()*Math.PI*2,speed:.5/(.7*e),radius:n},se.add(u),ue.push(u)})}(),function(e){const t=new o.Group;for(let e=0;e<oe.length&&e<3;e++){const r=oe[e],n=new o.BoxGeometry(12/18*.8,.8,.05),i=new o.MeshBasicMaterial({color:r.color,transparent:!0,opacity:.3,side:o.DoubleSide}),s=new o.Mesh(n,i),a=(r.groupNumber-9)*(12/18),l=1*(4-r.period);s.position.set(a,l+2,-6),s.userData.element=r,s.name="element_"+r.symbol,t.add(s)}le=t,se.add(t)}(),function(e){const t=new o.Group,r=2*Math.PI/oe.length;oe.forEach((n,i)=>{const s=i*r,a=8*Math.cos(s),l=8*Math.sin(s),c=new o.SphereGeometry(.25,16,16),m=new o.MeshBasicMaterial({color:n.color,transparent:!0,opacity:.7}),u=new o.Mesh(c,m);u.position.set(a,1.6,l),u.userData.element=n,u.userData.roomIndex=i+1,u.name=`element_${n.symbol}_button`,t.add(u),de.push(u);e.world.createEntity().addComponent(x,{text:n.symbol,color:"#ffffff",fontSize:.15,anchor:"center",baseline:"middle",textAlign:"center"}).addComponent(v,{value:u}).addComponent(f,{x:0,y:.4,z:0}),t.add(u)}),se.add(t)}(e),function(e){const t=new o.Group,r=2*Math.PI/ie.length;ie.forEach((e,n)=>{const i=n*r,s=12*Math.cos(i),a=12*Math.sin(i),l=new o.BoxGeometry(.8,.8,.1),c=new o.MeshBasicMaterial({color:e.color,transparent:!0,opacity:.6}),m=new o.Mesh(l,c);m.position.set(s,1.6,a),m.userData.expRoom=e,m.userData.roomIndex=oe.length+n+1,m.name=`exp_${e.id}_button`,t.add(m),he.push(m)}),se.add(t)}(),function(e){const t=new o.PlaneGeometry(3,2),r=new o.MeshBasicMaterial({color:2763322,transparent:!0,opacity:.9,side:o.DoubleSide});(ce=new o.Mesh(t,r)).position.set(0,3.5,-4),ce.visible=!1,se.add(ce);const n=e.world.createEntity();n.addComponent(x,{text:"",color:"#ffffff",fontSize:.12,anchor:"center",baseline:"top",textAlign:"center"}).addComponent(v,{value:ce}).addComponent(f,{x:0,y:.6,z:.01}),ce.userData.titleText=n;const i=e.world.createEntity();i.addComponent(x,{text:"",color:"#cccccc",fontSize:.06,anchor:"center",baseline:"top",textAlign:"center",maxWidth:2.6,lineHeight:1.4}).addComponent(v,{value:ce}).addComponent(f,{x:0,y:-.2,z:.01}),ce.userData.descText=i}(e);const a=new o.AmbientLight(16777215,.2);se.add(a);const l=new o.PointLight(4886754,1,10);l.position.set(0,2,0),se.add(l),se.userData.teleport=me,se.userData.atomCore=ae,se.userData.electronOrbits=ue,function(e){e.raycontrol.addState("lobbyElements",{colliderMesh:[...de],controller:"primary",onHover:(e,t)=>{const r=e.object;r.scale.setScalar(t?1.3:1),function(e){if(!e||pe===e.symbol)return;pe=e.symbol,ce.visible=!0;ce.userData.titleText.getComponent(x).text=`${e.symbol} - ${e.name}`;ce.userData.descText.getComponent(x).text=e.description}(r.userData.element)},onHoverLeave:e=>{be()},onSelectStart:(t,r)=>{e.goto=t.object.userData.roomIndex},onSelectEnd:e=>{}}),e.raycontrol.addState("lobbyExpRooms",{colliderMesh:[...he],controller:"primary",onHover:(e,t)=>{e.object.scale.setScalar(t?1.2:1)},onHoverLeave:e=>{},onSelectStart:(t,r)=>{e.goto=t.object.userData.roomIndex},onSelectEnd:e=>{}}),e.raycontrol.addState("lobbyTeleport",{colliderMesh:me,controller:"primary",onHover:(t,r)=>{e.teleport.onHover(t.point,r)},onHoverLeave:()=>{e.teleport.onHoverLeave()},onSelectStart:(t,r)=>{e.teleport.onSelectStart(r)},onSelectEnd:t=>{e.teleport.onSelectEnd(t.point)}})}(e)}function be(){pe=null,ce.visible=!1}function ye(e){e.renderer.setClearColor(657946),e.scene.add(se),e.raycontrol.activateState("lobbyElements"),e.raycontrol.activateState("lobbyExpRooms"),e.raycontrol.activateState("lobbyTeleport")}function fe(e){e.raycontrol.deactivateState("lobbyElements"),e.raycontrol.deactivateState("lobbyExpRooms"),e.raycontrol.deactivateState("lobbyTeleport"),e.scene.remove(se),be()}function ve(e,t,r){ae&&(ae.material.opacity=.6+.2*Math.sin(2*r),ae.scale.setScalar(1+.05*Math.sin(3*r))),ue.forEach(e=>{const r=e.children[0],n=r.userData;n.angle+=n.speed*t,r.position.x=Math.cos(n.angle)*n.radius,r.position.z=Math.sin(n.angle)*n.radius}),le&&(le.rotation.y=.1*r,le.position.y=2+.2*Math.sin(.5*r)),de.forEach((e,t)=>{e.position.y=1.6+.1*Math.sin(2*r+.5*t)})}new c.a,new u.a;var xe,ke,we,Ne,Se,Ee,Me,Ce,ze,Le=class{constructor(e){this.ctx=e,this.recognition=null,this.isListening=!1,this.commands=[],this.currentLanguage="de",this.elementCommands={de:{trigger:"zeige mir",element:"element"},en:{trigger:"show me",element:"element"}},this.setupUI()}setupUI(){const e=document.createElement("div");e.id="voice-status",e.style.css="\n      position: fixed;\n      bottom: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: rgba(0, 0, 0, 0.7);\n      padding: 15px 20px;\n      border-radius: 8px;\n      font-family: Arial, sans-serif;\n      color: white;\n      z-index: 1000;\n      font-size: 16px;\n      pointer-events: none;\n    ",e.innerHTML='\n      <div style="display: flex; align-items: center; gap: 10px;">\n        <button id="voice-toggle" style="\n          background: linear-gradient(135deg, #667eea, #764ba2);\n          border: none;\n          border-radius: 20px;\n          padding: 10px 20px;\n          color: white;\n          font-weight: bold;\n          font-size: 14px;\n          cursor: pointer;\n        ">\n          🎤 Mikrofon an\n        </button>\n      </div>\n      <div id="voice-text" style="\n        font-size: 18px;\n        margin-top: 10px;\n        min-height: 24px;\n      );\n        Sprechen Sie "Zeige mir Element" oder "Show me Element"\n      </div>\n    ',document.body.appendChild(e)}async init(){if(!("webkitSpeechRecognition"in window))return console.warn("Web Speech API not supported"),void this.setupUI();this.recognition=new webkitSpeechRecognition,this.recognition.continuous=!1,this.recognition.interimResults=!1,this.recognition.lang="de"===this.currentLanguage?"de-DE":"en-US",this.setupEventListeners(),await this.recognition.start(),console.log("Voice recognition initialized")}setupEventListeners(){this.recognition.onstart=()=>{this.isListening=!0,this.updateStatus("Zuhört..."),this.executeCommand(this.recognition.transcript||"")},this.recognition.onend=()=>{this.isListening=!1,this.updateStatus("Bereit")}}async startListening(){this.stop(),await new Promise(e=>setTimeout(e,100));try{await this.recognition.start();const e=setTimeout(()=>{this.recognition.stop(),resolve(!1)},5e3);this.isListening=!0,this.updateStatus("Zuhört...");const t=await Promise.race([this.recognition.start(),e]);this.recognition.stop(),this.isListening=!1,this.updateStatus("Bereit"),resolve(t)}catch(e){console.error("Voice recognition error:",e),this.recognition.stop(),resolve(!1)}}stop(){this.isListening=!1,this.recognition&&this.recognition.stop(),this.updateStatus("Bereit")}updateStatus(e){const t=document.getElementById("voice-text");t&&(t.textContent=e)}async executeCommand(e){if(!e||!e.trim())return null;const t=e.toLowerCase(),r=this.elementCommands[this.currentLanguage];let n=null;new RegExp(r.trigger+"\\s+("+r.element+"(\\s+[a-zäöüß]+)?","i");const o=t.match(r.trigger);if(o){if(o.index>-1){const e=t.substring(o.index+o[0].length).trim();if("de"===this.currentLanguage){(e.includes("und")||e.includes("und die"))&&(e=e.replace(/und die/,""));const t=e.trim();n=this.findElementByName(t)}else{const e=t.match(/show\s+me\s+(\w+)(?:\s+of)?/i);if(e){const r=t.substring(e.index+4).trim();n=this.findElementByName(r)}else{const e=t.match(/show\s+(\w+)(?:\s+of)?/i);if(e){const r=t.substring(e.index+4).trim();n=this.findElementByName(r)}}}}else r.element&&-1===o.index&&(n=this.extractElement(e));if(n)return console.log("Voice command: Navigate to "+n.symbol),this.commands.push({type:"navigate",element:n,timestamp:Date.now()}),n}return null}findElementByName(e){if(this.ctx&&this.ctx.assets){const t=this.ctx.assets.elements,r=e.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss");return t.find(e=>e.name.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").includes(r)||e.symbol.toLowerCase()===r||r.includes(e.name.toLowerCase()))}return null}extractElement(e){const t=[],r=e.toLowerCase().split(/[\s,.,!?]+/);for(const e of r)e.length<2||ELEMENTS.some(t=>{const r=t.name.toLowerCase();return r.includes(e)||r===e||t.symbol.toLowerCase()===e||normalized.includes(r)})&&t.push(e);return 1===t.length?ELEMENTS.find(e=>t.includes(e.name.toLowerCase())||t.includes(e.symbol.toLowerCase())):null}getRecentCommands(){const e=Date.now();return this.commands.filter(t=>t.timestamp&&e-t.timestamp<1e4)}getCurrentLanguage(){return this.currentLanguage}setLanguage(e){["de","en"].includes(e)&&(this.currentLanguage=e,this.updateStatus("Sprache: "+e.toUpperCase()))}},Fe=new o.Clock,Be={},Re=[],Ve=[];const He=1+oe.length-1,Pe=He+1;const Ae=new URL(window.location),Ge=(Ae.searchParams.get("room"),Ae.searchParams.has("debug")),De=Ae.searchParams.has("handedness")?Ae.searchParams.get("handedness"):"right";new o.Vector3(0,0,5),new o.Vector3(0,0,-5),new o.Vector3(0,0,-5);function Te(e,t=null,r=null){Ve[Be.room].exit(Be),Se.deactivateAll();Be.room;0===e?(null,null):e>=1&&e<=He?(t,null):e>=Pe&&(null,r),Be.room=e,function(e){ze&&ze.source&&ze.stop()}(),Ve[Be.room].enter(Be,t||r)}var _e,Ie={};function Ke(){!function(){if("xr"in navigator)navigator.xr.isSessionSupported("immersive-vr").then(e=>{const t=document.getElementById("no-webxr");!e&&t&&t.classList.remove("hidden")});else{const e=document.getElementById("no-webxr");e&&e.classList.remove("hidden")}}();const e=document.getElementById(De+"hand");e&&e.classList.add("activehand"),(_e=new p.e).registerSystem(F).registerSystem(V).registerSystem(H).registerSystem(R).registerSystem(D).registerSystem(_).registerSystem(P),Ie.lobby=new I(_e,[V,H,R]),(ke=new o.WebGLRenderer({antialias:!0,logarithmicDepthBuffer:!1,powerPreference:"high-performance",preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1})).gammaFactor=2.2,ke.outputEncoding=o.sRGBEncoding,ke.setPixelRatio(Math.min(window.devicePixelRatio,2)),ke.setSize(window.innerWidth,window.innerHeight),ke.xr.enabled=!0,ke.sortObjects=!1,ke.autoClear=!0,ke.autoClearDepth=!0,ke.autoClearStencil=!0,xe=new o.Scene,(we=new o.PerspectiveCamera(80,window.innerWidth/window.innerHeight,.005,1e4)).position.set(0,1.6,0),Ce=new o.AudioListener,we.add(Ce),ze=new o.Audio(Ce),Ne=new i.a(we,ke.domElement),document.body.addEventListener("click",()=>{Be.vrMode||Ne.lock()});var t=!1,r=!1,a=!1,g=!1;document.addEventListener("keydown",e=>{switch(e.keyCode){case 87:case 38:t=!0;break;case 65:case 37:a=!0;break;case 83:case 40:r=!0;break;case 68:case 39:g=!0}}),document.addEventListener("keyup",e=>{switch(e.keyCode){case 87:case 38:t=!1;break;case 65:case 37:a=!1;break;case 83:case 40:r=!1;break;case 68:case 39:g=!1}}),Be.browserControls={controls:Ne,moveForward:()=>t,moveBackward:()=>r,moveLeft:()=>a,moveRight:()=>g};for(let e=0;e<2;e++)Re[e]=ke.xr.getController(e),Re[e].raycaster=new o.Raycaster,Re[e].raycaster.near=.1,Re[e].addEventListener("selectstart",Ue),Re[e].addEventListener("selectend",qe);const b=new o.DirectionalLight(15663103);b.name="sun",b.position.set(.2,1,.1);const y=new o.DirectionalLight(16773358,.3);y.name="fillLight",y.position.set(-.2,-1,-.1),xe.add(b,y);var f=new o.Group;f.add(we),f.add(Re[0]),f.add(Re[1]),f.position.set(0,0,2),xe.add(f),Be.vrMode=!1,Be.assets=K,Be.shaders=W,Be.scene=xe,Be.renderer=ke,Be.camera=we,Be.audioListener=Ce,Be.goto=null,Be.cameraRig=f,Be.controllers=Re,Be.world=_e,Be.systemsGroup=Ie,Be.handedness=De,Be.GotoRoom=Te,window.context=Be,function(e,t,r,n,i,s){t&&"/"!=t[t.length-1]&&(t+="/");var a=new l.a;a.setTranscoderPath("src/vendor/"),a.detectSupport(e);var p=new c.a,g=new u.a;g.setDecoderPath("src/vendor/"),p.setDRACOLoader(g);var b=new o.TextureLoader,y={gltf:p,glb:p,obj:new m.a,gif:b,png:b,jpg:b,basis:a,font:new o.FontLoader,ogg:new o.AudioLoader};for(var f in r){let e=f,o=r[f].url;r[f].loading=!0;let a=o.substr(o.lastIndexOf(".")+1).toLowerCase();y[a].load(t+o,t=>{s&&console.info(`%c ${o} loaded`,"color:green");var l=r[e].options;if(r[e]="font"==a?t.data:t,void 0!==l){void 0!==l.repeat&&(r[e].repeat.set(l.repeat[0],l.repeat[1]),delete l.repeat);for(let t in l)r[e][t]=l[t];i&&i(d(r))}n&&h(r)&&n()},()=>{},t=>{console.error("Error loading asset",o,t),"ogg"===a&&(r[e]=null,r[e].loading=!1,n&&h(r)&&n())})}}(ke,"assets/",K,()=>{Se=new q(Be,De),Be.raycontrol=Se,Ee=new Z(Be),Be.teleport=Ee,Me=new Le(Be),function(){Me.init();var e=K.generic_controller_model.scene,t=new o.MeshLambertMaterial({map:K.controller_tex});e.getObjectByName("body").material=t,e.getObjectByName("trigger").material=t;for(let t=0;t<2;t++){let r=Re[t];r.boundingBox=new o.Box3,r.userData.grabbing=null,r.addEventListener("connected",(function(t){this.add(e.clone()),Se.addController(this,t.data)})),r.addEventListener("disconnect",(function(){this.remove(this.children[0]),Se.removeController(this,event.data)}))}}(),Ve[0]=n,Ve[0].setup(Be),Be.room=0,Be.cameraRig.position.set(0,0,2),document.body.appendChild(ke.domElement),document.body.appendChild(s(ke,e=>{const t=Be.vrMode;Be.vrMode="sessionStarted"===e,Be.vrMode&&!t?(Ve[Be.room].exit(Be),Be.cameraRig.position.set(0,0,2)):!Be.vrMode&&t&&Ve[Be.room].enter(Be)})),document.getElementById("loading").style.display="none",Ve[0].enter(Be),ke.setAnimationLoop(Ze)},e=>{document.querySelector("#progressbar").setAttribute("stroke-dashoffset",-(282-Math.floor(e/27*282)))},Ge)}var We={},Oe={},je=-1!==navigator.userAgent.indexOf("OculusBrowser")&&parseInt(navigator.userAgent.match(/OculusBrowser\/([0-9]+)./)[1])<8;function Ue(e){if(je){const t=e.target;if(!We[t])return void(We[t]=!0);We[t]=!1}e.target.getObjectByName("trigger").rotation.x=-.3,Se.onSelectStart(e)}function qe(e){if(je){const t=e.target;if(!Oe[t])return void(Oe[t]=!0);Oe[t]=!1}e.target.getObjectByName("trigger").rotation.x=0,Se.onSelectEnd(e)}function Ze(){var e=Fe.getDelta(),t=Fe.elapsedTime;_e.execute(e,t);for(let e=0;e<Re.length;e++){const t=Re[e].getObjectByName("Scene");t&&Re[e].boundingBox.setFromObject(t)}if(!Be.vrMode&&Be.browserControls){const t=3,r=Be.browserControls;r.controls.isLocked&&(r.moveForward()&&Be.camera.translateZ(-t*e),r.moveBackward()&&Be.camera.translateZ(t*e),r.moveLeft()&&Be.camera.translateX(-t*e),r.moveRight()&&Be.camera.translateX(t*e))}if(Be.raycontrol&&Be.raycontrol.execute(Be,e,t),void 0!==Be.room&&Ve[Be.room]){const r=Ve[Be.room];"function"==typeof r.execute&&r.execute(Be,e,t)}ke.render(xe,we),void 0!==Be.goto&&null!==Be.goto&&(Te(Be.goto),Be.goto=null)}window.addEventListener("resize",(function(){we.aspect=window.innerWidth/window.innerHeight,we.updateProjectionMatrix(),ke.setSize(window.innerWidth,window.innerHeight)}),!1),window.onload=()=>{Ke()}}});
//# sourceMappingURL=bundle.js.map