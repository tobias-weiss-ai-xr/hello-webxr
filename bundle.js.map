{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib/VRButton.js","webpack:///./src/lib/slideshow.js","webpack:///./src/lib/assetManager.js","webpack:///./src/components/index.js","webpack:///./src/systems/SDFTextSystem.js","webpack:///./src/systems/DebugHelperSystem.js","webpack:///./src/systems/AreaCheckerSystem.js","webpack:///./src/systems/ControllersSystem.js","webpack:///./src/systems/HierarchySystem.js","webpack:///./src/systems/TransformSystem.js","webpack:///./src/systems/BillboardSystem.js","webpack:///./src/systems/SystemsGroup.js","webpack:///./src/assets.js","webpack:///./src/lib/RayControl.js","webpack:///./src/lib/EventDispatcher.js","webpack:///./src/lib/Teleport.js","webpack:///./src/rooms/Landing.js","webpack:///./src/rooms/Controllers.js","webpack:///./src/rooms/Teleport.js","webpack:///./src/rooms/Models.js","webpack:///./src/rooms/Audio.js","webpack:///./src/rooms/Interaction.js","webpack:///./src/lib/shaders.js","webpack:///./src/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","VRButton","renderer","callback","showWebXRNotFound","button","style","display","cursor","left","width","onmouseenter","onmouseleave","onclick","textContent","stylizeElement","element","position","bottom","padding","border","borderRadius","background","color","font","textAlign","opacity","outline","zIndex","transition","navigator","document","createElement","xr","isSessionSupported","then","supported","currentSession","onSessionStarted","session","addEventListener","onSessionEnded","setSession","removeEventListener","transform","requestSession","optionalFeatures","end","showEnterVR","message","isSecureContext","href","location","replace","innerHTML","textDecoration","slideshow","paths","from","THREE","lookAt","velocity","angularVelocity","setup","context","this","room","undefined","path","next","camera","set","cameraRig","goto","time","Math","random","getCamera","reset","execute","delta","copy","rotation","addScaledVector","x","y","z","getLoadedCount","assets","count","loading","allAssetsLoaded","Object3D","constructor","Rotation","Position","ParentObject3D","Text","text","anchor","baseline","fontSize","letterSpacing","lineHeight","maxWidth","Infinity","overflowWrap","whiteSpace","BoundingBox","min","max","TagComponent","AreaInside","AreaChecker","empty","AreaReactor","onEntering","onExiting","DebugHelper","Children","array","anchorMapping","baselineMapping","SDFTextSystem","System","updateText","textMesh","textComponent","material","sync","entities","queries","added","forEach","e","getComponent","TextMesh","renderOrder","addComponent","removed","object3D","getObjectByName","dispose","remove","changed","components","listen","setFromMinMax","geometry","attributes","needsUpdate","computeBoundingSphere","DebugHelperMesh","SystemStateComponent","super","boxHelper","DebugHelperSystem","results","entity","boundingBox","debugMesh","getMutableComponent","removeComponent","Not","AreaCheckerSystem","areas","checkers","bboxArea","checker","intersectsBox","ControllersSystem","HierarchySystem","parent","add","updateRotation","updatePosition","TransformSystem","cameraPosition","BillboardSystem","getWorldPosition","distance","distanceTo","clamp","sqrt","hasComponent","children","camera3D","SystemsGroup","world","Systems","play","getSystem","stop","doorfx_tex","url","options","wrapT","wrapS","generic_controller_model","controller_tex","teleport_model","glow_tex","encoding","beam_tex","rayMaterial","tempMatrix","validStateController","RayControl","_listeners","stats","fired","handled","eventName","listener","listeners","indexOf","hasEventListener","listenerArray","index","dispatchEvent","resetCounters","enable","setLineStyle","previousLineStyle","enabled","_sort","currentStates","sort","a","b","order","disable","lineBasic","visible","line0","controllers","controller","active","changeHandedness","primary","secondary","addState","state","activate","states","raycaster","includes","console","warn","error","activateState","deactivateAll","intersections","deactivateState","addController","inputSource","controllerData","stateHit","currentIntersection","hit","matchController","raycasterContext","removeController","findIndex","find","ctx","line","scene","uniforms","tex","vertexShader","shaders","basic_vert","fragmentShader","beam_frag","blending","transparent","rayLength","scale","clone","setFromPoints","lineStyle","basic","selector","handedness","onSelectStart","evt","target","intersection","getIntersections","colliderMesh","entries","filter","intersectionData","prevIntersection","lineStyleOnIntersection","onHover","prev","current","onHoverLeave","identity","extractRotation","matrixWorld","ray","origin","setFromMatrixPosition","direction","applyMatrix4","Array","isArray","intersectObjects","intersectObject","onSelectEnd","Teleport","mesh","teleportEntity","teleportHitGeometry","ballColliding","map","startSound","audioListener","setBuffer","setLoop","pause","endSound","hitPoint","targetPoint","headPosition","offset","sub","doors","infoPanels","textEntities","WEBXR_ELEMENTS","id","description","icon","createDoor","total","angle","PI","cos","sin","doorGeo","doorMat","selected","doorColor","door_frag","createDoorMaterial","door","userData","elementId","frameGeo","frameMat","frame","floorGeo","floorMat","floor","centerGeo","centerMat","center","columnGeo","columnMat","column","group","panel","panelGeo","panelMat","titleGeo","titleMat","titlePlate","descGeo","descMat","descPlate","pedestalGeo","pedestalMat","pedestal","iconGeo","iconMat","baseY","createInfoPanel","titleTextEntity","createEntity","descTextEntity","domeGeo","domeMat","side","dome","ambientLight","light1","light2","teleportGeo","teleportMat","teleport","doorMaterials","raycontrol","point","enter","setClearColor","exit","doorMaterial","controllerModels","CONTROLLER_INFO","title","createControllerDisplay","platformGeo","platformMat","platform","rotating","controllerGeo","controllerMat","triggerGeo","triggerMat","trigger","wallMat","backWall","wallHeight","leftWall","rightWall","roomSize","ceiling","bannerGeo","bannerMat","banner","info","centerDisplayGeo","centerDisplayMat","centerDisplay","ringGeo","ringMat","ring","trackingRing","teleportRings","TELEPORT_INFO","pos","rot","wall","outerRing","innerRing","marker","animOffset","createTeleportRing","laserGeo","laserMat","laser","modelPedestals","MODEL_INFO","desc","baseGeo","baseMat","base","topGeo","topMat","top","cubeGeo","cubeMat","wireframe","cube","createPedestal","audioSpheres","AUDIO_INFO","rotateX","sphereGeo","sphereMat","sphere","createAudioSphere","waveGroup","wave","waves","doorFrame","ringScale","interactiveCubes","INTERACTION_INFO","hovered","createInteractiveCube","laserVisual","createLaserVisual","setHex","zoom_frag","panoball_vert","panoball_frag","WebXRPolyfill","controls","ambientMusic","clock","rooms","roomLanding","roomControllers","roomTeleport","roomModels","roomAudio","roomInteraction","roomNames","musicThemes","urlObject","URL","roomName","searchParams","debug","has","targetPositions","landing","models","audio","interaction","gotoRoom","prevRoom","nextRoom","deltaPosition","targetPosition","source","music","setVolume","playMusic","ecsyWorld","systemsGroup","init","handElement","getElementById","classList","noWebXRElement","detectWebXR","World","registerSystem","antialias","logarithmicDepthBuffer","powerPreference","preserveDrawingBuffer","failIfMajorPerformanceCaveat","gammaFactor","outputEncoding","setPixelRatio","devicePixelRatio","setSize","innerWidth","innerHeight","sortObjects","autoClear","autoClearDepth","autoClearStencil","PointerLockControls","domElement","body","vrMode","lock","moveForward","moveBackward","moveLeft","moveRight","ev","keyCode","browserControls","metaKey","getObject","onWindowResize","getController","near","lightSun","lightFill","loadTotal","keys","basePath","onComplete","onProgress","basisLoader","BasisTextureLoader","setTranscoderPath","detectSupport","gltfLoader","GLTFLoader","dracoLoader","DRACOLoader","setDecoderPath","setDRACOLoader","texLoader","loaders","OBJLoader","assetId","assetPath","ext","substr","lastIndexOf","toLowerCase","load","asset","repeat","opt","loadAssets","model","grabbing","event","setupControllers","appendChild","status","setAnimationLoop","animate","loadProgress","querySelector","setAttribute","selectStartSkip","selectEndSkip","OculusBrowser","userAgent","parseInt","match","aspect","updateProjectionMatrix","getDelta","elapsedTime","setFromObject","bc","isLocked","translateZ","translateX","render","onload"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([12,1,2]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n"," /*\n\n\tThis is modification of the original VRButton. I've added a callback to know\n\twhen the user enters and exists from VR\n\n\tOriginal at:\n\t  https://github.com/mrdoob/three.js/blob/dev/examples/jsm/webxr/VRButton.js\n\n */\n/**\n * @author mrdoob / http://mrdoob.com\n * @author Mugen87 / https://github.com/Mugen87\n */\n\nvar VRButton = {\n\n\tcreateButton: function ( renderer, callback ) {\n\n\t\tfunction showEnterVR( /*device*/ ) {\n\n\t\t\tvar currentSession = null;\n\n\t\t\tfunction onSessionStarted( session ) {\n\n\t\t\t\tsession.addEventListener( 'end', onSessionEnded );\n\n\t\t\t\trenderer.xr.setSession( session );\n\t\t\t\tbutton.textContent = 'EXIT VR';\n\n\t\t\t\tcurrentSession = session;\n\n\t\t\t\tcallback('sessionStarted');\n\t\t\t}\n\n\t\t\tfunction onSessionEnded( /*event*/ ) {\n\n\t\t\t\tcurrentSession.removeEventListener( 'end', onSessionEnded );\n\n\t\t\t\tbutton.textContent = 'ENTER VR';\n\n\t\t\t\tcurrentSession = null;\n\n\t\t\t\tcallback('sessionEnded');\n\t\t\t}\n\n\n\t\t\t//\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'pointer';\n\t\t\tbutton.style.left = 'calc(50% - 50px)';\n\t\t\tbutton.style.width = '100px';\n\n\t\t\tbutton.textContent = 'ENTER VR';\n\n\t\t\tbutton.onmouseenter = function () {\n\n\t\t\t\tbutton.style.background = 'rgba(0,0,0,0.9)';\n\t\t\t\tbutton.style.transform = 'scale(1.05)';\n\n\t\t\t};\n\n\t\t\tbutton.onmouseleave = function () {\n\n\t\t\t\tbutton.style.background = 'rgba(0,0,0,0.7)';\n\t\t\t\tbutton.style.transform = 'scale(1.0)';\n\n\t\t\t};\n\n\t\t\tbutton.onclick = function () {\n\n\t\t\t\tif ( currentSession === null ) {\n\n\t\t\t\t\t// WebXR's requestReferenceSpace only works if the corresponding feature\n\t\t\t\t\t// was requested at session creation time. For simplicity, just ask for\n\t\t\t\t\t// the interesting ones as optional features, but be aware that the\n\t\t\t\t\t// requestReferenceSpace call will fail if it turns out to be unavailable.\n\t\t\t\t\t// ('local' is always available for immersive sessions and doesn't need to\n\t\t\t\t\t// be requested separately.)\n\n\t\t\t\t\tvar sessionInit = { optionalFeatures: [ 'local-floor', 'bounded-floor' ] };\n\t\t\t\t\tnavigator.xr.requestSession( 'immersive-vr', sessionInit ).then( onSessionStarted );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcurrentSession.end();\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\tfunction disableButton() {\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'auto';\n\t\t\tbutton.style.left = 'calc(50% - 75px)';\n\t\t\tbutton.style.width = '150px';\n\n\t\t\tbutton.onmouseenter = null;\n\t\t\tbutton.onmouseleave = null;\n\n\t\t\tbutton.onclick = null;\n\n\t\t}\n\n\t\tfunction showWebXRNotFound() {\n\n\t\t\tdisableButton();\n\n\t\t\tbutton.textContent = 'VR NOT SUPPORTED';\n\n\t\t}\n\n\t\tfunction stylizeElement( element ) {\n\n\t\t\telement.style.position = 'absolute';\n\t\t\telement.style.bottom = '20px';\n\t\t\telement.style.padding = '12px 24px';\n\t\t\telement.style.border = '2px solid #fff';\n\t\t\telement.style.borderRadius = '6px';\n\t\t\telement.style.background = 'rgba(0,0,0,0.7)';\n\t\t\telement.style.color = '#fff';\n\t\t\telement.style.font = '600 14px sans-serif';\n\t\t\telement.style.textAlign = 'center';\n\t\t\telement.style.opacity = '1.0';\n\t\t\telement.style.outline = 'none';\n\t\t\telement.style.zIndex = '999';\n\t\t\telement.style.cursor = 'pointer';\n\t\t\telement.style.transition = 'all 0.2s ease';\n\n\t\t}\n\n\t\tif ( 'xr' in navigator ) {\n\n\t\t\tvar button = document.createElement( 'button' );\n\t\t\tbutton.style.display = 'none';\n\n\t\t\tstylizeElement( button );\n\n\t\t\tnavigator.xr.isSessionSupported( 'immersive-vr' ).then( function ( supported ) {\n\n\t\t\t\tsupported ? showEnterVR() : showWebXRNotFound();\n\n\t\t\t} );\n\n\t\t\treturn button;\n\n\t\t} else {\n\n\t\t\tvar message = document.createElement( 'a' );\n\n\t\t\tif ( window.isSecureContext === false ) {\n\n\t\t\t\tmessage.href = document.location.href.replace( /^http:/, 'https:' );\n\t\t\t\tmessage.innerHTML = 'WEBXR NEEDS HTTPS'; // TODO Improve message\n\n\t\t\t} else {\n\n\t\t\t\tmessage.href = 'https://immersiveweb.dev/';\n\t\t\t\tmessage.innerHTML = 'WEBXR NOT AVAILABLE';\n\n\t\t\t}\n\n\t\t\tmessage.style.left = 'calc(50% - 90px)';\n\t\t\tmessage.style.width = '180px';\n\t\t\tmessage.style.textDecoration = 'none';\n\n\t\t\tstylizeElement( message );\n\n\t\t\treturn message;\n\n\t\t}\n\n\t}\n\n};\n\nexport { VRButton };\n","import * as THREE from 'three';\n\nconst PATH_TIME = 3; // 3 secs per path\n\nvar slideshow = {};\n\nslideshow.paths = [\n  //'hall'\n  [\n    {\n      from: new THREE.Vector3(0, 1.6, 0),\n      lookAt: new THREE.Vector3(0, 1, -100),\n      velocity: new THREE.Vector3(0, 0, -0.1),\n      angularVelocity: new THREE.Vector3(0.04, 0, 0)\n    },\n    {\n      from: new THREE.Vector3(4.5, 1.6, -3),\n      lookAt: new THREE.Vector3(100, 0, 0),\n      velocity: new THREE.Vector3(0, 0, -0.15),\n      angularVelocity: new THREE.Vector3(0, 0, 0)\n    },\n    {\n      from: new THREE.Vector3(0, 1.6, 0),\n      lookAt: new THREE.Vector3(50, 0, -40),\n      velocity: new THREE.Vector3(0, 0.12, 0),\n      angularVelocity: new THREE.Vector3(0, 0.1, 0)\n    },\n    {\n      from: new THREE.Vector3(3, 2.4, -4),\n      lookAt: new THREE.Vector3(-50, 0, 40),\n      velocity: new THREE.Vector3(0, -0.12, 0),\n      angularVelocity: new THREE.Vector3(0, -0.1, 0)\n    }\n  ],\n  //'sound'\n  [\n    {\n      from: new THREE.Vector3(0, 1.6, 0),\n      lookAt: new THREE.Vector3(0, 0, -100),\n      velocity: new THREE.Vector3(0.1, 0, 0.1),\n      angularVelocity: new THREE.Vector3(0, 0.01, 0)\n    },\n  ],\n  //'photogrammetry'\n  [\n    {\n      from: new THREE.Vector3(0, 1.2, 0.8),\n      lookAt: new THREE.Vector3(-100, 0.5, 0),\n      velocity: new THREE.Vector3(0, 0, -0.2),\n      angularVelocity: new THREE.Vector3(0, 0, 0)\n    },\n    {\n      from: new THREE.Vector3(-1, 1, -1.6),\n      lookAt: new THREE.Vector3(-40, 0, 100),\n      velocity: new THREE.Vector3(-0.05, 0, 0),\n      angularVelocity: new THREE.Vector3(0, 0, 0)\n    }\n  ],\n  //'vertigo'\n  [\n    {\n      from: new THREE.Vector3(0, 1.6, 0),\n      lookAt: new THREE.Vector3(0, 0, -10),\n      velocity: new THREE.Vector3(0, 0, 0),\n      angularVelocity: new THREE.Vector3(-0.01, 0.07, 0)\n    },\n    {\n      from: new THREE.Vector3(0, 1.6, -0.4),\n      lookAt: new THREE.Vector3(0, 0, 6),\n      velocity: new THREE.Vector3(0, 0, 0.1),\n      angularVelocity: new THREE.Vector3(0.07, 0, 0)\n    }\n  ],\n  //'panoramastereo'\n  [\n    {\n      from: new THREE.Vector3(0, 0, 0),\n      lookAt: new THREE.Vector3(-100, 0, 0),\n      velocity: new THREE.Vector3(0, 0, 0),\n      angularVelocity: new THREE.Vector3(0.03, 0.05, 0)\n    }\n  ],\n  //'panorama1'\n  [\n  ],\n  //'panorama2'\n  [\n      {\n      from: new THREE.Vector3(0, 0, 0),\n      lookAt: new THREE.Vector3(-100, 0, 0),\n      velocity: new THREE.Vector3(0, 0, 0),\n      angularVelocity: new THREE.Vector3(0.01, 0.1, 0)\n    }\n  ],\n  //'panorama3'\n  [\n  ],\n  //'panorama4'\n  [\n    {\n      from: new THREE.Vector3(0, 0, 0),\n      lookAt: new THREE.Vector3(-100, 0, 0),\n      velocity: new THREE.Vector3(0, 0, 0),\n      angularVelocity: new THREE.Vector3(-0.07, -0.05, 0)\n    }\n  ],\n  //'panorama5'\n  [\n    {\n      from: new THREE.Vector3(0, 0, 0),\n      lookAt: new THREE.Vector3(100, 0, 80),\n      velocity: new THREE.Vector3(0, 0, 0),\n      angularVelocity: new THREE.Vector3(0, -0.02, 0)\n    }\n  ]\n];\n\nslideshow.setup = function (context) {\n  this.room = undefined;\n  this.path = undefined;\n  this.next(context);\n  context.camera.position.set(0, 1.6, 0);\n  context.cameraRig.position.set(0, 0, 2);\n  context.goto = this.room;\n};\n\nslideshow.next = function (context) {\n  this.time = PATH_TIME + Math.random() * PATH_TIME / 2;\n  if (this.room === undefined) {\n    this.room = 0;\n    this.path = 0;\n  } else {\n    this.path ++;\n    if (this.path >= this.paths[this.room].length){\n      // find next room with paths\n      do {\n        this.room ++;\n        if (this.room >= this.paths.length) {\n          this.room = 0;\n          context.cameraRig.position.set(0, 0, 2);\n        }\n      } while (!this.paths[this.room].length);\n      var camera = context.renderer.xr.getCamera(context.camera);\n      camera.position.set(0, 1.6, 0);\n      context.goto = this.room;\n      this.path = 0;\n    }\n  }\n  this.reset = true;\n};\n\nslideshow.execute = function (context, delta, time) {\n  const path = this.paths[this.room][this.path];\n  if (this.reset) {\n    this.reset = false;\n    // init camera settings\n    context.camera.position.copy(path.from);\n    context.camera.rotation.set(0, 0, 0);\n    context.camera.lookAt(path.lookAt);\n  }\n  context.camera.position.addScaledVector(path.velocity, delta);\n  context.camera.rotation.x += path.angularVelocity.x * delta;\n  context.camera.rotation.y += path.angularVelocity.y * delta;\n  context.camera.rotation.z += path.angularVelocity.z * delta;\n  this.time -= delta;\n  if (this.time < 0) {\n    this.next(context);\n  }\n};\n\nexport {slideshow};\n","import * as THREE from 'three';\nimport { BasisTextureLoader } from 'three/examples/jsm/loaders/BasisTextureLoader.js';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader.js';\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js';\n\n//const BASIS_LIB_PATH = 'src/vendor/';\nconst BASIS_LIB_PATH = 'src/vendor/';\nconst DRACO_LIB_PATH = 'src/vendor/';\n\nfunction getLoadedCount(assets) {\n  let count = 0;\n  for (var i in assets) {\n    if (assets[i].loading !== true) { count ++; }\n  }\n  return count;\n}\n\nfunction allAssetsLoaded(assets) {\n  for (var i in assets) {\n    if (assets[i].loading === true) { return false; }\n  }\n  return true;\n}\n\nexport function loadAssets(renderer, basePath, assets, onComplete, onProgress, debug) {\n  if (basePath && basePath[basePath.length - 1] != '/') {\n    basePath += '/';\n  }\n\n  var basisLoader = new BasisTextureLoader();\n  basisLoader.setTranscoderPath(BASIS_LIB_PATH);\n  basisLoader.detectSupport(renderer);\n\n  var gltfLoader = new GLTFLoader();\n  var dracoLoader = new DRACOLoader();\n  dracoLoader.setDecoderPath(DRACO_LIB_PATH);\n  gltfLoader.setDRACOLoader(dracoLoader);\n\n  var texLoader = new THREE.TextureLoader();\n  var objLoader = new OBJLoader();\n  var fontLoader = new THREE.FontLoader();\n  var audioLoader = new THREE.AudioLoader();\n\n\n  var loaders = {\n    'gltf': gltfLoader,\n    'glb': gltfLoader,\n    'obj': objLoader,\n    'gif': texLoader,\n    'png': texLoader,\n    'jpg': texLoader,\n    'basis': basisLoader,\n    'font': fontLoader,\n    'ogg': audioLoader\n  };\n\n  for (var i in assets) {\n    let assetId = i;\n    let assetPath = assets[i].url;\n    assets[i].loading = true;\n    let ext = assetPath.substr(assetPath.lastIndexOf('.') + 1).toLowerCase();\n\n    loaders[ext].load(basePath + assetPath, asset => {\n      if (debug) {\n        console.info(`%c ${assetPath} loaded`, 'color:green');\n      }\n      var options = assets[assetId].options;\n      assets[assetId] = ext == 'font'? asset.data : asset;\n\n      if (typeof options !== \"undefined\") {\n        if (typeof options.repeat !== \"undefined\") {\n          assets[assetId].repeat.set(options.repeat[0], options.repeat[1]);\n          delete options.repeat;\n        }\n        for (let opt in options) {\n          assets[assetId][opt] = options[opt];\n        }\n\n        if (onProgress) { onProgress(getLoadedCount(assets)) };\n      }\n\n      if (onComplete && allAssetsLoaded(assets)) { onComplete(); }\n    }, () => {\n      /* on progress */\n    },\n    (e) => {\n      console.error('Error loading asset', assetPath, e);\n      // For audio files, set to null to allow graceful degradation\n      if (ext === 'ogg') {\n        assets[assetId] = null;\n        assets[assetId].loading = false;\n        if (onComplete && allAssetsLoaded(assets)) { onComplete(); }\n      }\n    }\n    );\n  }\n}\n","import * as THREE from 'three';\nimport {TagComponent} from 'ecsy';\n\nexport class Object3D {\n  constructor() {\n    this.value = null;\n  }\n\n  reset() {\n    this.value = null;\n  }\n}\n\nexport class Rotation {\n  constructor() {\n    this.rotation = new THREE.Vector3();\n  }\n\n  reset() {}\n}\n\nexport class Position {\n  constructor() {\n    this.position = new THREE.Vector3();\n  }\n\n  reset() {}\n}\n\nexport class ParentObject3D {\n  constructor() {\n    this.value = null;\n  }\n\n  reset() {\n    this.value = null;\n  }\n}\n\nexport class Text {\n  constructor() {\n    this.text = '';\n    this.textAlign = 'left'; // ['left', 'right', 'center']\n    this.anchor = 'center'; // ['left', 'right', 'center', 'align']\n    this.baseline = 'center'; // ['top', 'center', 'bottom']\n    this.color = '#FFF';\n    this.font = null;\n    this.fontSize = 0.2;\n    this.letterSpacing = 0;\n    this.lineHeight = 0;\n    this.maxWidth = Infinity;\n    this.overflowWrap = 'normal'; // ['normal', 'break-word']\n    this.whiteSpace = 'normal'; // ['normal', 'nowrap']\n    this.opacity = 1;\n  }\n\n  reset() {\n    this.text = '';\n  }\n}\n\nexport class BoundingBox {\n  constructor() {\n    this.min = new THREE.Vector3();\n    this.max = new THREE.Vector3();\n    // this.box3?\n  }\n\n  reset() {\n    this.min.set(0,0,0);\n    this.max.set(0,0,0);\n  }\n}\n\nexport class BoundingSphere {\n  constructor() {\n    this.debug = true;\n    this.center = new THREE.Vector3();\n    this.radius = 0;\n    //this.sphere?\n  }\n\n  reset() {\n    this.center.set(0,0,0);\n    this.radius = 0;\n  }\n}\n\nexport class Area {\n  constructor() {\n\n  }\n\n  reset() {\n\n  }\n}\n\nexport class AreaEntering extends TagComponent {}\nexport class AreaExiting extends TagComponent {}\nexport class AreaInside extends TagComponent {}\n\nexport class AreaChecker {\n  constructor() {\n\n  }\n\n  reset() {\n\n  }\n}\n\nconst empty = () => {};\n\nexport class AreaReactor {\n  constructor() {\n    this.reset();\n  }\n\n  reset() {\n    this.onEntering = empty;\n    this.onExiting = empty;\n  }\n}\n\nexport class DebugHelper extends TagComponent {}\n\nexport class Billboard {\n  constructor() {\n    this.camera3D = null;\n  }\n\n  reset() {\n    this.camera3D = null;\n  }\n}\n\nexport class Children {\n  constructor() {\n    this.value = [];\n  }\n\n  reset() {\n    this.value.array.length = 0;\n  }\n}\n\nexport class Opacity {\n  constructor() {\n    this.opacity = 0;\n  }\n\n  reset() {\n    this.opacity = 0;\n  }\n}\n","import * as THREE from 'three';\nimport {System} from 'ecsy';\nimport {TextMesh} from 'troika-3d-text/dist/textmesh-standalone.esm.js';\nimport {Object3D, Text} from '../components/index.js';\n\nconst anchorMapping = {\n  'left': 0,\n  'center': 0.5,\n  'right': 1\n}\nconst baselineMapping = {\n  'top': 0,\n  'center': 0.5,\n  'bottom': 1\n}\n\nexport class SDFTextSystem extends System {\n\n  updateText(textMesh, textComponent) {\n    textMesh.text = textComponent.text;\n    textMesh.textAlign = textComponent.textAlign;\n    textMesh.anchor[0] = anchorMapping[textComponent.anchor];\n    textMesh.anchor[1] = baselineMapping[textComponent.baseline];\n    textMesh.color = textComponent.color;\n    textMesh.font = textComponent.font;\n    textMesh.fontSize = textComponent.fontSize;\n    textMesh.letterSpacing = textComponent.letterSpacing || 0;\n    textMesh.lineHeight = textComponent.lineHeight || null;\n    textMesh.overflowWrap = textComponent.overflowWrap;\n    textMesh.whiteSpace = textComponent.whiteSpace;\n    textMesh.maxWidth = textComponent.maxWidth;\n    textMesh.material.opacity = textComponent.opacity;\n    textMesh.sync();\n  }\n\n  execute(delta, time) {\n    var entities = this.queries.entities;\n\n    entities.added.forEach(e => {\n      var textComponent = e.getComponent(Text);\n\n      const textMesh = new TextMesh();\n      textMesh.name = 'textMesh';\n      textMesh.anchor = [0, 0];\n      textMesh.renderOrder = 1; //brute-force fix for ugly antialiasing, see issue #67\n      this.updateText(textMesh, textComponent);\n      e.addComponent(Object3D, {value: textMesh});\n    });\n\n    entities.removed.forEach(e => {\n      var object3D = e.getComponent(Object3D).value;\n      var textMesh = object3D.getObjectByName('textMesh');\n      textMesh.dispose();\n      object3D.remove(textMesh);\n    });\n\n    entities.changed.forEach(e => {\n      var object3D = e.getComponent(Object3D).value;\n      if (object3D instanceof TextMesh) {\n        var textComponent = e.getComponent(Text);\n        this.updateText(object3D, textComponent);\n      }\n    });\n  }\n}\n\nSDFTextSystem.queries = {\n  entities: {\n    components: [Text],\n    listen: {\n      added: true,\n      removed: true,\n      changed: [Text]\n    }\n  }\n}\n","import {Object3D, DebugHelper, BoundingBox} from '../components/index.js';\nimport {System, SystemStateComponent, Not} from 'ecsy';\nimport * as THREE from 'three';\n\nTHREE.BoxHelper.prototype.setFromMinMax = function(min, max) {\n\tvar position = this.geometry.attributes.position;\n\tvar array = position.array;\n\n\tarray[ 0 ] = max.x; array[ 1 ] = max.y; array[ 2 ] = max.z;\n\tarray[ 3 ] = min.x; array[ 4 ] = max.y; array[ 5 ] = max.z;\n\tarray[ 6 ] = min.x; array[ 7 ] = min.y; array[ 8 ] = max.z;\n\tarray[ 9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\n\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\n\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\n\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\n\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\n\n\tposition.needsUpdate = true;\n\n\tthis.geometry.computeBoundingSphere();\n}\n\nclass DebugHelperMesh extends SystemStateComponent {\n  constructor() {\n    super();\n    this.boxHelper = new THREE.BoxHelper();\n  }\n}\n\nexport class DebugHelperSystem extends System {\n  execute(delta, time) {\n    this.queries.added.results.forEach(entity => {\n      entity.addComponent(DebugHelperMesh);\n      var boundingBox = entity.getComponent(BoundingBox);\n      let debugMesh = entity.getMutableComponent(DebugHelperMesh);\n      debugMesh.boxHelper.setFromMinMax(boundingBox.min, boundingBox.max);\n\n      entity.addComponent(Object3D, {value: debugMesh.boxHelper});\n    });\n\n    this.queries.removed.results.forEach(entity => {\n      //var boundingBox = entity.getComponent(DebugHelperMesh);\n      entity.removeComponent(Object3D).removeComponent(DebugHelperMesh);\n\n/*\n      entity.addComponent(Object3D, {value: debugMesh.boxHelper});\n\n      let debugMesh = entity.getMutableComponent(DebugHelperMesh);\n      debugMesh.boxHelper.setFromMinMax(boundingBox.min, boundingBox.max);\n      entity.addComponent(Object3D, {value: debugMesh.boxHelper});\n*/\n    });\n  }\n}\n\nDebugHelperSystem.queries = {\n  added: {\n    components: [DebugHelper, Not(DebugHelperMesh)]\n  },\n  removed: {\n    components: [Not(DebugHelper), DebugHelperMesh]\n  }\n}\n","import * as THREE from 'three';\nimport {System} from 'ecsy';\nimport {Area, AreaInside, AreaExiting, AreaEntering, Object3D, AreaChecker, BoundingBox} from '../components/index.js';\n\nexport class AreaCheckerSystem extends System {\n  execute(delta, time) {\n    const areas = this.queries.areas.results;\n    const checkers = this.queries.checkers.results;\n\n    for (let i = 0; i < areas.length; i++) {\n      const area = areas[i];\n      const bboxArea = area.getComponent(BoundingBox);\n\n      for (let j = 0; j < checkers.length; j++) {\n        const checker = checkers[j];\n        const obj3D = checker.getComponent(Object3D).value;\n        if (obj3D.boundingBox.intersectsBox(bboxArea)) {\n          checker.addComponent(AreaInside);\n        } else {\n          checker.removeComponent(AreaInside);\n        }\n      }\n    }\n  }\n}\n\nAreaCheckerSystem.queries = {\n  areas: {\n    components: [Area, BoundingBox],\n  },\n  checkers: {\n    components: [AreaChecker, Object3D]\n  }\n}","import * as THREE from 'three';\nimport {System} from 'ecsy';\nimport {Area, AreaReactor, AreaInside, AreaExiting, AreaEntering, Object3D, AreaChecker, BoundingBox} from '../components/index.js';\n\nexport class ControllersSystem extends System {\n  execute(delta, time) {\n    const added = this.queries.checkers.added;\n    const removed = this.queries.checkers.removed;\n\n    for (let i = 0; i < added.length; i++) {\n      const entity = added[i];\n      const reactor = entity.getComponent(AreaReactor);\n      reactor.onEntering(entity);\n    }\n\n    for (let i = 0; i < removed.length; i++) {\n      const entity = removed[i];\n      const reactor = entity.getComponent(AreaReactor);\n      reactor.onExiting(entity);\n    }\n  }\n}\n\nControllersSystem.queries = {\n  checkers: {\n    components: [AreaChecker, Object3D, AreaInside],\n    listen: {\n      added: true,\n      removed: true\n    }\n  }\n}\n","import * as THREE from 'three';\nimport {System} from 'ecsy';\nimport {Object3D, ParentObject3D} from '../components/index.js';\n\nexport default class HierarchySystem extends System {\n  execute(delta, time) {\n    this.queries.entities.added.forEach(entity => {\n      const parent = entity.getComponent(ParentObject3D).value;\n      const object = entity.getComponent(Object3D).value;\n\n      parent.add(object);\n    });\n\n    this.queries.entities.changed.forEach(entity => {\n      const parent = entity.getComponent(ParentObject3D).value;\n      const object = entity.getComponent(Object3D).value;\n\n      parent.add(object);\n    });\n\n    this.queries.entities.removed.forEach(entity => {\n      const parent = entity.getComponent(ParentObject3D, true).value;\n      parent.remove(entity.getComponent(Object3D, true).value);\n    });\n  }\n}\n\nHierarchySystem.queries = {\n  entities: {\n    components: [Object3D, ParentObject3D],\n    listen: {\n      added: true,\n      removed: true,\n      changed: true // [Component]\n    }\n  }\n}\n","import {System} from 'ecsy';\nimport {Object3D, Rotation, Position} from '../components/index.js';\n\nlet updateRotation = entity => {\n  const rotation = entity.getComponent(Rotation);\n  const object3D = entity.getComponent(Object3D).value;\n  object3D.rotation.set(rotation.x, rotation.y, rotation.z);\n};\n\nlet updatePosition = entity => {\n  const position = entity.getComponent(Position);\n  const object3D = entity.getComponent(Object3D).value;\n  object3D.position.copy(position);\n};\n\nexport default class TransformSystem extends System {\n  execute(delta, time) {\n    // Position\n    this.queries.position.added.forEach(updatePosition);\n    this.queries.position.changed.forEach(updatePosition);\n\n    // Rotation\n    this.queries.rotation.added.forEach(updateRotation);\n    this.queries.rotation.changed.forEach(updateRotation);\n  }\n}\n\nTransformSystem.queries = {\n  position: {\n    components: [Position, Object3D],\n    listen: {\n      added: true,\n      changed: true\n    }\n  },\n  rotation: {\n    components: [Rotation, Object3D],\n    listen: {\n      added: true,\n      changed: true\n    }\n  }\n}","import * as THREE from 'three';\nimport {System} from 'ecsy';\nimport {Billboard, Object3D, Children, Text, Position} from '../components/index.js';\n\nconst SHOW_DISTANCE = 4;\n\nvar cameraPosition = new THREE.Vector3();\n\nexport default class BillboardSystem extends System {\n  execute(delta, time) {\n\n    window.context.camera.getWorldPosition(cameraPosition);\n\n    this.queries.entities.results.forEach(entity => {\n      const object3D = entity.getComponent(Object3D).value;\n      const distance = cameraPosition.distanceTo(object3D.position);\n      let opacity = 0;\n\n      if (distance < SHOW_DISTANCE){\n        opacity = THREE.Math.clamp(Math.sqrt(SHOW_DISTANCE - distance), 0, 1);\n        object3D.lookAt(cameraPosition);\n      }\n\n      object3D.material.opacity = opacity;\n      // panels text parent\n      if (entity.hasComponent(Children)) {\n        entity.getComponent(Children).value.forEach(children => {\n          let prevOpacity = children.getComponent(Text).opacity;\n          if (prevOpacity !== opacity) {\n            children.getMutableComponent(Text).opacity = opacity;\n          }\n        });\n      }\n    });\n  }\n}\n\nBillboardSystem.queries = {\n  entities: {\n    components: [Billboard, Object3D]\n  }\n}\n","export default class SystemsGroup {\n  constructor(world, Systems) {\n    this.Systems = Systems;\n    this.world = world;\n  }\n\n  play() {\n    this.Systems.forEach(System => this.world.getSystem(System).play());\n  }\n\n  stop() {\n    this.Systems.forEach(System => this.world.getSystem(System).stop());\n  }\n}","import * as THREE from 'three';\n\nexport default {\n  // Shared door texture (used by all learning rooms)\n  doorfx_tex: { url: 'doorfx.basis', options: { wrapT: THREE.RepeatWrapping, wrapS: THREE.RepeatWrapping } },\n\n  // Controller assets\n  generic_controller_model: { url: 'generic_controller.glb' },\n  controller_tex: { url: 'controller.basis' },\n\n  // Teleport assets\n  teleport_model: { url: 'teleport.glb' },\n  glow_tex: { url: 'glow.basis', options: { encoding: THREE.sRGBEncoding } },\n  beam_tex: { url: 'beamfx.png' },\n\n  // Teleport sounds - disabled due to browser compatibility issues\n  // teleport_a_snd: { url: 'ogg/teleport_a.ogg' },\n  // teleport_b_snd: { url: 'ogg/teleport_b.ogg' },\n};\n","import * as THREE from 'three';\nimport EventDispatcher from './EventDispatcher.js';\n\nvar tempMatrix = new THREE.Matrix4();\nexport var rayMaterial;\nconst validStateController = [\n  \"primary\",\n  \"secondary\",\n  \"both\",\n  \"left\",\n  \"right\"\n];\n\nexport default class RayControl extends EventDispatcher {\n  enable() {\n    this.setLineStyle(this.previousLineStyle);\n    this.enabled = true;\n  }\n\n  _sort() {\n    this.currentStates = this.currentStates.sort((a,b) => {\n      let pa = a.order || 0;\n      let pb = b.order || 0;\n      return pa - pb;\n    });\n  }\n\n  disable() {\n    this.lineBasic.visible = this.line0.visible = false;\n    this.enabled = false;\n    this.controllers.forEach(controller => controller.active = false);\n  }\n\n  changeHandedness(primary) {\n    if (primary !== this.primary) {\n      this.primary = primary;\n      this.secondary = primary === \"right\" ? \"left\" : \"right\";\n\n      this.dispatchEvent(\"handednessChanged\", {primary: this.primary, secondary: this.secondary});\n    }\n  }\n\n  addState(name, state, activate) {\n    if (this.states[name]) {\n      console.error(`RayControl state '${name}' already exist, please use a different name.`);\n      return;\n    }\n\n    state.name = name;\n\n    if (typeof state.raycaster === \"undefined\") {\n      state.raycaster = true;\n    }\n\n    if (typeof state.controller === \"undefined\") {\n      state.controller = \"primary\";\n    } else if (!validStateController.includes(state.controller)) {\n      console.warn(\"Invalid controller selector:\", state.controller);\n      state.controller = \"primary\";\n    }\n\n    this.states[name] = state;\n\n    if (activate === true) {\n      this.currentStates.push(state);\n    }\n\n    return state;\n  }\n\n  activateState(name) {\n    if (this.states[name]) {\n      this.currentStates.push(this.states[name]);\n      this._sort();\n    }\n  }\n\n  deactivateAll(name) {\n    this.currentStates = [];\n    this.controllers.forEach(c => {\n      this.currentStates.forEach(s => {\n        if (c.intersections[s.name]) {\n          c.intersections[s.name] = null;\n        }\n      });\n    });\n  }\n\n  deactivateState(name) {\n    this.currentStates.splice(this.currentStates.indexOf(name), 1);\n    this.controllers.forEach(c => {\n      if (c.intersections[name]) {\n        c.intersections[name] = null;\n      }\n    });\n\n    this._sort();\n  }\n\n  addController(controller, inputSource) {\n    let controllerData = {\n      controller: controller,\n      inputSource: inputSource,\n      active: false,\n      stateHit: {},\n      intersections: {},\n      currentIntersection: null,\n      hit: false\n    };\n\n    this.controllers.push(controllerData);\n\n    if (this.matchController(controllerData, \"primary\")) {\n      controller.add( this.raycasterContext );\n    }\n\n    this.dispatchEvent(\"controllerConnected\", controllerData);\n  }\n\n  removeController(controller) {\n    const index = this.controllers.findIndex(controllerData => controllerData.controller === controller);\n    const controllerData = this.controllers.find(controllerData => controllerData.controller === controller)\n    this.controllers.splice(index, 1);\n    this.dispatchEvent(\"controllerDisconnected\", controllerData);\n  }\n\n  constructor(ctx, primary) {\n    super();\n    this.ctx = ctx;\n\n    if (typeof primary === \"undefined\") {\n      this.primary = \"right\";\n      this.secondary = \"left\";\n    } else {\n      this.primary = primary;\n      this.secondary = primary === \"right\" ? \"left\" : \"right\";\n    }\n\n    this.controllers = [];\n\n    this.previousLineStyle = 'pretty';\n    this.enabled = true;\n    this.raycaster = new THREE.Raycaster();\n    this.states = {};\n    this.currentStates = [];\n\n    var line = ctx.assets['teleport_model'].scene.getObjectByName('beam');\n\n    ctx.assets['beam_tex'].wrapT = THREE.RepeatWrapping;\n    ctx.assets['beam_tex'].wrapS = THREE.RepeatWrapping;\n    rayMaterial = line.material = new THREE.ShaderMaterial({\n      uniforms: {\n        time: {value: 0},\n        active: {value: 0},\n        tex: {value: ctx.assets['beam_tex']}\n      },\n      vertexShader: ctx.shaders.basic_vert,\n      fragmentShader: ctx.shaders.beam_frag,\n      blending: THREE.AdditiveBlending,\n      transparent: true\n    });\n\n    line.renderOrder = 10;\n\n    line.name = 'line';\n    this.rayLength = 5;\n    line.scale.z = this.rayLength;\n\n    this.line0 = line.clone();\n    this.line0.visible = true;\n\n    this.raycasterContext = new THREE.Group();\n    this.raycasterContext.add(this.line0);\n    this.raycasterContext.name = 'raycasterContext';\n\n    var geometry = new THREE.BufferGeometry().setFromPoints( [ new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 0, 0, - 1 ) ] );\n\n    this.lineBasic = new THREE.Line( geometry );\n    this.lineBasic.name = 'line';\n    this.lineBasic.scale.z = 5;\n    this.lineBasic.visible = false;\n    this.raycasterContext.add(this.lineBasic);\n  }\n\n  setLineStyle(lineStyle) {\n    const basic = lineStyle === 'basic';\n    this.lineBasic.visible = basic;\n    this.line0.visible = !basic;\n    this.previousLineStyle = lineStyle;\n  }\n\n  /*\n  selector could be: left, right, both, primary, secondary\n  */\n  matchController(controllerData, selector) {\n    const handedness = controllerData.inputSource.handedness;\n\n    return (\n      (selector === handedness)  ||\n      (selector === \"both\" && (handedness === \"right\" || handedness === \"left\")) ||\n      (selector === \"primary\" && this.primary === handedness) ||\n      (selector === \"secondary\" && this.secondary === handedness)\n    );\n  }\n\n  onSelectStart(evt) {\n    if (!this.enabled) { return; }\n\n    let controller = evt.target;\n    let controllerData = this.controllers.find(c => c.controller === controller);\n    if (controllerData) {\n      controllerData.active = true;\n      if (controllerData.currentIntersection) {\n        const state = controllerData.currentIntersection.state;\n        if (state.onSelectStart) {\n          state.onSelectStart(controllerData.currentIntersection.intersection, controllerData.controller);\n        }\n      }\n\n      // Check no raycaster states\n      this.currentStates.forEach(state => {\n        if (state.onSelectStart && !state.raycaster) {\n          state.onSelectStart(controllerData.intersections[state.name], controller);\n        }\n      });\n    }\n  }\n\n  execute(ctx, delta, time) {\n    if (!this.enabled || this.currentStates.length === 0) { return; }\n\n    rayMaterial.uniforms.time.value = time;\n\n    let firstHit = false;\n\n    var stateIntersections = {};\n    for (var c = 0; c < this.controllers.length; c++) {\n      let controllerData = this.controllers[c];\n\n      for (var i = 0; i < this.currentStates.length; i++) {\n        let state = this.currentStates[i];\n        if (!state.raycaster) {\n          continue;\n        }\n\n        // Check if this controller should be active on this state\n        if (!this.matchController(controllerData, state.controller)) {\n          continue;\n        }\n\n        let controller = controllerData.controller;\n        let active = controllerData.active;\n        let intersections = this.getIntersections(controller, state.colliderMesh);\n\n        if (intersections.length > 0) {\n          // Use just the closest object\n          controllerData.intersections[state.name] = intersections[0];\n          controllerData.stateHit[state.name] = true;\n        } else {\n          controllerData.intersections[state.name] = null;\n        }\n      }\n    }\n\n    this.line0.scale.z = Math.min(this.rayLength, 1);\n    this.lineBasic.scale.z = Math.min(this.rayLength, 1);\n\n    // For each controller, find the closest intersection from all the states\n    for (var c = 0; c < this.controllers.length; c++) {\n      let controllerData = this.controllers[c];\n      let intersections = Object.entries(controllerData.intersections).filter(i => i[1] !== null);\n      if (intersections.length > 0) {\n\n        intersections.sort((a,b) => {\n          return a[1].distance - b[1].distance;\n        });\n\n        const intersectionData = intersections[0];\n        const intersection = intersectionData[1];\n        const state = this.states[intersectionData[0]];\n\n        controllerData.prevIntersection = controllerData.currentIntersection;\n        controllerData.currentIntersection = {\n          state, intersection\n        };\n\n        if (state.lineStyleOnIntersection) {\n          this.setLineStyle(state.lineStyleOnIntersection);\n        } else {\n          this.setLineStyle('advanced');\n        }\n\n        state.onHover && state.onHover(intersection, controllerData.active, controllerData.controller);\n        this.line0.scale.z = Math.min(intersection.distance, 1);\n        this.lineBasic.scale.z = Math.min(intersection.distance, 1);\n      } else {\n        controllerData.currentIntersection = null;\n      }\n    }\n\n    // Handle onHoverLeave\n    for (var c = 0; c < this.controllers.length; c++) {\n      let controllerData = this.controllers[c];\n      if (!controllerData.prevIntersection) {\n        continue;\n      }\n\n      // If we can't find the previous intersection currently enabled, we should emit hoverLeave\n      if (!this.controllers.find(c => {\n        let prev = controllerData.prevIntersection;\n        let current = c.currentIntersection;\n        return current && prev.state.name === current.state.name &&\n          prev.intersection.object === current.intersection.object;\n      }\n        )) {\n        controllerData.prevIntersection.state.onHoverLeave(\n          controllerData.prevIntersection.intersection,\n          false,\n          controllerData.controller\n        );\n\n        controllerData.prevIntersection = null;\n      }\n    }\n  }\n\n  getIntersections( controller, colliderMesh ) {\n    let raycasterContext = controller.getObjectByName('raycasterContext');\n    if (!raycasterContext) {\n      console.warn('No raycasterContext found for this controller', controller);\n      return [];\n    }\n\n    tempMatrix.identity().extractRotation( raycasterContext.matrixWorld );\n\n    this.raycaster.ray.origin.setFromMatrixPosition( raycasterContext.matrixWorld );\n    this.raycaster.ray.direction.set( 0, 0, - 1 ).applyMatrix4( tempMatrix );\n\n    if (Array.isArray(colliderMesh)) {\n      return this.raycaster.intersectObjects( colliderMesh, true);\n    } else {\n      return this.raycaster.intersectObject( colliderMesh, true);\n    }\n  }\n\n  onSelectEnd(evt) {\n    if (!this.enabled) { return; }\n\n    let controllerData = this.controllers.find(c => c.controller === evt.target)\n    if (!controllerData || !controllerData.active) { return; }\n\n    if (controllerData) {\n      if (controllerData.currentIntersection) {\n        const state = controllerData.currentIntersection.state;\n        if (state.onSelectEnd) {\n          state.onSelectEnd(controllerData.currentIntersection.intersection, controllerData.controller);\n        }\n      }\n\n      // Check no raycaster states\n      this.currentStates.forEach(state => {\n        if (state.onSelectEnd && !state.raycaster) {\n          state.onSelectEnd(null, controllerData.controller);\n        }\n      });\n    }\n\n    controllerData.active = false;\n  }\n}\n","/**\n * @private\n * @class EventDispatcher\n */\nexport default class EventDispatcher {\n  constructor() {\n    this._listeners = {};\n    this.stats = {\n      fired: 0,\n      handled: 0\n    };\n  }\n\n  /**\n   * Add an event listener\n   * @param {String} eventName Name of the event to listen\n   * @param {Function} listener Callback to trigger when the event is fired\n   */\n  addEventListener(eventName, listener) {\n    let listeners = this._listeners;\n    if (listeners[eventName] === undefined) {\n      listeners[eventName] = [];\n    }\n\n    if (listeners[eventName].indexOf(listener) === -1) {\n      listeners[eventName].push(listener);\n    }\n  }\n\n  /**\n   * Check if an event listener is already added to the list of listeners\n   * @param {String} eventName Name of the event to check\n   * @param {Function} listener Callback for the specified event\n   */\n  hasEventListener(eventName, listener) {\n    return (\n      this._listeners[eventName] !== undefined &&\n      this._listeners[eventName].indexOf(listener) !== -1\n    );\n  }\n\n  /**\n   * Remove an event listener\n   * @param {String} eventName Name of the event to remove\n   * @param {Function} listener Callback for the specified event\n   */\n  removeEventListener(eventName, listener) {\n    var listenerArray = this._listeners[eventName];\n    if (listenerArray !== undefined) {\n      var index = listenerArray.indexOf(listener);\n      if (index !== -1) {\n        listenerArray.splice(index, 1);\n      }\n    }\n  }\n\n  /**\n   * Dispatch an event\n   * @param {String} eventName Name of the event to dispatch\n   * @param {Data} data to eit\n   */\n  dispatchEvent(eventName, data) {\n    this.stats.fired++;\n\n    var listenerArray = this._listeners[eventName];\n    if (listenerArray !== undefined) {\n      var array = listenerArray.slice(0);\n\n      for (var i = 0; i < array.length; i++) {\n        array[i].call(this, data);\n      }\n    }\n  }\n\n  /**\n   * Reset stats counters\n   */\n  resetCounters() {\n    this.stats.fired = this.stats.handled = 0;\n  }\n}\n","import {rayMaterial} from \"./RayControl.js\";\nimport * as THREE from 'three';\n\nvar tempMatrix = new THREE.Matrix4();\nvar intersected = [];\n\nexport default class Teleport {\n  constructor(ctx, mesh) {\n    this.ctx = ctx;\n\n    // Holder for all the\n    this.teleportEntity = new THREE.Group();\n\n    this.active = false;\n\n    this.teleportHitGeometry = ctx.assets['teleport_model'].scene.getObjectByName('goal');\n    this.teleportHitGeometry.material = rayMaterial;\n\n    this.teleportHitGeometry.renderOrder = 10;\n\n    this.ballColliding = ctx.assets['teleport_model'].scene.getObjectByName('glow');\n    this.ballColliding.material = new THREE.MeshBasicMaterial({\n      color: 0x00257b,\n      map: ctx.assets['glow_tex'],\n      transparent: true,\n      blending: THREE.AdditiveBlending\n    });\n\n    this.ballColliding.renderOrder = 10;\n\n\n    this.ballColliding.visible = false;\n\n    this.teleportEntity.add(this.ballColliding);\n\n    this.teleportHitGeometry.visible = false;\n\n    this.teleportHitGeometry.position.set(-2, 0, -2);\n\n    this.teleportEntity.add(this.teleportHitGeometry);\n\n    this.ctx.scene.add(this.teleportEntity);\n\n    // sounds\n    try {\n      this.startSound = new THREE.Audio(ctx.audioListener);\n      this.startSound.setBuffer(ctx.assets['teleport_a_snd']);\n      this.startSound.setLoop(true);\n      this.startSound.pause();\n    } catch (e) {\n      console.warn('Failed to initialize start sound:', e);\n      this.startSound = null;\n    }\n\n    try {\n      this.endSound = new THREE.Audio(ctx.audioListener);\n      this.endSound.setBuffer(ctx.assets['teleport_b_snd']);\n      this.endSound.setLoop(false);\n      this.endSound.pause();\n    } catch (e) {\n      console.warn('Failed to initialize end sound:', e);\n      this.endSound = null;\n    }\n  }\n\n\n  onSelectStart(evt) {\n    //if (evt.target === this.ctx.controllers[0])\n    this.active = true;\n    if (this.endSound) this.endSound.pause();\n    if (this.startSound) this.startSound.play();\n  }\n\n  onHoverLeave() {\n    this.ballColliding.visible = false;\n    this.teleportHitGeometry.visible = false;\n    if (this.startSound) this.startSound.pause();\n  }\n\n  onHover(hitPoint, active) {\n    if (active) {\n      this.teleportHitGeometry.visible = true;\n      this.teleportHitGeometry.position.copy(hitPoint);\n      this.hit = true;\n      this.ballColliding.visible = false;\n    } else {\n      this.ballColliding.visible = true;\n      this.ballColliding.position.copy(hitPoint);\n    }\n  }\n\n  onSelectEnd(targetPoint) {\n    const headPosition = this.ctx.renderer.xr.getCamera(this.ctx.camera).position;\n    const offset = targetPoint.sub(headPosition);\n    offset.y = 0; // We don't want to change height to floor's level\n\n    this.ctx.cameraRig.position.add(offset);\n    this.teleportHitGeometry.visible = false;\n\n    this.active = false;\n\n    if (this.startSound) this.startSound.pause();\n    if (this.endSound) this.endSound.play();\n  }\n}\n\n","import * as THREE from 'three';\nimport { Text, Position, ParentObject3D, Object3D, Children } from '../components/index.js';\n\nvar scene, doorMaterial, doors = [], infoPanels = [], textEntities = [];\n\nconst WEBXR_ELEMENTS = [\n  {\n    id: 'controllers',\n    name: 'VR Controllers',\n    description: 'Learn how VR controllers provide 6DOF (6 Degrees of Freedom) input tracking',\n    color: 0x4a90e2,\n    icon: ''\n  },\n  {\n    id: 'teleport',\n    name: 'Teleportation',\n    description: 'Move through VR spaces using ray-casting and point-to-click navigation',\n    color: 0x50e3c2,\n    icon: ''\n  },\n  {\n    id: 'models',\n    name: '3D Models',\n    description: 'Display and interact with 3D content in VR: glTF, DRACO compression, materials',\n    color: 0xf5a623,\n    icon: ''\n  },\n  {\n    id: 'audio',\n    name: 'Spatial Audio',\n    description: 'Positional audio that creates immersive 3D soundscapes',\n    color: 0xe056fd,\n    icon: ''\n  },\n  {\n    id: 'interaction',\n    name: 'Ray Control',\n    description: 'Interact with objects using laser pointers and grab mechanics',\n    color: 0xff6b6b,\n    icon: ''\n  }\n];\n\nfunction createDoorMaterial(ctx, color) {\n  return new THREE.ShaderMaterial({\n    uniforms: {\n      time: {value: 0},\n      selected: {value: 0},\n      tex: {value: ctx.assets['doorfx_tex']},\n      doorColor: {value: new THREE.Color(color)}\n    },\n    vertexShader: ctx.shaders.basic_vert,\n    fragmentShader: ctx.shaders.door_frag\n  });\n}\n\nfunction createInfoPanel(element, index, total) {\n  const group = new THREE.Group();\n\n  // Calculate position around the room\n  const angle = (index / total) * Math.PI * 2;\n  const radius = 6;\n  const x = Math.cos(angle) * radius;\n  const z = Math.sin(angle) * radius;\n\n  // Panel base\n  const panelGeo = new THREE.BoxGeometry(2.5, 1.8, 0.1);\n  const panelMat = new THREE.MeshBasicMaterial({color: 0x2a2a3a});\n  const panel = new THREE.Mesh(panelGeo, panelMat);\n  panel.position.set(x, 1.5, z);\n  panel.lookAt(0, 1.5, 0);\n  group.add(panel);\n\n  // Title plate\n  const titleGeo = new THREE.PlaneGeometry(2.3, 0.4);\n  const titleMat = new THREE.MeshBasicMaterial({color: element.color});\n  const titlePlate = new THREE.Mesh(titleGeo, titleMat);\n  titlePlate.position.set(0, 0.6, 0.06);\n  titlePlate.name = `titlePlate_${element.id}`;\n  panel.add(titlePlate);\n\n  // Description background\n  const descGeo = new THREE.PlaneGeometry(2.3, 1.0);\n  const descMat = new THREE.MeshBasicMaterial({color: 0x1a1a2a});\n  const descPlate = new THREE.Mesh(descGeo, descMat);\n  descPlate.position.set(0, -0.2, 0.06);\n  descPlate.name = `descPlate_${element.id}`;\n  panel.add(descPlate);\n\n  // Pedestal\n  const pedestalGeo = new THREE.BoxGeometry(1.5, 0.6, 1.5);\n  const pedestalMat = new THREE.MeshBasicMaterial({color: 0x1a1a2a});\n  const pedestal = new THREE.Mesh(pedestalGeo, pedestalMat);\n  pedestal.position.set(x, 0.3, z);\n  group.add(pedestal);\n\n  // Icon placeholder (simple geometric shape representing element)\n  const iconGeo = new THREE.SphereGeometry(0.3, 16, 16);\n  const iconMat = new THREE.MeshBasicMaterial({color: element.color});\n  const icon = new THREE.Mesh(iconGeo, iconMat);\n  icon.position.set(x, 0.9, z);\n  group.add(icon);\n\n  // Animate icon floating\n  icon.userData.baseY = 0.9;\n  icon.userData.offset = Math.random() * Math.PI * 2;\n\n  return { group, icon, panel, position: new THREE.Vector3(x, 0, z) };\n}\n\nfunction createDoor(ctx, element, index, total) {\n  const angle = (index / total) * Math.PI * 2;\n  const radius = 7.5;\n  const x = Math.cos(angle) * radius;\n  const z = Math.sin(angle) * radius;\n\n  const doorGeo = new THREE.BoxGeometry(1.5, 2.5, 0.1);\n  const doorMat = createDoorMaterial(ctx, element.color);\n  const door = new THREE.Mesh(doorGeo, doorMat);\n  door.position.set(x, 1.25, z);\n  door.lookAt(0, 1.25, 0);\n  door.name = element.id;\n  door.userData.elementId = index + 1; // Room numbers start from 1\n\n  // Door frame\n  const frameGeo = new THREE.BoxGeometry(1.7, 2.7, 0.08);\n  const frameMat = new THREE.MeshBasicMaterial({color: 0x1a1a1a});\n  const frame = new THREE.Mesh(frameGeo, frameMat);\n  frame.position.copy(door.position);\n  frame.position.z += (z < 0 ? -0.05 : 0.05);\n  frame.position.x += (x < 0 ? -0.05 : 0.05);\n  frame.lookAt(0, 1.25, 0);\n\n  return { door, frame };\n}\n\nexport function setup(ctx) {\n  scene = new THREE.Scene();\n\n  // Floor - large circular platform\n  const floorGeo = new THREE.CylinderGeometry(10, 10, 0.2, 64);\n  const floorMat = new THREE.MeshBasicMaterial({color: 0x1a1a2e});\n  const floor = new THREE.Mesh(floorGeo, floorMat);\n  floor.position.y = -0.1;\n  scene.add(floor);\n\n  // Center platform\n  const centerGeo = new THREE.CylinderGeometry(3, 3, 0.3, 32);\n  const centerMat = new THREE.MeshBasicMaterial({color: 0x2a2a4a});\n  const center = new THREE.Mesh(centerGeo, centerMat);\n  center.position.y = 0.15;\n  scene.add(center);\n\n  // Center title column\n  const columnGeo = new THREE.CylinderGeometry(0.5, 0.6, 3, 16);\n  const columnMat = new THREE.MeshBasicMaterial({color: 0x3a3a5a});\n  const column = new THREE.Mesh(columnGeo, columnMat);\n  column.position.y = 1.5;\n  scene.add(column);\n\n  // Info panels for each element\n  WEBXR_ELEMENTS.forEach((element, index) => {\n    const { group, icon, panel } = createInfoPanel(element, index, WEBXR_ELEMENTS.length);\n    scene.add(group);\n    infoPanels.push({ icon, element, panel });\n\n    // Add text labels to the panel\n    const titlePlate = panel.getObjectByName(`titlePlate_${element.id}`);\n    const descPlate = panel.getObjectByName(`descPlate_${element.id}`);\n\n    // Create title text entity\n    if (titlePlate) {\n      const titleTextEntity = ctx.world.createEntity();\n      titleTextEntity\n        .addComponent(Text, {\n          text: `${element.icon} ${element.name}`,\n          color: '#ffffff',\n          fontSize: 0.08,\n          anchor: 'center',\n          baseline: 'middle',\n          textAlign: 'center'\n        })\n        .addComponent(ParentObject3D, {value: titlePlate})\n        .addComponent(Position, {x: 0, y: 0, z: 0.01});\n\n      // Create title parent entity\n      const titleParentEntity = ctx.world.createEntity();\n      titleParentEntity\n        .addComponent(Object3D, {value: titlePlate})\n        .addComponent(Children, {value: [titleTextEntity]});\n\n      textEntities.push(titleTextEntity);\n    }\n\n    // Create description text entity\n    if (descPlate) {\n      const descTextEntity = ctx.world.createEntity();\n      descTextEntity\n        .addComponent(Text, {\n          text: element.description,\n          color: '#cccccc',\n          fontSize: 0.045,\n          anchor: 'center',\n          baseline: 'top',\n          textAlign: 'center',\n          maxWidth: 2.1,\n          lineHeight: 1.4\n        })\n        .addComponent(ParentObject3D, {value: descPlate})\n        .addComponent(Position, {x: 0, y: 0.45, z: 0.01});\n\n      // Create description parent entity\n      const descParentEntity = ctx.world.createEntity();\n      descParentEntity\n        .addComponent(Object3D, {value: descPlate})\n        .addComponent(Children, {value: [descTextEntity]});\n\n      textEntities.push(descTextEntity);\n    }\n\n    // Create door for this element\n    const { door, frame } = createDoor(ctx, element, index, WEBXR_ELEMENTS.length);\n    scene.add(door);\n    scene.add(frame);\n    doors.push(door);\n  });\n\n  // Ceiling dome\n  const domeGeo = new THREE.SphereGeometry(10, 32, 16, 0, Math.PI * 2, 0, Math.PI / 2);\n  const domeMat = new THREE.MeshBasicMaterial({\n    color: 0x0a0a1a,\n    side: THREE.DoubleSide\n  });\n  const dome = new THREE.Mesh(domeGeo, domeMat);\n  scene.add(dome);\n\n  // Ambient lights\n  const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);\n  scene.add(ambientLight);\n\n  // Point lights for atmosphere\n  const light1 = new THREE.PointLight(0x4a90e2, 0.5, 10);\n  light1.position.set(5, 3, 0);\n  scene.add(light1);\n\n  const light2 = new THREE.PointLight(0xe056fd, 0.5, 10);\n  light2.position.set(-5, 3, 0);\n  scene.add(light2);\n\n  // Teleport floor (invisible)\n  const teleportGeo = new THREE.PlaneBufferGeometry(20, 20);\n  const teleportMat = new THREE.MeshBasicMaterial({visible: false});\n  const teleport = new THREE.Mesh(teleportGeo, teleportMat);\n  teleport.rotation.x = -Math.PI / 2;\n  teleport.position.y = 0.001;\n  scene.add(teleport);\n\n  // Store for execute\n  scene.userData.teleport = teleport;\n  scene.userData.infoPanels = infoPanels;\n  scene.userData.doorMaterials = doors.map(d => d.material);\n\n  // Add door interaction state\n  ctx.raycontrol.addState('landingDoors', {\n    colliderMesh: doors,\n    onHover: (intersection, active) => {\n      const door = intersection.object;\n      door.scale.z = Math.min(door.scale.z + 0.05 * (2 - door.scale.z), 2);\n    },\n    onHoverLeave: (intersection) => {},\n    onSelectStart: (intersection, e) => {\n      ctx.goto = intersection.object.userData.elementId;\n    },\n    onSelectEnd: (intersection) => {}\n  });\n\n  // Add teleport interaction state\n  ctx.raycontrol.addState('landingTeleport', {\n    colliderMesh: teleport,\n    onHover: (intersection, active) => {\n      ctx.teleport.onHover(intersection.point, active);\n    },\n    onHoverLeave: () => {\n      ctx.teleport.onHoverLeave();\n    },\n    onSelectStart: (intersection, e) => {\n      ctx.teleport.onSelectStart(e);\n    },\n    onSelectEnd: (intersection) => {\n      ctx.teleport.onSelectEnd(intersection.point);\n    }\n  });\n}\n\nexport function enter(ctx) {\n  ctx.renderer.setClearColor(0x0a0a1a);\n  ctx.scene.add(scene);\n  ctx.raycontrol.activateState('landingDoors');\n  ctx.raycontrol.activateState('landingTeleport');\n}\n\nexport function exit(ctx) {\n  ctx.raycontrol.deactivateState('landingDoors');\n  ctx.raycontrol.deactivateState('landingTeleport');\n  ctx.scene.remove(scene);\n}\n\nexport function execute(ctx, delta, time) {\n  // Animate info panel icons\n  infoPanels.forEach(({ icon, element }) => {\n    icon.position.y = icon.userData.baseY + Math.sin(time * 2 + icon.userData.offset) * 0.1;\n    icon.rotation.y += delta * 0.5;\n  });\n\n  // Update door materials\n  doors.forEach(door => {\n    if (door.material.uniforms) {\n      door.material.uniforms.time.value = time;\n    }\n    if (door.scale.z > 1) {\n      door.scale.z = Math.max(door.scale.z - delta * door.scale.z, 1);\n    }\n  });\n}\n","import * as THREE from 'three';\nimport { Text, Position, ParentObject3D, Object3D, Children } from '../components/index.js';\n\nvar scene, doorMaterial, door, controllerModels = [], textEntities = [];\n\nconst CONTROLLER_INFO = [\n  {\n    title: \"6DOF Tracking\",\n    description: \"Position (X,Y,Z) and Rotation (Pitch,Yaw,Roll) tracking\",\n    color: 0x4a90e2\n  },\n  {\n    title: \"Buttons & Triggers\",\n    description: \"Trigger, Grip, A/B/X/Y buttons, Joystick, Menu\",\n    color: 0x50e3c2\n  },\n  {\n    title: \"Haptic Feedback\",\n    description: \"Vibration pulses for tactile feedback\",\n    color: 0xf5a623\n  },\n  {\n    title: \"Ray Casting\",\n    description: \"Laser pointer for distant object interaction\",\n    color: 0xe056fd\n  }\n];\n\nfunction createDoorMaterial(ctx) {\n  return new THREE.ShaderMaterial({\n    uniforms: {\n      time: {value: 0},\n      selected: {value: 0},\n      tex: {value: ctx.assets['doorfx_tex']}\n    },\n    vertexShader: ctx.shaders.basic_vert,\n    fragmentShader: ctx.shaders.door_frag\n  });\n}\n\nfunction createInfoPanel(info, index, x, y, z) {\n  const group = new THREE.Group();\n\n  // Panel background\n  const panelGeo = new THREE.BoxGeometry(2, 1.2, 0.1);\n  const panelMat = new THREE.MeshBasicMaterial({color: 0x2a2a3a});\n  const panel = new THREE.Mesh(panelGeo, panelMat);\n  panel.position.set(x, y, z);\n  group.add(panel);\n\n  // Title bar\n  const titleGeo = new THREE.PlaneGeometry(1.9, 0.3);\n  const titleMat = new THREE.MeshBasicMaterial({color: info.color});\n  const titlePlate = new THREE.Mesh(titleGeo, titleMat);\n  titlePlate.position.set(x, y + 0.4, z + 0.06);\n  titlePlate.name = `titlePlate_${index}`;\n  group.add(titlePlate);\n\n  // Description background\n  const descGeo = new THREE.PlaneGeometry(1.9, 0.7);\n  const descMat = new THREE.MeshBasicMaterial({color: 0x1a1a2a});\n  const descPlate = new THREE.Mesh(descGeo, descMat);\n  descPlate.position.set(x, y - 0.15, z + 0.06);\n  descPlate.name = `descPlate_${index}`;\n  group.add(descPlate);\n\n  return group;\n}\n\nfunction createControllerDisplay(ctx, x, z) {\n  const group = new THREE.Group();\n\n  // Pedestal\n  const pedestalGeo = new THREE.BoxGeometry(1.5, 0.8, 1.5);\n  const pedestalMat = new THREE.MeshBasicMaterial({color: 0x1a1a2a});\n  const pedestal = new THREE.Mesh(pedestalGeo, pedestalMat);\n  pedestal.position.set(x, 0.4, z);\n  group.add(pedestal);\n\n  // Rotating platform\n  const platformGeo = new THREE.CylinderGeometry(0.8, 0.9, 0.1, 32);\n  const platformMat = new THREE.MeshBasicMaterial({color: 0x3a3a5a});\n  const platform = new THREE.Mesh(platformGeo, platformMat);\n  platform.position.set(x, 0.85, z);\n  group.add(platform);\n\n  // Try to load controller model\n  if (ctx.assets['generic_controller_model']) {\n    const controller = ctx.assets['generic_controller_model'].scene.clone();\n    controller.position.set(x, 1.2, z);\n    controller.scale.set(2, 2, 2);\n    controller.userData.rotating = true;\n    group.add(controller);\n    controllerModels.push(controller);\n  } else {\n    // Fallback: simple controller shape\n    const controllerGeo = new THREE.BoxGeometry(0.15, 0.25, 0.08);\n    const controllerMat = new THREE.MeshBasicMaterial({color: 0x4a90e2});\n    const controller = new THREE.Mesh(controllerGeo, controllerMat);\n    controller.position.set(x, 1.2, z);\n    controller.userData.rotating = true;\n    group.add(controller);\n    controllerModels.push(controller);\n\n    // Add trigger\n    const triggerGeo = new THREE.BoxGeometry(0.03, 0.08, 0.03);\n    const triggerMat = new THREE.MeshBasicMaterial({color: 0x2a2a2a});\n    const trigger = new THREE.Mesh(triggerGeo, triggerMat);\n    trigger.position.set(0, 0.05, 0.055);\n    controller.add(trigger);\n  }\n\n  return group;\n}\n\nexport function setup(ctx) {\n  const assets = ctx.assets;\n  scene = new THREE.Scene();\n\n  // Room dimensions\n  const roomSize = 10;\n\n  // Floor\n  const floorGeo = new THREE.PlaneGeometry(roomSize, roomSize);\n  const floorMat = new THREE.MeshBasicMaterial({color: 0x1a1a2e});\n  const floor = new THREE.Mesh(floorGeo, floorMat);\n  floor.rotation.x = -Math.PI / 2;\n  scene.add(floor);\n\n  // Walls\n  const wallMat = new THREE.MeshBasicMaterial({color: 0x2a3a4a});\n  const wallHeight = 4;\n\n  // Back wall\n  const backWall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, wallHeight), wallMat);\n  backWall.position.set(0, wallHeight/2, -roomSize/2);\n  scene.add(backWall);\n\n  // Side walls\n  const leftWall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, wallHeight), wallMat);\n  leftWall.position.set(-roomSize/2, wallHeight/2, 0);\n  leftWall.rotation.y = Math.PI / 2;\n  scene.add(leftWall);\n\n  const rightWall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, wallHeight), wallMat);\n  rightWall.position.set(roomSize/2, wallHeight/2, 0);\n  rightWall.rotation.y = -Math.PI / 2;\n  scene.add(rightWall);\n\n  // Ceiling\n  const ceiling = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, roomSize), new THREE.MeshBasicMaterial({color: 0x0a0a1e}));\n  ceiling.rotation.x = Math.PI / 2;\n  ceiling.position.y = wallHeight;\n  scene.add(ceiling);\n\n  // Title banner\n  const bannerGeo = new THREE.PlaneGeometry(6, 1);\n  const bannerMat = new THREE.MeshBasicMaterial({color: 0x4a90e2});\n  const banner = new THREE.Mesh(bannerGeo, bannerMat);\n  banner.position.set(0, 3.5, -4.9);\n  scene.add(banner);\n\n  // Create controller displays along walls\n  createControllerDisplay(ctx, -3, -2);\n  createControllerDisplay(ctx, 3, -2);\n  createControllerDisplay(ctx, -3, 2);\n  createControllerDisplay(ctx, 3, 2);\n\n  // Info panels\n  CONTROLLER_INFO.forEach((info, index) => {\n    const positions = [\n      [-4, 1.5, -3],\n      [4, 1.5, -3],\n      [-4, 1.5, 3],\n      [4, 1.5, 3]\n    ];\n    const panel = createInfoPanel(info, index, ...positions[index]);\n    scene.add(panel);\n\n    // Add text labels to the panel\n    const titlePlate = panel.getObjectByName(`titlePlate_${index}`);\n    const descPlate = panel.getObjectByName(`descPlate_${index}`);\n\n    // Create title text entity\n    if (titlePlate) {\n      const titleTextEntity = ctx.world.createEntity();\n      titleTextEntity\n        .addComponent(Text, {\n          text: info.title,\n          color: '#ffffff',\n          fontSize: 0.07,\n          anchor: 'center',\n          baseline: 'middle',\n          textAlign: 'center'\n        })\n        .addComponent(ParentObject3D, {value: titlePlate})\n        .addComponent(Position, {x: 0, y: 0, z: 0.01});\n\n      const titleParentEntity = ctx.world.createEntity();\n      titleParentEntity\n        .addComponent(Object3D, {value: titlePlate})\n        .addComponent(Children, {value: [titleTextEntity]});\n\n      textEntities.push(titleTextEntity);\n    }\n\n    // Create description text entity\n    if (descPlate) {\n      const descTextEntity = ctx.world.createEntity();\n      descTextEntity\n        .addComponent(Text, {\n          text: info.description,\n          color: '#cccccc',\n          fontSize: 0.04,\n          anchor: 'center',\n          baseline: 'top',\n          textAlign: 'center',\n          maxWidth: 1.7,\n          lineHeight: 1.3\n        })\n        .addComponent(ParentObject3D, {value: descPlate})\n        .addComponent(Position, {x: 0, y: 0.3, z: 0.01});\n\n      const descParentEntity = ctx.world.createEntity();\n      descParentEntity\n        .addComponent(Object3D, {value: descPlate})\n        .addComponent(Children, {value: [descTextEntity]});\n\n      textEntities.push(descTextEntity);\n    }\n  });\n\n  // Center info display\n  const centerDisplayGeo = new THREE.BoxGeometry(3, 2, 0.2);\n  const centerDisplayMat = new THREE.MeshBasicMaterial({color: 0x2a2a3a});\n  const centerDisplay = new THREE.Mesh(centerDisplayGeo, centerDisplayMat);\n  centerDisplay.position.set(0, 1.5, 0);\n  scene.add(centerDisplay);\n\n  // Animated ring showing controller position tracking\n  const ringGeo = new THREE.RingGeometry(0.5, 0.6, 32);\n  const ringMat = new THREE.MeshBasicMaterial({color: 0x4a90e2, side: THREE.DoubleSide});\n  const ring = new THREE.Mesh(ringGeo, ringMat);\n  ring.position.set(0, 2.5, 0);\n  ring.rotation.x = -Math.PI / 2;\n  scene.add(ring);\n  scene.userData.trackingRing = ring;\n\n  // Door back to landing\n  doorMaterial = createDoorMaterial(ctx);\n  const doorGeo = new THREE.BoxGeometry(1.5, 2.5, 0.1);\n  door = new THREE.Mesh(doorGeo, doorMaterial);\n  door.position.set(0, 1.25, 4.9);\n  scene.add(door);\n\n  // Door frame\n  const frameGeo = new THREE.BoxGeometry(1.7, 2.7, 0.08);\n  const frameMat = new THREE.MeshBasicMaterial({color: 0x1a1a1a});\n  const frame = new THREE.Mesh(frameGeo, frameMat);\n  frame.position.set(0, 1.25, 5);\n  scene.add(frame);\n\n  // Teleport plane\n  const teleportGeo = new THREE.PlaneBufferGeometry(roomSize, roomSize);\n  const teleportMat = new THREE.MeshBasicMaterial({visible: false});\n  const teleport = new THREE.Mesh(teleportGeo, teleportMat);\n  teleport.rotation.x = -Math.PI / 2;\n  teleport.position.y = 0.001;\n  scene.add(teleport);\n\n  // Add interaction states\n  ctx.raycontrol.addState('controllersDoor', {\n    colliderMesh: door,\n    onHover: (intersection, active) => {\n      door.scale.z = Math.min(door.scale.z + 0.05 * (2 - door.scale.z), 2);\n    },\n    onHoverLeave: () => {},\n    onSelectStart: (intersection, e) => {\n      ctx.goto = 0; // Back to landing\n    },\n    onSelectEnd: (intersection) => {}\n  });\n\n  ctx.raycontrol.addState('controllersTeleport', {\n    colliderMesh: teleport,\n    onHover: (intersection, active) => {\n      ctx.teleport.onHover(intersection.point, active);\n    },\n    onHoverLeave: () => {\n      ctx.teleport.onHoverLeave();\n    },\n    onSelectStart: (intersection, e) => {\n      ctx.teleport.onSelectStart(e);\n    },\n    onSelectEnd: (intersection) => {\n      ctx.teleport.onSelectEnd(intersection.point);\n    }\n  });\n}\n\nexport function enter(ctx) {\n  ctx.renderer.setClearColor(0x0a0a1a);\n  ctx.scene.add(scene);\n  ctx.raycontrol.activateState('controllersDoor');\n  ctx.raycontrol.activateState('controllersTeleport');\n}\n\nexport function exit(ctx) {\n  ctx.raycontrol.deactivateState('controllersDoor');\n  ctx.raycontrol.deactivateState('controllersTeleport');\n  ctx.scene.remove(scene);\n}\n\nexport function execute(ctx, delta, time) {\n  doorMaterial.uniforms.time.value = time;\n\n  // Rotate controller models\n  controllerModels.forEach(controller => {\n    controller.rotation.y += delta * 0.5;\n  });\n\n  // Animate tracking ring\n  if (scene.userData.trackingRing) {\n    const scale = 1 + Math.sin(time * 3) * 0.2;\n    scene.userData.trackingRing.scale.set(scale, scale, 1);\n    scene.userData.trackingRing.rotation.z += delta * 0.5;\n  }\n\n  if (door.scale.z > 1) {\n    door.scale.z = Math.max(door.scale.z - delta * door.scale.z, 1);\n  }\n}\n","import * as THREE from 'three';\nimport { Text, Position, ParentObject3D, Object3D, Children } from '../components/index.js';\n\nvar scene, doorMaterial, door, teleportRings = [], textEntities = [];\n\nconst TELEPORT_INFO = [\n  {\n    title: \"Ray Casting\",\n    description: \"Cast invisible ray from controller to find destination\",\n    color: 0x50e3c2\n  },\n  {\n    title: \"Point & Click\",\n    description: \"Simple point-to-teleport interaction model\",\n    color: 0x4a90e2\n  },\n  {\n    title: \"Valid Targets\",\n    description: \"Only teleport to walkable surfaces (floors, ground)\",\n    color: 0xf5a623\n  },\n  {\n    title: \"Smooth Transition\",\n    description: \"Fade effect and camera movement for comfort\",\n    color: 0xe056fd\n  }\n];\n\nfunction createDoorMaterial(ctx) {\n  return new THREE.ShaderMaterial({\n    uniforms: {\n      time: {value: 0},\n      selected: {value: 0},\n      tex: {value: ctx.assets['doorfx_tex']}\n    },\n    vertexShader: ctx.shaders.basic_vert,\n    fragmentShader: ctx.shaders.door_frag\n  });\n}\n\nfunction createTeleportRing(x, z, color) {\n  const group = new THREE.Group();\n\n  // Outer ring\n  const outerRing = new THREE.Mesh(\n    new THREE.RingGeometry(0.8, 1, 32),\n    new THREE.MeshBasicMaterial({color: color, side: THREE.DoubleSide})\n  );\n  outerRing.rotation.x = -Math.PI / 2;\n  outerRing.position.y = 0.01;\n  group.add(outerRing);\n\n  // Inner ring\n  const innerRing = new THREE.Mesh(\n    new THREE.RingGeometry(0.3, 0.5, 32),\n    new THREE.MeshBasicMaterial({color: 0xffffff, side: THREE.DoubleSide})\n  );\n  innerRing.rotation.x = -Math.PI / 2;\n  innerRing.position.y = 0.02;\n  group.add(innerRing);\n\n  // Center marker\n  const marker = new THREE.Mesh(\n    new THREE.CircleGeometry(0.1, 16),\n    new THREE.MeshBasicMaterial({color: color})\n  );\n  marker.rotation.x = -Math.PI / 2;\n  marker.position.y = 0.03;\n  group.add(marker);\n\n  group.position.set(x, 0, z);\n  group.userData.animOffset = Math.random() * Math.PI * 2;\n\n  return group;\n}\n\nfunction createInfoPanel(info, index, x, y, z) {\n  const panelGeo = new THREE.BoxGeometry(2.5, 1.5, 0.1);\n  const panelMat = new THREE.MeshBasicMaterial({color: 0x2a2a3a});\n  const panel = new THREE.Mesh(panelGeo, panelMat);\n  panel.position.set(x, y, z);\n\n  // Title bar\n  const titleGeo = new THREE.PlaneGeometry(2.3, 0.4);\n  const titleMat = new THREE.MeshBasicMaterial({color: info.color});\n  const titlePlate = new THREE.Mesh(titleGeo, titleMat);\n  titlePlate.position.set(0, 0.5, 0.06);\n  titlePlate.name = `titlePlate_${index}`;\n  panel.add(titlePlate);\n\n  // Description background\n  const descGeo = new THREE.PlaneGeometry(2.3, 0.9);\n  const descMat = new THREE.MeshBasicMaterial({color: 0x1a1a2a});\n  const descPlate = new THREE.Mesh(descGeo, descMat);\n  descPlate.position.set(0, -0.15, 0.06);\n  descPlate.name = `descPlate_${index}`;\n  panel.add(descPlate);\n\n  return panel;\n}\n\nexport function setup(ctx) {\n  scene = new THREE.Scene();\n\n  const roomSize = 10;\n\n  // Floor with teleport target areas\n  const floorGeo = new THREE.PlaneGeometry(roomSize, roomSize);\n  const floorMat = new THREE.MeshBasicMaterial({color: 0x1a1a2e});\n  const floor = new THREE.Mesh(floorGeo, floorMat);\n  floor.rotation.x = -Math.PI / 2;\n  scene.add(floor);\n\n  // Walls\n  const wallMat = new THREE.MeshBasicMaterial({color: 0x2a3a4a});\n  const wallHeight = 4;\n\n  const walls = [\n    {pos: [0, wallHeight/2, -roomSize/2], rot: [0, 0, 0]},\n    {pos: [-roomSize/2, wallHeight/2, 0], rot: [0, Math.PI/2, 0]},\n    {pos: [roomSize/2, wallHeight/2, 0], rot: [0, -Math.PI/2, 0]},\n  ];\n\n  walls.forEach(wall => {\n    const mesh = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, wallHeight), wallMat);\n    mesh.position.set(...wall.pos);\n    mesh.rotation.set(...wall.rot);\n    scene.add(mesh);\n  });\n\n  // Ceiling\n  const ceiling = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, roomSize), new THREE.MeshBasicMaterial({color: 0x0a0a1e}));\n  ceiling.rotation.x = Math.PI / 2;\n  ceiling.position.y = wallHeight;\n  scene.add(ceiling);\n\n  // Create teleport demonstration rings\n  const ringPositions = [\n    {x: -3, z: -3, color: 0x50e3c2},\n    {x: 3, z: -3, color: 0x4a90e2},\n    {x: -3, z: 3, color: 0xf5a623},\n    {x: 3, z: 3, color: 0xe056fd}\n  ];\n\n  ringPositions.forEach((pos, index) => {\n    const ring = createTeleportRing(pos.x, pos.z, pos.color);\n    scene.add(ring);\n    teleportRings.push(ring);\n\n    // Info panel above each ring\n    const info = TELEPORT_INFO[index];\n    const panel = createInfoPanel(info, index, pos.x, 2, pos.z - 1.5);\n    scene.add(panel);\n\n    // Add text labels to the panel\n    const titlePlate = panel.getObjectByName(`titlePlate_${index}`);\n    const descPlate = panel.getObjectByName(`descPlate_${index}`);\n\n    // Create title text entity\n    if (titlePlate) {\n      const titleTextEntity = ctx.world.createEntity();\n      titleTextEntity\n        .addComponent(Text, {\n          text: info.title,\n          color: '#ffffff',\n          fontSize: 0.07,\n          anchor: 'center',\n          baseline: 'middle',\n          textAlign: 'center'\n        })\n        .addComponent(ParentObject3D, {value: titlePlate})\n        .addComponent(Position, {x: 0, y: 0, z: 0.01});\n\n      const titleParentEntity = ctx.world.createEntity();\n      titleParentEntity\n        .addComponent(Object3D, {value: titlePlate})\n        .addComponent(Children, {value: [titleTextEntity]});\n\n      textEntities.push(titleTextEntity);\n    }\n\n    // Create description text entity\n    if (descPlate) {\n      const descTextEntity = ctx.world.createEntity();\n      descTextEntity\n        .addComponent(Text, {\n          text: info.description,\n          color: '#cccccc',\n          fontSize: 0.04,\n          anchor: 'center',\n          baseline: 'top',\n          textAlign: 'center',\n          maxWidth: 2.1,\n          lineHeight: 1.3\n        })\n        .addComponent(ParentObject3D, {value: descPlate})\n        .addComponent(Position, {x: 0, y: 0.4, z: 0.01});\n\n      const descParentEntity = ctx.world.createEntity();\n      descParentEntity\n        .addComponent(Object3D, {value: descPlate})\n        .addComponent(Children, {value: [descTextEntity]});\n\n      textEntities.push(descTextEntity);\n    }\n  });\n\n  // Center demonstration area with laser visualization\n  const laserGeo = new THREE.CylinderGeometry(0.01, 0.01, 4, 8);\n  const laserMat = new THREE.MeshBasicMaterial({color: 0x50e3c2, transparent: true, opacity: 0.5});\n  const laser = new THREE.Mesh(laserGeo, laserMat);\n  laser.position.set(0, 2, 0);\n  laser.rotation.x = Math.PI / 4;\n  scene.add(laser);\n  scene.userData.laser = laser;\n\n  // Laser origin (controller)\n  const controllerGeo = new THREE.BoxGeometry(0.1, 0.15, 0.05);\n  const controllerMat = new THREE.MeshBasicMaterial({color: 0x4a90e2});\n  const controller = new THREE.Mesh(controllerGeo, controllerMat);\n  controller.position.set(0, 3, 0);\n  scene.add(controller);\n  scene.userData.controller = controller;\n\n  // Door\n  doorMaterial = createDoorMaterial(ctx);\n  const doorGeo = new THREE.BoxGeometry(1.5, 2.5, 0.1);\n  door = new THREE.Mesh(doorGeo, doorMaterial);\n  door.position.set(0, 1.25, 4.9);\n  scene.add(door);\n\n  const frameGeo = new THREE.BoxGeometry(1.7, 2.7, 0.08);\n  const frameMat = new THREE.MeshBasicMaterial({color: 0x1a1a1a});\n  const frame = new THREE.Mesh(frameGeo, frameMat);\n  frame.position.set(0, 1.25, 5);\n  scene.add(frame);\n\n  // Teleport floor\n  const teleportGeo = new THREE.PlaneBufferGeometry(roomSize, roomSize);\n  const teleportMat = new THREE.MeshBasicMaterial({visible: false});\n  const teleport = new THREE.Mesh(teleportGeo, teleportMat);\n  teleport.rotation.x = -Math.PI / 2;\n  teleport.position.y = 0.001;\n  scene.add(teleport);\n\n  // Interaction states\n  ctx.raycontrol.addState('teleportDoor', {\n    colliderMesh: door,\n    onHover: (intersection, active) => {\n      door.scale.z = Math.min(door.scale.z + 0.05 * (2 - door.scale.z), 2);\n    },\n    onHoverLeave: () => {},\n    onSelectStart: (intersection, e) => {\n      ctx.goto = 0;\n    },\n    onSelectEnd: (intersection) => {}\n  });\n\n  ctx.raycontrol.addState('teleportRoomTeleport', {\n    colliderMesh: teleport,\n    onHover: (intersection, active) => {\n      ctx.teleport.onHover(intersection.point, active);\n    },\n    onHoverLeave: () => {\n      ctx.teleport.onHoverLeave();\n    },\n    onSelectStart: (intersection, e) => {\n      ctx.teleport.onSelectStart(e);\n    },\n    onSelectEnd: (intersection) => {\n      ctx.teleport.onSelectEnd(intersection.point);\n    }\n  });\n}\n\nexport function enter(ctx) {\n  ctx.renderer.setClearColor(0x0a0a1a);\n  ctx.scene.add(scene);\n  ctx.raycontrol.activateState('teleportDoor');\n  ctx.raycontrol.activateState('teleportRoomTeleport');\n}\n\nexport function exit(ctx) {\n  ctx.raycontrol.deactivateState('teleportDoor');\n  ctx.raycontrol.deactivateState('teleportRoomTeleport');\n  ctx.scene.remove(scene);\n}\n\nexport function execute(ctx, delta, time) {\n  doorMaterial.uniforms.time.value = time;\n\n  // Animate teleport rings\n  teleportRings.forEach(ring => {\n    const scale = 1 + Math.sin(time * 3 + ring.userData.animOffset) * 0.1;\n    ring.children[0].scale.set(scale, scale, 1);\n    ring.children[1].scale.set(scale * 0.8, scale * 0.8, 1);\n  });\n\n  // Animate laser\n  if (scene.userData.laser && scene.userData.controller) {\n    scene.userData.controller.rotation.y += delta * 0.3;\n    scene.userData.laser.rotation.y = scene.userData.controller.rotation.y;\n    scene.userData.laser.rotation.x = Math.PI / 4 + Math.sin(time * 2) * 0.3;\n  }\n\n  if (door.scale.z > 1) {\n    door.scale.z = Math.max(door.scale.z - delta * door.scale.z, 1);\n  }\n}\n","import * as THREE from 'three';\nimport { Text, Position, ParentObject3D, Object3D, Children } from '../components/index.js';\n\nvar scene, doorMaterial, door, modelPedestals = [], textEntities = [];\n\nconst MODEL_INFO = [\n  {title: \"glTF Format\", desc: \"Standard runtime format for WebXR\", color: 0xf5a623},\n  {title: \"DRACO Compression\", desc: \"Geometry compression for smaller files\", color: 0x4a90e2},\n  {title: \"Materials & Textures\", desc: \"PBR materials for realistic rendering\", color: 0x50e3c2},\n  {title: \"Animations\", desc: \"Skeletal and vertex animations\", color: 0xe056fd}\n];\n\nfunction createDoorMaterial(ctx) {\n  return new THREE.ShaderMaterial({\n    uniforms: {time: {value: 0}, selected: {value: 0}, tex: {value: ctx.assets['doorfx_tex']}},\n    vertexShader: ctx.shaders.basic_vert,\n    fragmentShader: ctx.shaders.door_frag\n  });\n}\n\nfunction createPedestal(x, z, color) {\n  const group = new THREE.Group();\n\n  // Base\n  const baseGeo = new THREE.BoxGeometry(1.5, 0.1, 1.5);\n  const baseMat = new THREE.MeshBasicMaterial({color: 0x1a1a2a});\n  const base = new THREE.Mesh(baseGeo, baseMat);\n  base.position.set(x, 0.05, z);\n  group.add(base);\n\n  // Column\n  const columnGeo = new THREE.BoxGeometry(0.8, 1, 0.8);\n  const columnMat = new THREE.MeshBasicMaterial({color: 0x2a2a3a});\n  const column = new THREE.Mesh(columnGeo, columnMat);\n  column.position.set(x, 0.6, z);\n  group.add(column);\n\n  // Top platform\n  const topGeo = new THREE.CylinderGeometry(0.6, 0.7, 0.1, 16);\n  const topMat = new THREE.MeshBasicMaterial({color: color});\n  const top = new THREE.Mesh(topGeo, topMat);\n  top.position.set(x, 1.15, z);\n  group.add(top);\n\n  // Rotating model placeholder (cube)\n  const cubeGeo = new THREE.BoxGeometry(0.4, 0.4, 0.4);\n  const cubeMat = new THREE.MeshBasicMaterial({color: color, wireframe: true});\n  const cube = new THREE.Mesh(cubeGeo, cubeMat);\n  cube.position.set(x, 1.5, z);\n  cube.userData.rotating = true;\n  group.add(cube);\n  modelPedestals.push(cube);\n\n  return group;\n}\n\nfunction createInfoPanel(info, index, x, y, z, lookAt) {\n  const group = new THREE.Group();\n\n  const panelGeo = new THREE.BoxGeometry(2, 1.2, 0.1);\n  const panelMat = new THREE.MeshBasicMaterial({color: 0x2a2a3a});\n  const panel = new THREE.Mesh(panelGeo, panelMat);\n  panel.position.set(x, y, z);\n  panel.lookAt(lookAt);\n  group.add(panel);\n\n  const titleGeo = new THREE.PlaneGeometry(1.8, 0.3);\n  const titleMat = new THREE.MeshBasicMaterial({color: info.color});\n  const titlePlate = new THREE.Mesh(titleGeo, titleMat);\n  titlePlate.position.set(0, 0.3, 0.06);\n  titlePlate.name = `titlePlate_${index}`;\n  panel.add(titlePlate);\n\n  // Description background\n  const descGeo = new THREE.PlaneGeometry(1.8, 0.7);\n  const descMat = new THREE.MeshBasicMaterial({color: 0x1a1a2a});\n  const descPlate = new THREE.Mesh(descGeo, descMat);\n  descPlate.position.set(0, -0.15, 0.06);\n  descPlate.name = `descPlate_${index}`;\n  panel.add(descPlate);\n\n  return group;\n}\n\nexport function setup(ctx) {\n  scene = new THREE.Scene();\n  const roomSize = 10;\n\n  // Floor\n  const floor = new THREE.Mesh(\n    new THREE.PlaneGeometry(roomSize, roomSize),\n    new THREE.MeshBasicMaterial({color: 0x1a1a2e})\n  );\n  floor.rotation.x = -Math.PI / 2;\n  scene.add(floor);\n\n  // Walls\n  const wallMat = new THREE.MeshBasicMaterial({color: 0x2a3a4a});\n  const wallHeight = 4;\n\n  [[0, wallHeight/2, -roomSize/2, 0], [-roomSize/2, wallHeight/2, 0, Math.PI/2], [roomSize/2, wallHeight/2, 0, -Math.PI/2]].forEach(([x, y, z, rot]) => {\n    const wall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, wallHeight), wallMat);\n    wall.position.set(x, y, z);\n    wall.rotation.y = rot;\n    scene.add(wall);\n  });\n\n  // Ceiling\n  const ceiling = new THREE.Mesh(\n    new THREE.PlaneGeometry(roomSize, roomSize),\n    new THREE.MeshBasicMaterial({color: 0x0a0a1e})\n  );\n  ceiling.rotation.x = Math.PI / 2;\n  ceiling.position.y = wallHeight;\n  scene.add(ceiling);\n\n  // Create model display pedestals\n  const positions = [[-3, -3], [3, -3], [-3, 3], [3, 3]];\n  positions.forEach(([x, z], i) => {\n    createPedestal(x, z, MODEL_INFO[i].color);\n    const panel = createInfoPanel(MODEL_INFO[i], i, x, 2.5, z - 2.5, {x, y: 2.5, z: z});\n    scene.add(panel);\n\n    // Add text labels to the panel\n    const titlePlate = panel.getObjectByName(`titlePlate_${i}`);\n    const descPlate = panel.getObjectByName(`descPlate_${i}`);\n\n    // Create title text entity\n    if (titlePlate) {\n      const titleTextEntity = ctx.world.createEntity();\n      titleTextEntity\n        .addComponent(Text, {\n          text: MODEL_INFO[i].title,\n          color: '#ffffff',\n          fontSize: 0.07,\n          anchor: 'center',\n          baseline: 'middle',\n          textAlign: 'center'\n        })\n        .addComponent(ParentObject3D, {value: titlePlate})\n        .addComponent(Position, {x: 0, y: 0, z: 0.01});\n\n      const titleParentEntity = ctx.world.createEntity();\n      titleParentEntity\n        .addComponent(Object3D, {value: titlePlate})\n        .addComponent(Children, {value: [titleTextEntity]});\n\n      textEntities.push(titleTextEntity);\n    }\n\n    // Create description text entity\n    if (descPlate) {\n      const descTextEntity = ctx.world.createEntity();\n      descTextEntity\n        .addComponent(Text, {\n          text: MODEL_INFO[i].desc,\n          color: '#cccccc',\n          fontSize: 0.04,\n          anchor: 'center',\n          baseline: 'top',\n          textAlign: 'center',\n          maxWidth: 1.6,\n          lineHeight: 1.3\n        })\n        .addComponent(ParentObject3D, {value: descPlate})\n        .addComponent(Position, {x: 0, y: 0.3, z: 0.01});\n\n      const descParentEntity = ctx.world.createEntity();\n      descParentEntity\n        .addComponent(Object3D, {value: descPlate})\n        .addComponent(Children, {value: [descTextEntity]});\n\n      textEntities.push(descTextEntity);\n    }\n  });\n\n  // Door\n  doorMaterial = createDoorMaterial(ctx);\n  door = new THREE.Mesh(new THREE.BoxGeometry(1.5, 2.5, 0.1), doorMaterial);\n  door.position.set(0, 1.25, 4.9);\n  scene.add(door);\n\n  const frame = new THREE.Mesh(new THREE.BoxGeometry(1.7, 2.7, 0.08), new THREE.MeshBasicMaterial({color: 0x1a1a1a}));\n  frame.position.set(0, 1.25, 5);\n  scene.add(frame);\n\n  // Teleport\n  const teleport = new THREE.Mesh(new THREE.PlaneBufferGeometry(roomSize, roomSize), new THREE.MeshBasicMaterial({visible: false}));\n  teleport.rotation.x = -Math.PI / 2;\n  teleport.position.y = 0.001;\n  scene.add(teleport);\n\n  // Interaction\n  ctx.raycontrol.addState('modelsDoor', {\n    colliderMesh: door,\n    onHover: (intersection, active) => { door.scale.z = Math.min(door.scale.z + 0.05 * (2 - door.scale.z), 2); },\n    onHoverLeave: () => {},\n    onSelectStart: (intersection, e) => { ctx.goto = 0; },\n    onSelectEnd: (intersection) => {}\n  });\n\n  ctx.raycontrol.addState('modelsTeleport', {\n    colliderMesh: teleport,\n    onHover: (intersection, active) => { ctx.teleport.onHover(intersection.point, active); },\n    onHoverLeave: () => { ctx.teleport.onHoverLeave(); },\n    onSelectStart: (intersection, e) => { ctx.teleport.onSelectStart(e); },\n    onSelectEnd: (intersection) => { ctx.teleport.onSelectEnd(intersection.point); }\n  });\n}\n\nexport function enter(ctx) {\n  ctx.renderer.setClearColor(0x0a0a1a);\n  ctx.scene.add(scene);\n  ctx.raycontrol.activateState('modelsDoor');\n  ctx.raycontrol.activateState('modelsTeleport');\n}\n\nexport function exit(ctx) {\n  ctx.raycontrol.deactivateState('modelsDoor');\n  ctx.raycontrol.deactivateState('modelsTeleport');\n  ctx.scene.remove(scene);\n}\n\nexport function execute(ctx, delta, time) {\n  doorMaterial.uniforms.time.value = time;\n  modelPedestals.forEach(cube => { cube.rotation.x += delta * 0.5; cube.rotation.y += delta * 0.3; });\n  if (door.scale.z > 1) door.scale.z = Math.max(door.scale.z - delta * door.scale.z, 1);\n}\n","import * as THREE from 'three';\nimport { Text, Position, ParentObject3D, Object3D, Children } from '../components/index.js';\n\nvar scene, doorMaterial, door, audioSpheres = [], textEntities = [];\n\nconst AUDIO_INFO = [\n  {title: \"Positional Audio\", desc: \"Sound sources have 3D positions\", color: 0xe056fd},\n  {title: \"Distance Decay\", desc: \"Volume decreases with distance\", color: 0x4a90e2},\n  {title: \"Spatial Effects\", desc: \"HRTF for realistic 3D sound\", color: 0x50e3c2},\n  {title: \"Multiple Sources\", desc: \"Many sounds can play simultaneously\", color: 0xf5a623}\n];\n\nfunction createDoorMaterial(ctx) {\n  return new THREE.ShaderMaterial({\n    uniforms: {time: {value: 0}, selected: {value: 0}, tex: {value: ctx.assets['doorfx_tex']}},\n    vertexShader: ctx.shaders.basic_vert,\n    fragmentShader: ctx.shaders.door_frag\n  });\n}\n\nfunction createAudioSphere(x, y, z, color) {\n  const group = new THREE.Group();\n\n  // Sound source sphere\n  const sphereGeo = new THREE.SphereGeometry(0.3, 16, 16);\n  const sphereMat = new THREE.MeshBasicMaterial({color: color, transparent: true, opacity: 0.7});\n  const sphere = new THREE.Mesh(sphereGeo, sphereMat);\n  sphere.position.set(x, y, z);\n  group.add(sphere);\n\n  // Pulsing ring\n  const ringGeo = new THREE.RingGeometry(0.4, 0.5, 32);\n  const ringMat = new THREE.MeshBasicMaterial({color: color, side: THREE.DoubleSide, transparent: true, opacity: 0.5});\n  const ring = new THREE.Mesh(ringGeo, ringMat);\n  ring.position.set(x, y, z);\n  ring.lookAt(x, y + 1, z);\n  group.add(ring);\n\n  group.userData.animOffset = Math.random() * Math.PI * 2;\n  audioSpheres.push({sphere, ring, offset: group.userData.animOffset});\n\n  return group;\n}\n\nexport function setup(ctx) {\n  scene = new THREE.Scene();\n  const roomSize = 10;\n\n  // Floor\n  scene.add(new THREE.Mesh(\n    new THREE.PlaneGeometry(roomSize, roomSize),\n    new THREE.MeshBasicMaterial({color: 0x1a1a2e})\n  ).rotateX(-Math.PI / 2));\n\n  // Walls\n  const wallMat = new THREE.MeshBasicMaterial({color: 0x2a3a4a});\n  const wallHeight = 4;\n  [[0, wallHeight/2, -roomSize/2, 0], [-roomSize/2, wallHeight/2, 0, Math.PI/2], [roomSize/2, wallHeight/2, 0, -Math.PI/2]].forEach(([x, y, z, rot]) => {\n    const wall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, wallHeight), wallMat);\n    wall.position.set(x, y, z);\n    wall.rotation.y = rot;\n    scene.add(wall);\n  });\n\n  // Ceiling\n  const ceiling = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, roomSize), new THREE.MeshBasicMaterial({color: 0x0a0a1e}));\n  ceiling.rotation.x = Math.PI / 2;\n  ceiling.position.y = wallHeight;\n  scene.add(ceiling);\n\n  // Create audio spheres\n  const positions = [[-3, 1.5, -3], [3, 1.5, -3], [-3, 1.5, 3], [3, 1.5, 3]];\n  positions.forEach(([x, y, z], i) => {\n    createAudioSphere(x, y, z, AUDIO_INFO[i].color);\n\n    // Info panel\n    const panel = new THREE.Mesh(new THREE.BoxGeometry(2, 1, 0.1), new THREE.MeshBasicMaterial({color: 0x2a2a3a}));\n    panel.position.set(x, 2.5, z);\n    scene.add(panel);\n\n    // Title plate\n    const titlePlate = new THREE.Mesh(new THREE.PlaneGeometry(1.8, 0.25), new THREE.MeshBasicMaterial({color: AUDIO_INFO[i].color}));\n    titlePlate.position.set(0, 0.3, 0.06);\n    titlePlate.name = `titlePlate_${i}`;\n    panel.add(titlePlate);\n\n    // Description background\n    const descPlate = new THREE.Mesh(new THREE.PlaneGeometry(1.8, 0.55), new THREE.MeshBasicMaterial({color: 0x1a1a2a}));\n    descPlate.position.set(0, -0.12, 0.06);\n    descPlate.name = `descPlate_${i}`;\n    panel.add(descPlate);\n\n    // Create title text entity\n    const titleTextEntity = ctx.world.createEntity();\n    titleTextEntity\n      .addComponent(Text, {\n        text: AUDIO_INFO[i].title,\n        color: '#ffffff',\n        fontSize: 0.065,\n        anchor: 'center',\n        baseline: 'middle',\n        textAlign: 'center'\n      })\n      .addComponent(ParentObject3D, {value: titlePlate})\n      .addComponent(Position, {x: 0, y: 0, z: 0.01});\n\n    const titleParentEntity = ctx.world.createEntity();\n    titleParentEntity\n      .addComponent(Object3D, {value: titlePlate})\n      .addComponent(Children, {value: [titleTextEntity]});\n\n    textEntities.push(titleTextEntity);\n\n    // Create description text entity\n    const descTextEntity = ctx.world.createEntity();\n    descTextEntity\n      .addComponent(Text, {\n        text: AUDIO_INFO[i].desc,\n        color: '#cccccc',\n        fontSize: 0.04,\n        anchor: 'center',\n        baseline: 'top',\n        textAlign: 'center',\n        maxWidth: 1.6,\n        lineHeight: 1.3\n      })\n      .addComponent(ParentObject3D, {value: descPlate})\n      .addComponent(Position, {x: 0, y: 0.25, z: 0.01});\n\n    const descParentEntity = ctx.world.createEntity();\n    descParentEntity\n      .addComponent(Object3D, {value: descPlate})\n      .addComponent(Children, {value: [descTextEntity]});\n\n    textEntities.push(descTextEntity);\n  });\n\n  // Center visualization of sound waves\n  const waveGroup = new THREE.Group();\n  for (let i = 0; i < 5; i++) {\n    const wave = new THREE.Mesh(\n      new THREE.RingGeometry(0.5 + i * 0.3, 0.6 + i * 0.3, 32),\n      new THREE.MeshBasicMaterial({color: 0xe056fd, side: THREE.DoubleSide, transparent: true, opacity: 0.3 - i * 0.05})\n    );\n    wave.rotation.x = -Math.PI / 2;\n    waveGroup.add(wave);\n  }\n  waveGroup.position.set(0, 0.1, 0);\n  scene.add(waveGroup);\n  scene.userData.waves = waveGroup;\n\n  // Door\n  doorMaterial = createDoorMaterial(ctx);\n  door = new THREE.Mesh(new THREE.BoxGeometry(1.5, 2.5, 0.1), doorMaterial);\n  door.position.set(0, 1.25, 4.9);\n  scene.add(door);\n\n  const doorFrame = new THREE.Mesh(new THREE.BoxGeometry(1.7, 2.7, 0.08), new THREE.MeshBasicMaterial({color: 0x1a1a1a}));\n  doorFrame.position.set(0, 1.25, 5);\n  scene.add(doorFrame);\n\n  // Teleport\n  const teleport = new THREE.Mesh(new THREE.PlaneBufferGeometry(roomSize, roomSize), new THREE.MeshBasicMaterial({visible: false}));\n  teleport.rotation.x = -Math.PI / 2;\n  teleport.position.y = 0.001;\n  scene.add(teleport);\n\n  ctx.raycontrol.addState('audioDoor', {\n    colliderMesh: door,\n    onHover: (intersection, active) => { door.scale.z = Math.min(door.scale.z + 0.05 * (2 - door.scale.z), 2); },\n    onHoverLeave: () => {},\n    onSelectStart: (intersection, e) => { ctx.goto = 0; },\n    onSelectEnd: (intersection) => {}\n  });\n\n  ctx.raycontrol.addState('audioTeleport', {\n    colliderMesh: teleport,\n    onHover: (intersection, active) => { ctx.teleport.onHover(intersection.point, active); },\n    onHoverLeave: () => { ctx.teleport.onHoverLeave(); },\n    onSelectStart: (intersection, e) => { ctx.teleport.onSelectStart(e); },\n    onSelectEnd: (intersection) => { ctx.teleport.onSelectEnd(intersection.point); }\n  });\n}\n\nexport function enter(ctx) {\n  ctx.renderer.setClearColor(0x0a0a1a);\n  ctx.scene.add(scene);\n  ctx.raycontrol.activateState('audioDoor');\n  ctx.raycontrol.activateState('audioTeleport');\n}\n\nexport function exit(ctx) {\n  ctx.raycontrol.deactivateState('audioDoor');\n  ctx.raycontrol.deactivateState('audioTeleport');\n  ctx.scene.remove(scene);\n}\n\nexport function execute(ctx, delta, time) {\n  doorMaterial.uniforms.time.value = time;\n\n  // Animate audio spheres\n  audioSpheres.forEach(({sphere, ring, offset}) => {\n    const scale = 1 + Math.sin(time * 3 + offset) * 0.2;\n    sphere.scale.set(scale, scale, scale);\n    const ringScale = 1 + Math.sin(time * 2 + offset) * 0.3;\n    ring.scale.set(ringScale, ringScale, 1);\n  });\n\n  // Animate center waves\n  if (scene.userData.waves) {\n    scene.userData.waves.children.forEach((wave, i) => {\n      wave.scale.set(1 + Math.sin(time * 2 - i * 0.5) * 0.5, 1 + Math.sin(time * 2 - i * 0.5) * 0.5, 1);\n    });\n  }\n\n  if (door.scale.z > 1) door.scale.z = Math.max(door.scale.z - delta * door.scale.z, 1);\n}\n","import * as THREE from 'three';\nimport { Text, Position, ParentObject3D, Object3D, Children } from '../components/index.js';\n\nvar scene, doorMaterial, door, interactiveCubes = [], textEntities = [];\n\nconst INTERACTION_INFO = [\n  {title: \"Ray Casting\", desc: \"Laser pointer for distant selection\", color: 0xff6b6b},\n  {title: \"Hover States\", desc: \"Visual feedback on look/hover\", color: 0x4a90e2},\n  {title: \"Grab & Throw\", desc: \"Pick up and manipulate objects\", color: 0x50e3c2},\n  {title: \"UI Interaction\", desc: \"Buttons, sliders, menus in VR\", color: 0xf5a623}\n];\n\nfunction createDoorMaterial(ctx) {\n  return new THREE.ShaderMaterial({\n    uniforms: {time: {value: 0}, selected: {value: 0}, tex: {value: ctx.assets['doorfx_tex']}},\n    vertexShader: ctx.shaders.basic_vert,\n    fragmentShader: ctx.shaders.door_frag\n  });\n}\n\nfunction createInteractiveCube(x, y, z, color) {\n  const group = new THREE.Group();\n\n  // Interactive cube\n  const cubeGeo = new THREE.BoxGeometry(0.5, 0.5, 0.5);\n  const cubeMat = new THREE.MeshBasicMaterial({color: color, wireframe: true});\n  const cube = new THREE.Mesh(cubeGeo, cubeMat);\n  cube.position.set(x, y, z);\n  cube.userData.hovered = false;\n  group.add(cube);\n  interactiveCubes.push(cube);\n\n  // Target ring\n  const ringGeo = new THREE.RingGeometry(0.4, 0.5, 32);\n  const ringMat = new THREE.MeshBasicMaterial({color: color, side: THREE.DoubleSide});\n  const ring = new THREE.Mesh(ringGeo, ringMat);\n  ring.rotation.x = -Math.PI / 2;\n  ring.position.set(x, 0.01, z);\n  group.add(ring);\n\n  // Pedestal\n  const pedestal = new THREE.Mesh(\n    new THREE.CylinderGeometry(0.3, 0.4, y, 8),\n    new THREE.MeshBasicMaterial({color: 0x1a1a2a})\n  );\n  pedestal.position.set(x, y / 2, z);\n  group.add(pedestal);\n\n  return group;\n}\n\nfunction createLaserVisual() {\n  const group = new THREE.Group();\n\n  // Laser beam\n  const laserGeo = new THREE.CylinderGeometry(0.005, 0.005, 3, 8);\n  const laserMat = new THREE.MeshBasicMaterial({color: 0xff6b6b, transparent: true, opacity: 0.7});\n  const laser = new THREE.Mesh(laserGeo, laserMat);\n  laser.position.set(0, 1.5, 0);\n  laser.rotation.x = Math.PI / 2;\n  group.add(laser);\n\n  // Controller\n  const controller = new THREE.Mesh(\n    new THREE.BoxGeometry(0.08, 0.12, 0.04),\n    new THREE.MeshBasicMaterial({color: 0x4a90e2})\n  );\n  controller.position.set(0, 1.5, 0);\n  group.add(controller);\n\n  return group;\n}\n\nexport function setup(ctx) {\n  scene = new THREE.Scene();\n  const roomSize = 10;\n\n  // Floor\n  scene.add(new THREE.Mesh(\n    new THREE.PlaneGeometry(roomSize, roomSize),\n    new THREE.MeshBasicMaterial({color: 0x1a1a2e})\n  ).rotateX(-Math.PI / 2));\n\n  // Walls\n  const wallMat = new THREE.MeshBasicMaterial({color: 0x2a3a4a});\n  const wallHeight = 4;\n  [[0, wallHeight/2, -roomSize/2, 0], [-roomSize/2, wallHeight/2, 0, Math.PI/2], [roomSize/2, wallHeight/2, 0, -Math.PI/2]].forEach(([x, y, z, rot]) => {\n    const wall = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, wallHeight), wallMat);\n    wall.position.set(x, y, z);\n    wall.rotation.y = rot;\n    scene.add(wall);\n  });\n\n  // Ceiling\n  const ceiling = new THREE.Mesh(new THREE.PlaneGeometry(roomSize, roomSize), new THREE.MeshBasicMaterial({color: 0x0a0a1e}));\n  ceiling.rotation.x = Math.PI / 2;\n  ceiling.position.y = wallHeight;\n  scene.add(ceiling);\n\n  // Create interactive cubes\n  const positions = [[-3, 1.5, -3], [3, 1.5, -3], [-3, 1.5, 3], [3, 1.5, 3]];\n  positions.forEach(([x, y, z], i) => {\n    createInteractiveCube(x, y, z, INTERACTION_INFO[i].color);\n\n    // Info panel\n    const panel = new THREE.Mesh(new THREE.BoxGeometry(2, 1, 0.1), new THREE.MeshBasicMaterial({color: 0x2a2a3a}));\n    panel.position.set(x, 2.8, z - 1.5);\n    panel.lookAt(x, 2.8, z);\n    scene.add(panel);\n\n    // Title plate\n    const titlePlate = new THREE.Mesh(new THREE.PlaneGeometry(1.8, 0.25), new THREE.MeshBasicMaterial({color: INTERACTION_INFO[i].color}));\n    titlePlate.position.set(0, 0.3, 0.06);\n    titlePlate.name = `titlePlate_${i}`;\n    panel.add(titlePlate);\n\n    // Description background\n    const descPlate = new THREE.Mesh(new THREE.PlaneGeometry(1.8, 0.55), new THREE.MeshBasicMaterial({color: 0x1a1a2a}));\n    descPlate.position.set(0, -0.12, 0.06);\n    descPlate.name = `descPlate_${i}`;\n    panel.add(descPlate);\n\n    // Create title text entity\n    const titleTextEntity = ctx.world.createEntity();\n    titleTextEntity\n      .addComponent(Text, {\n        text: INTERACTION_INFO[i].title,\n        color: '#ffffff',\n        fontSize: 0.065,\n        anchor: 'center',\n        baseline: 'middle',\n        textAlign: 'center'\n      })\n      .addComponent(ParentObject3D, {value: titlePlate})\n      .addComponent(Position, {x: 0, y: 0, z: 0.01});\n\n    const titleParentEntity = ctx.world.createEntity();\n    titleParentEntity\n      .addComponent(Object3D, {value: titlePlate})\n      .addComponent(Children, {value: [titleTextEntity]});\n\n    textEntities.push(titleTextEntity);\n\n    // Create description text entity\n    const descTextEntity = ctx.world.createEntity();\n    descTextEntity\n      .addComponent(Text, {\n        text: INTERACTION_INFO[i].desc,\n        color: '#cccccc',\n        fontSize: 0.04,\n        anchor: 'center',\n        baseline: 'top',\n        textAlign: 'center',\n        maxWidth: 1.6,\n        lineHeight: 1.3\n      })\n      .addComponent(ParentObject3D, {value: descPlate})\n      .addComponent(Position, {x: 0, y: 0.25, z: 0.01});\n\n    const descParentEntity = ctx.world.createEntity();\n    descParentEntity\n      .addComponent(Object3D, {value: descPlate})\n      .addComponent(Children, {value: [descTextEntity]});\n\n    textEntities.push(descTextEntity);\n  });\n\n  // Center laser demonstration\n  const laserVisual = createLaserVisual();\n  scene.add(laserVisual);\n  scene.userData.laserVisual = laserVisual;\n\n  // Door\n  doorMaterial = createDoorMaterial(ctx);\n  door = new THREE.Mesh(new THREE.BoxGeometry(1.5, 2.5, 0.1), doorMaterial);\n  door.position.set(0, 1.25, 4.9);\n  scene.add(door);\n\n  const doorFrame = new THREE.Mesh(new THREE.BoxGeometry(1.7, 2.7, 0.08), new THREE.MeshBasicMaterial({color: 0x1a1a1a}));\n  doorFrame.position.set(0, 1.25, 5);\n  scene.add(doorFrame);\n\n  // Teleport\n  const teleport = new THREE.Mesh(new THREE.PlaneBufferGeometry(roomSize, roomSize), new THREE.MeshBasicMaterial({visible: false}));\n  teleport.rotation.x = -Math.PI / 2;\n  teleport.position.y = 0.001;\n  scene.add(teleport);\n\n  ctx.raycontrol.addState('interactionDoor', {\n    colliderMesh: door,\n    onHover: (intersection, active) => { door.scale.z = Math.min(door.scale.z + 0.05 * (2 - door.scale.z), 2); },\n    onHoverLeave: () => {},\n    onSelectStart: (intersection, e) => { ctx.goto = 0; },\n    onSelectEnd: (intersection) => {}\n  });\n\n  ctx.raycontrol.addState('interactionTeleport', {\n    colliderMesh: teleport,\n    onHover: (intersection, active) => { ctx.teleport.onHover(intersection.point, active); },\n    onHoverLeave: () => { ctx.teleport.onHoverLeave(); },\n    onSelectStart: (intersection, e) => { ctx.teleport.onSelectStart(e); },\n    onSelectEnd: (intersection) => { ctx.teleport.onSelectEnd(intersection.point); }\n  });\n}\n\nexport function enter(ctx) {\n  ctx.renderer.setClearColor(0x0a0a1a);\n  ctx.scene.add(scene);\n  ctx.raycontrol.activateState('interactionDoor');\n  ctx.raycontrol.activateState('interactionTeleport');\n}\n\nexport function exit(ctx) {\n  ctx.raycontrol.deactivateState('interactionDoor');\n  ctx.raycontrol.deactivateState('interactionTeleport');\n  ctx.scene.remove(scene);\n}\n\nexport function execute(ctx, delta, time) {\n  doorMaterial.uniforms.time.value = time;\n\n  // Animate interactive cubes\n  interactiveCubes.forEach((cube, i) => {\n    cube.rotation.x += delta * 0.3;\n    cube.rotation.y += delta * 0.5;\n\n    // Simulate hover effect\n    const hovered = Math.sin(time * 2 + i) > 0;\n    if (hovered && !cube.userData.hovered) {\n      cube.material.color.setHex(0xffffff);\n      cube.userData.hovered = true;\n    } else if (!hovered && cube.userData.hovered) {\n      cube.material.color.setHex(INTERACTION_INFO[i].color);\n      cube.userData.hovered = false;\n    }\n  });\n\n  // Animate laser visual\n  if (scene.userData.laserVisual) {\n    scene.userData.laserVisual.rotation.y += delta * 0.5;\n    const laser = scene.userData.laserVisual.children[0];\n    laser.material.opacity = 0.5 + Math.sin(time * 5) * 0.3;\n  }\n\n  if (door.scale.z > 1) door.scale.z = Math.max(door.scale.z - delta * door.scale.z, 1);\n}\n","export var shaders = {\ndoor_frag : `\nuniform float time;\nuniform float selected;\nuniform sampler2D tex;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec2 uv = vUv * 2.0 - 1.0;\n  vec2 puv = vec2(length(uv.xy), atan(uv.x, uv.y));\n  vec4 col = texture2D(tex, vec2(log(puv.x) + t / 5.0, puv.y / 3.1415926 ));\n  float glow = (1.0 - puv.x) * (0.5 + (sin(t) + 2.0 ) / 4.0);\n  // blue glow\n  col += vec4(118.0/255.0, 144.0/255.0, 219.0/255.0, 1.0) * (0.4 + glow * 1.0);\n  // white glow\n  col += vec4(0.2) * smoothstep(0.0, 2.0, glow * glow);\n  gl_FragColor = col;\n\n}\n`,\n\nzoom_frag : `\nuniform float time;\nuniform sampler2D tex;\nuniform vec2 zoomPos;\nuniform float zoomAmount;\nuniform float zoomRatio;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec2 uv = vec2(vUv.x - 0.5, (1.0 - vUv.y) - 0.5);\n  vec2 texUv = uv * vec2(zoomRatio, 1.0);\n  vec4 col = texture2D(tex, zoomPos + texUv * zoomAmount);\n  float dist = length(uv) * 2.0;\n  col.a = smoothstep(0.0, 0.1, 1.0 - dist);\n  float aura = smoothstep(0.80, 1.0, dist);\n  col.rgb += aura * 0.3;\n  gl_FragColor = col;\n}\n`,\n\nbasic_vert : `\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvoid main()\n{\n  vUv = uv;\n  vPosition = position;\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n`,\n\npanoball_vert : `\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec3 vWorldPos;\nuniform float time;\nuniform float selected;\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n\nmat4 transpose(in mat4 m) {\n  vec4 i0 = m[0];\n  vec4 i1 = m[1];\n  vec4 i2 = m[2];\n  vec4 i3 = m[3];\n\n  return mat4(\n    vec4(i0.x, i1.x, i2.x, i3.x),\n    vec4(i0.y, i1.y, i2.y, i3.y),\n    vec4(i0.z, i1.z, i2.z, i3.z),\n    vec4(i0.w, i1.w, i2.w, i3.w)\n  );\n}\n\nvoid main()\n{\n  vUv = uv;\n\n  vPosition = position;\n\n  vec3 offset = vec3(\n    sin(position.x * 50.0 + time),\n    sin(position.y * 10.0 + time * 2.0),\n    cos(position.z * 40.0 + time)\n  ) * 0.003;\n\n  vPosition *= 1.0 + selected * 0.2;\n\n  vNormal = normalize(inverse(transpose(modelMatrix)) * vec4(normalize(normal), 1.0)).xyz;\n  vWorldPos = (modelMatrix * vec4(vPosition, 1.0)).xyz;\n\n  vec4 mvPosition = modelViewMatrix * vec4(vPosition + offset, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n`,\n\npanoball_frag : `\nuniform sampler2D tex, texfx;\nuniform float time;\nuniform float selected;\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec3 vWorldPos;\n\n\nvoid main( void ) {\n  vec2 uv = vUv;\n  //uv.y =  1.0 - uv.y;\n\n  vec3 eye = normalize(cameraPosition - vWorldPos);\n  float fresnel = abs(dot(eye, vNormal));\n  float shift = pow((1.0 - fresnel), 4.0) * 0.05;\n\n  vec3 col = vec3(\n    texture2D(tex, uv - shift).r,\n    texture2D(tex, uv).g,\n    texture2D(tex, uv + shift).b\n  );\n\n  col = mix(col * 0.7, vec3(1.0), 0.7 - fresnel);\n\n  col += selected * 0.3;\n\n  float t = time * 0.4 + vPosition.x + vPosition.z;\n  uv = vec2(vUv.x + t * 0.2, vUv.y + t);\n  vec3 fx = texture2D(texfx, uv).rgb * 0.4;\n\n\n  gl_FragColor = vec4(col + fx, 1.0);\n}\n`,\n\nbeam_frag : `\nuniform float time;\nuniform sampler2D tex;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec4 col = texture2D(tex, vec2(vUv.x, vUv.y * 3.0 + time * 2.0));\n  col *= vUv.y;\n  gl_FragColor = col;\n}\n`,\n\n};","import * as THREE from 'three';\nimport { PointerLockControls } from 'three/examples/jsm/controls/PointerLockControls.js';\n\nimport {VRButton} from './lib/VRButton.js';\nimport {slideshow} from './lib/slideshow.js';\nimport {loadAssets} from './lib/assetManager.js';\n\n// ECSY\nimport { World } from 'ecsy';\nimport { SDFTextSystem } from './systems/SDFTextSystem.js';\nimport { DebugHelperSystem } from './systems/DebugHelperSystem.js';\nimport { AreaCheckerSystem } from './systems/AreaCheckerSystem.js';\nimport { ControllersSystem } from './systems/ControllersSystem.js';\nimport HierarchySystem from './systems/HierarchySystem.js';\nimport TransformSystem from './systems/TransformSystem.js';\nimport BillboardSystem from './systems/BillboardSystem.js';\n\nimport SystemsGroup from './systems/SystemsGroup.js';\n\nimport assets from './assets.js';\n\nimport { Text, Object3D, AreaChecker } from './components/index.js';\n\nimport RayControl from './lib/RayControl.js';\nimport Teleport from './lib/Teleport.js';\n\nimport * as roomLanding from './rooms/Landing.js';\nimport * as roomControllers from './rooms/Controllers.js';\nimport * as roomTeleport from './rooms/Teleport.js';\nimport * as roomModels from './rooms/Models.js';\nimport * as roomAudio from './rooms/Audio.js';\nimport * as roomInteraction from './rooms/Interaction.js';\n\nimport {shaders} from './lib/shaders.js';\n\nimport WebXRPolyfill from 'webxr-polyfill';\nconst polyfill = new WebXRPolyfill();\n\nvar clock = new THREE.Clock();\n\nvar scene, parent, renderer, camera, controls, context = {};\nvar raycontrol, teleport, controllers = [];\n\nvar listener, ambientMusic;\n\nvar rooms = [\n  roomLanding,        // 0 - Landing room\n  roomControllers,    // 1 - Controllers learning room\n  roomTeleport,       // 2 - Teleportation learning room\n  roomModels,         // 3 - 3D Models learning room\n  roomAudio,          // 4 - Spatial Audio learning room\n  roomInteraction,    // 5 - Ray Control learning room\n];\n\nconst roomNames = [\n  'landing',\n  'controllers',\n  'teleport',\n  'models',\n  'audio',\n  'interaction',\n];\n\nconst musicThemes = [\n  false,              // 0 - landing\n  false,              // 1 - controllers\n  false,              // 2 - teleport\n  false,              // 3 - models\n  false,              // 4 - audio\n  false,              // 5 - interaction\n];\n\nconst urlObject = new URL(window.location);\nconst roomName = urlObject.searchParams.get('room');\ncontext.room = roomNames.indexOf(roomName) !== -1 ? roomNames.indexOf(roomName) : 0;\n// console.log(`Current room \"${roomNames[context.room]}\", ${context.room}`);\nconst debug = urlObject.searchParams.has('debug');\nconst handedness = urlObject.searchParams.has('handedness') ? urlObject.searchParams.get('handedness') : \"right\";\n\n// Target positions when moving from one room to another\nconst targetPositions = {\n  landing: {\n    // From landing to learning rooms (handled by room-specific positions)\n  },\n  controllers: {\n    landing: new THREE.Vector3(0, 0, -5)\n  },\n  teleport: {\n    landing: new THREE.Vector3(0, 0, -5)\n  },\n  models: {\n    landing: new THREE.Vector3(0, 0, -5)\n  },\n  audio: {\n    landing: new THREE.Vector3(0, 0, -5)\n  },\n  interaction: {\n    landing: new THREE.Vector3(0, 0, -5)\n  }\n};\n\nfunction gotoRoom(room) {\n  rooms[context.room].exit(context);\n  raycontrol.deactivateAll();\n\n  const prevRoom = roomNames[context.room];\n  const nextRoom = roomNames[room];\n\n  if (targetPositions[prevRoom] && targetPositions[prevRoom][nextRoom]) {\n    let deltaPosition = new THREE.Vector3();\n    const targetPosition = targetPositions[prevRoom][nextRoom];\n    var camera = renderer.xr.getCamera(context.camera);\n\n    deltaPosition.x = camera.position.x - targetPosition.x;\n    deltaPosition.z = camera.position.z - targetPosition.z;\n\n    context.cameraRig.position.sub(deltaPosition);\n  }\n\n  context.room = room;\n\n  playMusic(room);\n\n  rooms[context.room].enter(context);\n}\n\nfunction playMusic(room) {\n  if (ambientMusic.source) ambientMusic.stop();\n\n  const music = musicThemes[room];\n  if (!music) { return; }\n  ambientMusic.setBuffer(assets[music]);\n  ambientMusic.setLoop(true);\n  ambientMusic.setVolume(1.0);\n  ambientMusic.offset = Math.random() * 60;\n  ambientMusic.play();\n}\n\nvar ecsyWorld;\nvar systemsGroup = {};\n\nfunction detectWebXR() {\n  if ('xr' in navigator) {\n    navigator.xr.isSessionSupported('immersive-vr').then( supported => {\n      const noWebXRElement = document.getElementById('no-webxr');\n      if (!supported && noWebXRElement) {\n        noWebXRElement.classList.remove('hidden');\n      }\n    } );\n\n  } else {\n    const noWebXRElement = document.getElementById('no-webxr');\n    if (noWebXRElement) {\n      noWebXRElement.classList.remove('hidden');\n    }\n  }\n}\n\nexport function init() {\n\n  const handElement = document.getElementById(handedness + 'hand');\n  if (handElement) {\n    handElement.classList.add('activehand');\n  }\n\n  detectWebXR();\n\n  var w = 100;\n  ecsyWorld = new World();\n  ecsyWorld\n    .registerSystem(SDFTextSystem)\n    .registerSystem(AreaCheckerSystem)\n    .registerSystem(ControllersSystem)\n    .registerSystem(DebugHelperSystem)\n    .registerSystem(TransformSystem)\n    .registerSystem(BillboardSystem)\n    .registerSystem(HierarchySystem);\n\n  systemsGroup['roomHall'] = new SystemsGroup(ecsyWorld, [\n    AreaCheckerSystem, ControllersSystem, DebugHelperSystem\n  ]);\n\n  renderer = new THREE.WebGLRenderer({\n    antialias: true,\n    logarithmicDepthBuffer: false,\n    powerPreference: \"high-performance\",\n    preserveDrawingBuffer: false,\n    failIfMajorPerformanceCaveat: false\n  });\n  renderer.gammaFactor = 2.2;\n  renderer.outputEncoding = THREE.sRGBEncoding;\n  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // Cap at 2x for performance\n  renderer.setSize(window.innerWidth, window.innerHeight);\n  renderer.xr.enabled = true;\n\n  // Performance optimizations\n  renderer.sortObjects = false; // Disable object sorting for better performance\n  renderer.autoClear = true;\n  renderer.autoClearDepth = true;\n  renderer.autoClearStencil = true;\n\n  scene = new THREE.Scene();\n  camera = new THREE.PerspectiveCamera(80, window.innerWidth / window.innerHeight, 0.005, 10000);\n  camera.position.set(0, 1.6, 0);\n  listener = new THREE.AudioListener();\n  camera.add(listener);\n\n  ambientMusic = new THREE.Audio(listener);\n\n  controls = new PointerLockControls(camera, renderer.domElement);\n\n  // Browser navigation - enable pointer lock on click\n  document.body.addEventListener('click', () => {\n    if (!context.vrMode) {\n      controls.lock();\n    }\n  });\n\n  // Keyboard navigation\n  var moveForward = false;\n  var moveBackward = false;\n  var moveLeft = false;\n  var moveRight = false;\n\n  document.addEventListener('keydown', (ev) => {\n    switch(ev.keyCode) {\n      case 87: case 38: // W or Up Arrow\n        moveForward = true;\n        break;\n      case 65: case 37: // A or Left Arrow\n        moveLeft = true;\n        break;\n      case 83: case 40: // S or Down Arrow\n        moveBackward = true;\n        break;\n      case 68: case 39: // D or Right Arrow\n        moveRight = true;\n        break;\n      case 78: // N - next room\n        if (!context.vrMode) {\n          gotoRoom((context.room + 1) % rooms.length);\n        }\n        break;\n    }\n  });\n\n  document.addEventListener('keyup', (ev) => {\n    switch(ev.keyCode) {\n      case 87: case 38:\n        moveForward = false;\n        break;\n      case 65: case 37:\n        moveLeft = false;\n        break;\n      case 83: case 40:\n        moveBackward = false;\n        break;\n      case 68: case 39:\n        moveRight = false;\n        break;\n    }\n  });\n\n  // Store movement state for use in render loop\n  context.browserControls = {\n    controls: controls,\n    moveForward: () => moveForward,\n    moveBackward: () => moveBackward,\n    moveLeft: () => moveLeft,\n    moveRight: () => moveRight\n  };\n\n  if (debug) {\n    document.body.addEventListener('keydown', ev => {\n      switch(ev.keyCode) {\n        case 87: controls.moveForward(0.2); break;\n        case 65: controls.moveRight(-0.2); break;\n        case 83: controls.moveForward(-0.2); break;\n        case 68: controls.moveRight(0.2); break;\n        case 78: gotoRoom((context.room + 1) % rooms.length); break;\n        default: {\n          var room = ev.keyCode - 48;\n          if (!ev.metaKey && room >= 0 && room < rooms.length) {\n            gotoRoom(room);\n          }\n        }\n      }\n    });\n  }\n  scene.add(controls.getObject());\n\n  parent = new THREE.Object3D();\n  scene.add(parent);\n\n  window.addEventListener('resize', onWindowResize, false);\n\n  for (let i = 0; i < 2; i++) {\n    controllers[i] = renderer.xr.getController(i);\n    controllers[i].raycaster = new THREE.Raycaster();\n    controllers[i].raycaster.near = 0.1;\n    controllers[i].addEventListener('selectstart', onSelectStart);\n    controllers[i].addEventListener('selectend', onSelectEnd);\n  }\n\n  // global lights\n  const lightSun = new THREE.DirectionalLight(0xeeffff);\n  lightSun.name = 'sun';\n  lightSun.position.set(0.2, 1, 0.1);\n  const lightFill = new THREE.DirectionalLight(0xfff0ee, 0.3);\n  lightFill.name = 'fillLight';\n  lightFill.position.set(-0.2, -1, -0.1);\n\n  scene.add(lightSun, lightFill);\n\n  var cameraRig = new THREE.Group();\n  cameraRig.add(camera);\n  cameraRig.add(controllers[0]);\n  cameraRig.add(controllers[1]);\n  cameraRig.position.set(0, 0, 2);\n  scene.add(cameraRig);\n\n  context.vrMode = false; // in vr\n  context.assets = assets;\n  context.shaders = shaders;\n  context.scene = parent;\n  context.renderer = renderer;\n  context.camera = camera;\n  context.audioListener = listener;\n  context.goto = null;\n  context.cameraRig = cameraRig;\n  context.controllers = controllers;\n  context.world = ecsyWorld;\n  context.systemsGroup = systemsGroup;\n  context.handedness = handedness;\n\n  window.context = context;\n\n  const loadTotal = Object.keys(assets).length;\n\n  loadAssets(renderer, 'assets/', assets, () => {\n    raycontrol = new RayControl(context, handedness);\n    context.raycontrol = raycontrol;\n\n    teleport = new Teleport(context);\n    context.teleport = teleport;\n\n    setupControllers();\n    roomLanding.setup(context);\n    roomControllers.setup(context);\n    roomTeleport.setup(context);\n    roomModels.setup(context);\n    roomAudio.setup(context);\n    roomInteraction.setup(context);\n\n    rooms[context.room].enter(context);\n\n    // Slideshow disabled - was causing automatic room cycling in browser mode\n    // slideshow.setup(context);\n\n    document.body.appendChild(renderer.domElement);\n    document.body.appendChild(VRButton.createButton(renderer, status =>{\n      context.vrMode = status === 'sessionStarted';\n      if (context.vrMode) {\n        gotoRoom(0);\n        context.cameraRig.position.set(0, 0, 2);\n        context.goto = null;\n      } else {\n        // Slideshow disabled - was causing automatic room cycling in browser mode\n        // slideshow.setup(context);\n      }\n    }));\n    renderer.setAnimationLoop(animate);\n\n    document.getElementById('loading').style.display = 'none';\n  },\n\n  loadProgress => {\n    document.querySelector('#progressbar').setAttribute('stroke-dashoffset',\n      - (282 - Math.floor(loadProgress / loadTotal * 282)));\n  },\n  debug);\n\n}\n\nfunction setupControllers() {\n  var model = assets['generic_controller_model'].scene;\n  var material = new THREE.MeshLambertMaterial({\n    map: assets['controller_tex'],\n  });\n  model.getObjectByName('body').material = material;\n  model.getObjectByName('trigger').material = material;\n\n  for (let i = 0;i < 2; i++) {\n    let controller = controllers[i];\n    controller.boundingBox = new THREE.Box3();\n    controller.userData.grabbing = null;\n    controller.addEventListener( 'connected', function ( event ) {\n      this.add(model.clone());\n      raycontrol.addController(this, event.data);\n    } );\n    controller.addEventListener( 'disconnect', function () {\n      this.remove(this.children[0]);\n      raycontrol.removeController(this, event.data);\n    });\n  }\n}\n\n// @FIXME Hack for Oculus Browser issue\nvar selectStartSkip = {};\nvar selectEndSkip = {};\nvar OculusBrowser = navigator.userAgent.indexOf(\"OculusBrowser\") !== -1 &&\n  parseInt(navigator.userAgent.match(/OculusBrowser\\/([0-9]+)./)[1]) < 8;\n\n// <@FIXME\n\nfunction onSelectStart(ev) {\n  // @FIXME Hack for Oculus Browser issue\n  if (OculusBrowser) {\n    const controller = ev.target;\n    if (!selectStartSkip[controller]) {\n      selectStartSkip[controller] = true;\n      return;\n    }\n    selectStartSkip[controller] = false;\n  }\n  // <@FIXME\n\n  const trigger = ev.target.getObjectByName('trigger');\n  trigger.rotation.x = -0.3;\n  raycontrol.onSelectStart(ev);\n}\n\nfunction onSelectEnd(ev) {\n  // @FIXME Hack for Oculus Browser issue\n  if (OculusBrowser) {\n    const controller = ev.target;\n    if (!selectEndSkip[controller]) {\n      selectEndSkip[controller] = true;\n      return;\n    }\n    selectEndSkip[controller] = false;\n  }\n  // <@FIXME\n\n  const trigger = ev.target.getObjectByName('trigger');\n  trigger.rotation.x = 0;\n  raycontrol.onSelectEnd(ev);\n}\n\nfunction onWindowResize() {\n  camera.aspect = window.innerWidth / window.innerHeight;\n  camera.updateProjectionMatrix();\n  renderer.setSize(window.innerWidth, window.innerHeight);\n}\n\nfunction animate() {\n  var delta = clock.getDelta();\n  var elapsedTime = clock.elapsedTime;\n\n  ecsyWorld.execute(delta, elapsedTime);\n\n  // update controller bounding boxes\n  for (let i = 0; i < controllers.length; i++) {\n    const model = controllers[i].getObjectByName('Scene');\n    if (model) {\n      controllers[i].boundingBox.setFromObject(model);\n    }\n  }\n\n  // Browser navigation - handle keyboard movement\n  if (!context.vrMode && context.browserControls) {\n    const velocity = 3.0; // movement speed\n    const bc = context.browserControls;\n\n    if (bc.controls.isLocked) {\n      // Movement\n      if (bc.moveForward()) context.camera.translateZ(-velocity * delta);\n      if (bc.moveBackward()) context.camera.translateZ(velocity * delta);\n      if (bc.moveLeft()) context.camera.translateX(-velocity * delta);\n      if (bc.moveRight()) context.camera.translateX(velocity * delta);\n    }\n  }\n\n  // render current room\n  context.raycontrol.execute(context, delta, elapsedTime);\n  rooms[context.room].execute(context, delta, elapsedTime);\n  // Slideshow disabled - was causing automatic room cycling in browser mode\n  // if (!context.vrMode) {\n  //   slideshow.execute(context, delta, elapsedTime);\n  // }\n\n  renderer.render(scene, camera);\n  if (context.goto !== null) {\n    gotoRoom(context.goto);\n    context.goto = null;\n  }\n}\n\nwindow.onload = () => {init()};\n"],"sourceRoot":""}